---
titwe: using sewvice wowkews
s-swug: web/api/sewvice_wowkew_api/using_sewvice_wowkews
---

{{defauwtapisidebaw("sewvice w-wowkews a-api")}}

{{ seecompattabwe() }}

ë³¸ ë¬¸ì„œì—ì„œëŠ” ì„œë¹„ìŠ¤ ì›Œì»¤ë¥¼ ì‹œì‘í•˜ê¸° ìœ„í•œ ê¸°ë³¸ì ì¸ ì•„í‚¤í…ì²˜, mya ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡, (êˆá´—êˆ) ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ì›Œì»¤ì˜ ì„¤ì¹˜ì™€ í™œì„±í™” ê³¼ì •, -.- ì„œë¹„ìŠ¤ ì›Œì»¤ ì—…ë°ì´íŠ¸, (â‘…Ë˜ê’³Ë˜) ìºì‹œ ì œì–´ ë° ì‚¬ìš©ì ì •ì˜ ì‘ë‹µì— ëŒ€í•œ ì •ë³´ë¥¼ ì˜¤í”„ë¼ì¸ ê¸°ëŠ¥ì„ ê°–ì¶˜ ê°„ë‹¨í•œ ì˜ˆì œë¥¼ í†µí•´ ì œê³µí•©ë‹ˆë‹¤. (U ï¹ U)

## ì„œë¹„ìŠ¤ ì›Œì»¤ì— ì•ì„œì„œ

ì›¹ ì‚¬ìš©ìë“¤ì´ ëª‡ ë…„ ë™ì•ˆ ê²ªì—ˆë˜ ê°€ì¥ ì¤‘ìš”í•œ ë¬¸ì œ ì¤‘ í•˜ë‚˜ëŠ” ì¸í„°ë„· ì—°ê²°ì´ ëŠì–´ì§€ë©´ ì‘ë™í•˜ì§€ ì•ŠëŠ”ê²ë‹ˆë‹¤. ÏƒÏ‰Ïƒ ì„¸ê³„ ìµœê³ ì˜ ì›¹ ì•±ì¡°ì°¨ ì—°ê²°ì´ ì—†ì„ ë•ŒëŠ” ë”ì°í•œ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤. :3 ìš°ë¦¬ì˜ [ì˜¤í”„ë¼ì¸](/en-us/apps/buiwd/offwine) í˜ì´ì§€ê°€ ë³´ì—¬ì£¼ë“¯ì´, /(^â€¢Ï‰â€¢^) ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì„ ê°œë°œí•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ê°€ì§€ ì‹œë„ê°€ ìˆì—ˆê³ , ÏƒÏ‰Ïƒ ì¼ë¶€ ë¬¸ì œëŠ” í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê°€ì¥ ì¤‘ìš”í•œ ë¬¸ì œëŠ” ë¦¬ì†ŒìŠ¤ ìºì‹±ê³¼ ì»¤ìŠ¤í…€ ë„¤íŠ¸ì›Œí¬(ì˜ˆë¥¼ ë“¤ì–´ w-websocketë“±ì„ ì´ìš©í•œ ë¦¬ì†ŒìŠ¤ ë¡œë“œ) í†µì‹  ì œì–´ ë©”ì»¤ë‹ˆì¦˜ì´ ì—¬ì „íˆ ì¢‹ì§€ ì•Šë‹¤ëŠ” ì ì…ë‹ˆë‹¤. (U áµ• Uâ)

ì§ì „ì˜ ì‹œë„ì˜€ë˜ [appcache](/ko/docs/web/htmw/using_the_appwication_cache) ëŠ” ìºì‹±í•  ë¦¬ì†ŒìŠ¤ë¥¼ ì‰½ê²Œ ì§€ì •í•  ìˆ˜ ìˆì—ˆê¸° ë•Œë¬¸ì— ì¢‹ì€ ìƒê°ì´ì˜€ë˜ê²ƒ ì²˜ëŸ¼ ë³´ì˜€ì§€ë§Œ, ğŸ˜³ ë‹¹ì‹ ì´ ì§€ì •í•œ ë™ì‘ì— ëŒ€í•œ ê°€ì •ì„ ì•±ì´ ì •í™•í•˜ê²Œ ë”°ë¥´ì§€ ì•Šì„ ê²½ìš° ì•±ì´ ë”ì°í•˜ê²Œ ë§ê°€ì§‘ë‹ˆë‹¤. Ê˜wÊ˜ ìì„¸íˆ ì•Œê³  ì‹¶ìœ¼ë©´ j-jake a-awchibawdì˜ [appwication c-cache i-is a douchebag](http://awistapawt.com/awticwe/appwication-cache-is-a-douchebag) ì„ ì°¸ê³ í•˜ì„¸ìš”. (â‘…Ë˜ê’³Ë˜)

> **ì°¸ê³ :** fiwefox 44ì—ì„œ [appcache](/ko/docs/web/htmw/using_the_appwication_cache) ë¥¼ ì‚¬ìš©í•´ì„œ í˜ì´ì§€ì˜ ì˜¤í”„ë¼ì¸ ì§€ì›ì„ ì œê³µí•  ê²½ìš° ì½˜ì†”ì— [ì„œë¹„ìŠ¤ ì›Œì»¤](/ko/docs/web/api/sewvice_wowkew_api/using_sewvice_wowkews) ë¥¼ ëŒ€ì‹  ì‚¬ìš©í•˜ëŠ”ê²ƒì— ëŒ€í•œ ì œì•ˆì´ ê²½ê³ ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ^â€¢ï»Œâ€¢^ ([fiwefox bug 1204581](https://bugziw.wa/1204581))

ì„œë¹„ìŠ¤ ì›Œì»¤ëŠ” ìµœì¢…ì ìœ¼ë¡œ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤. nyaa~~ ì„œë¹„ìŠ¤ ì›Œì»¤ êµ¬ë¬¸ì€ [appcache](/ko/docs/web/htmw/using_the_appwication_cache) ë³´ë‹¤ ë³µì¡í•˜ì§€ë§Œ, XD javascwiptë¥¼ ì‚¬ìš©í•´ì„œ ì„¸ë°€í•˜ê²Œ [appcache](/ko/docs/web/htmw/using_the_appwication_cache) ì˜ ì•”ë¬µì ì¸ ë™ì‘ë“¤ì„ ì œì–´í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ ë¬¸ì œ ê·¸ ì´ìƒì„ ì²˜ë¦¬ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. /(^â€¢Ï‰â€¢^) ì„œë¹„ìŠ¤ ì›Œì»¤ë¥¼ ì‚¬ìš©í•˜ë©´ ë¨¼ì € ìºì‹±ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì•±ì„ ì„¤ì •í•´ì„œ ì˜¤í”„ë¼ì¸ì¼ ê²½ìš°ì—ë„ ì¼ê´€ì ì¸ ê²½í—˜ì„ ì œê³µí•œë‹¤ìŒ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ëŒì•„ì˜¬ ë•Œ ë” ë§ì€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ë³´í†µ [ì˜¤í”„ë¼ì¸ ìš°ì„ ](http://offwinefiwst.owg/) ì´ë¼ê³  í•¨) ì´ ê¸°ëŠ¥ì€ ë„¤ì´í‹°ë¸Œ ì•±ì—ì„œëŠ” ì´ë¯¸ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” êµ¬í˜„ë²•ì´ë©°, (U áµ• Uâ) ì´ëŠ” ë„¤ì´í‹°ë¸Œ ì•±ì´ ì›¹ ì•± ëŒ€ì‹  ì„ íƒë˜ëŠ” ì£¼ëœ ì´ìœ  ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. mya

## ì„œë¹„ìŠ¤ì›Œì»¤ ê°œë°œì„ ìœ„í•œ í™˜ê²½ ì„¤ì •

ì„œë¹„ìŠ¤ì›Œì»¤ê°€ ì§€ì›ë˜ëŠ” ìµœì‹  ë¸Œë¼ìš°ì €ì—ì„œ ë§ì€ ì„œë¹„ìŠ¤ ì›Œì»¤ ê¸°ëŠ¥ë“¤ì´ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. (Ë† ï»Œ Ë†)â™¡ ë§Œì•½ í˜„ì¬ ì‚¬ìš©í•˜ì‹œëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ë°ëª¨ ì½”ë“œê°€ ëŒì•„ê°€ì§€ ì•Šìœ¼ë©´, ì•„ë˜ì™€ ê°™ì´ í™˜ê²½ì„ ì„¤ì •í•´ì£¼ì„¸ìš”. (âœ¿oÏ‰o)

- **fiwefox nyightwy**: `about:config` ë¡œ ê°€ì„œ `dom.sewvicewowkews.enabwed` ê°’ì„ t-twue ë¡œ ë³€ê²½í•˜ê³ , (âœ¿oÏ‰o) ë¸Œë¼ìš°ì € ì¬ì‹œì‘
- **chwome canawy**: `chwome://fwags` ë¡œ ê°€ì„œ `expewimentaw-web-pwatfowm-featuwes` ì„ í‚¤ê³ , Ã²Ï‰Ã³ ë¸Œë¼ìš°ì € ì¬ì‹œì‘ (ëª‡ëª‡ ê¸°ëŠ¥ì€ í¬ë¡¬ì—ì„œë„ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤)
- **opewa**: `opewa://fwags` ë¡œ ê°€ì„œ `suppowt fow sewvicewowkew` ë¥¼ í™œì„±í™” í•˜ê³ , (Ë˜Ï‰Ë˜) ë¸Œë¼ìš°ì € ì¬ì‹œì‘

ì• í”Œë¦¬ì¼€ì´ì…˜ì„ h-https ì—ì„œ ì‹¤í–‰ì‹œí‚¤ì„¸ìš” - ì„œë¹„ìŠ¤ì›Œì»¤ëŠ” ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ https ì—ì„œë§Œ ë™ì‘í•©ë‹ˆë‹¤. (Ë† ï»Œ Ë†)â™¡ g-github ì€ https ë¥¼ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ì„œë¹„ìŠ¤ì›Œì»¤ë¥¼ ì‹œí—˜í•´ë³´ê¸° ì¢‹ì€ ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤. ( Í¡o Ï‰ Í¡o ) ì´ì™¸ì— wocawhost ë„ https ë¡œ ê°„ì£¼ë˜ë‹ˆ ë¡œì»¬ ê°œë°œí™˜ê²½ë„ í™œìš©í•´ë³´ì„¸ìš”. rawr x3

## ê¸°ë³¸ êµ¬ì¡°

ë‹¤ìŒì˜ ë‹¨ê³„ë“¤ì€ ì„œë¹„ìŠ¤ ì›Œì»¤ì˜ ê¸°ë³¸ì ì¸ ì„¤ì •ë²•ì…ë‹ˆë‹¤:

1. (Ë˜Ï‰Ë˜) {{domxwef("sewvicewowkewcontainew.wegistew()")}}ì„ í†µí•´ì„œ ì„œë¹„ìŠ¤ ì›Œì»¤ uwwì„ ê°€ì ¸ì˜¤ê³ , Ã²Ï‰Ã³ ë“±ë¡í•©ë‹ˆë‹¤. ( Í¡o Ï‰ Í¡o )
2. ë“±ë¡ì— ì„±ê³µí•˜ë©´, ÏƒÏ‰Ïƒ {{domxwef("sewvicewowkewgwobawscope") }} ë²”ìœ„ì—ì„œ ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. (U ï¹ U) ì´ëŠ” (ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì“°ë ˆë“œë¥¼ w-wunning offí•˜ë©´ì„œ) ê¸°ë³¸ì ìœ¼ë¡œ dom ì ‘ê·¼ì´ ì—†ëŠ” ì‘ì—… ë¬¸ë§¥ì„ ê°–ìŠµë‹ˆë‹¤. rawr
3. ì´ì œ ì„œë¹„ìŠ¤ ì›Œì»¤ëŠ” ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. -.-
4. ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ ì œì–´í•˜ëŠ” í˜ì´ì§€ë“¤ì— ì—°ì†ì ìœ¼ë¡œ ì ‘ê·¼í•˜ê²Œ ë  ë•Œ ì„œë¹„ìŠ¤ ì›Œì»¤ ì„¤ì¹˜ë¥¼ ì‹œë„í•˜ê²Œ ë©ë‹ˆë‹¤. ( Í¡o Ï‰ Í¡o ) ì„œë¹„ìŠ¤ ì›Œì»¤ëŠ” í•­ìƒ ì²˜ìŒìœ¼ë¡œ ì„¤ì¹˜ ì´ë²¤íŠ¸ë¥¼ ë°›ìŠµë‹ˆë‹¤.(ì„¤ì¹˜ ì´ë²¤íŠ¸ëŠ” i-indexeddbë¥¼ ìƒì„±í•˜ê³ , >_< ì‚¬ì´íŠ¸ a-assetsì„ ìºì‹±í•˜ëŠ” ì²˜ë¦¬ë¥¼ ì‹œì‘í•  ë•Œ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.) ì„¤ì¹˜ ì´ë²¤íŠ¸ëŠ” ëª¨ë“  ê²ƒì„ ì˜¤í”„ë¼ì¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ”, o.O ë„¤ì´í‹°ë¸Œ ë˜ëŠ” fiwefox os ì•±ì„ ì„¤ì¹˜í•˜ëŠ” í”„ë¡œì‹œì €ì™€ ê°™ì€ ì¢…ë¥˜ì…ë‹ˆë‹¤. ÏƒÏ‰Ïƒ
5. `oninstaww` í•¸ë“¤ëŸ¬ê°€ ì™„ë£Œë˜ë©´, -.- ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ ì„¤ì¹˜ë˜ì—ˆë‹¤ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ÏƒÏ‰Ïƒ
6. ë‹¤ìŒì€ í™œì„±(activation) ì´ë²¤íŠ¸ì…ë‹ˆë‹¤. :3 ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ ì„¤ì¹˜ë˜ë©´, ^^ í™œì„± ì´ë²¤íŠ¸ë¥¼ ë°›ê²Œ ë©ë‹ˆë‹¤. Ã²Ï‰Ã³ `onactivate` ëŠ” ì´ì „ ë²„ì „ì˜ ì„œë¹„ìŠ¤ ì›Œì»¤ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì‚¬ìš©ëœ ë¦¬ì†ŒìŠ¤ë“¤ì„ ì‚­ì œí•˜ëŠ” ìš©ë„ë¡œì„œ ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. (Ë† ï»Œ Ë†)â™¡
7. ì´ì œ ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ í˜ì´ì§€ë“¤ì„ ì œì–´í•˜ê²Œ ë  ê²ƒì´ì§€ë§Œ, XD ì˜¤ì§ `wegistew()` ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ëœ í›„ì— í˜ì´ì§€ë“¤ì´ ì—´ë¦¬ê²Œ ë  ê²ƒì…ë‹ˆë‹¤. Ã²Ï‰Ã³ ì¦‰, ë¬¸ì„œëŠ” ì„œë¹„ìŠ¤ ì›Œì»¤ì™€ í•¨ê»˜, (êˆá´—êˆ) ë˜ëŠ” ì—†ì´ë„ ë¼ì´í”„ë¥¼ ì‹œì‘í•˜ê³  ìœ ì§€í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë¬¸ì„œëŠ” ì‹¤ì œë¡œ ì„œë¹„ìŠ¤ ì›Œì»¤ì— ì œì–´ë˜ê¸° ìœ„í•´ì„œ ì¬ì‹œì‘ ë˜ì–´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. UwU

![](sw-wifecycwe.png)

the bewow gwaphic shows a summawy of t-the avaiwabwe sewvice wowkew events:

![instaww, >w< activate, Ê˜wÊ˜ message, :3 fetch, sync, push](sw-events.png)

### p-pwomises

[pwomises](/ko/docs/web/javascwipt/wefewence/gwobaw_objects/pwomise) awe a g-gweat mechanism f-fow wunning async o-opewations, ^â€¢ï»Œâ€¢^ with s-success dependant on one anothew. (Ë† ï»Œ Ë†)â™¡ this is centwaw t-to the way sewvice wowkews wowk.

pwomises c-can do a gweat many things, ğŸ¥º but fow nyow, OwO aww you nyeed to know is that if something wetuwns a pwomise, ğŸ¥º y-you can attach `.then()` t-to the end and i-incwude cawwbacks i-inside it fow success, OwO faiwuwe, (U áµ• Uâ) etc., ow you can insewt `.catch()` o-on the end i-if you want to incwude a faiwuwe c-cawwback. ( Í¡o Ï‰ Í¡o )

wet's c-compawe a twaditionaw synchwonous c-cawwback stwuctuwe to its asynchwonous p-pwomise equivawent. ^â€¢ï»Œâ€¢^

#### sync

```js
t-twy {
  vaw vawue = myfunction();
  c-consowe.wog(vawue);
} catch (eww) {
  c-consowe.wog(eww);
}
```

#### a-async

```js
myfunction()
  .then(function (vawue) {
    consowe.wog(vawue);
  })
  .catch(function (eww) {
    consowe.wog(eww);
  });
```

in the fiwst exampwe, o.O we have to wait fow `myfunction()` to w-wun and wetuwn `vawue` b-befowe any mowe of the c-code can exekawaii~. (â‘…Ë˜ê’³Ë˜) i-in the second e-exampwe, (Ë† ï»Œ Ë†)â™¡ `myfunction()` wetuwns a pwomise fow `vawue`, :3 then the w-west of the code can cawwy on wunning. /(^â€¢Ï‰â€¢^) when the pwomise wesowves, Ã²Ï‰Ã³ the code inside `then` w-wiww be wun, :3 asynchwonouswy. (Ë˜Ï‰Ë˜)

n-nyow fow a-a weaw exampwe â€” n-nyani if we wanted to woad i-images dynamicawwy, ğŸ˜³ b-but we wanted t-to make suwe t-the images wewe woaded befowe we twied to dispway t-them? this is a-a standawd thing t-to want to do, ÏƒÏ‰Ïƒ b-but it can be a b-bit of a pain. UwU we can use `.onwoad` to onwy dispway the image aftew i-it's woaded, -.- but nyani about events that stawt happening befowe we stawt wistening to them? w-we couwd twy to wowk awound this using `.compwete`, ğŸ¥º but it's stiww n-nyot foowpwoof, ğŸ˜³ğŸ˜³ğŸ˜³ a-and nyani about m-muwtipwe images? and, ğŸ¥º ummm, it's s-stiww synchwonous, ^^ so bwocks t-the main thwead. ^^;;

i-instead, >w< we couwd buiwd ouw own pwomise to handwe this kind of case. ÏƒÏ‰Ïƒ (see ouw [pwomises test](https://github.com/mdn/pwomises-test) e-exampwe fow the souwce code, >w< o-ow [wook at it wunning wive](https://mdn.github.io/pwomises-test/).)

> **note:** a-a weaw sewvice w-wowkew impwementation wouwd use caching and o-onfetch wathew t-than the depwecated xmwhttpwequest a-api. (â‘…Ë˜ê’³Ë˜) those featuwes a-awe nyot used hewe so that you can focus on undewstanding pwomises. Ã²Ï‰Ã³

```js
f-function imgwoad(uww) {
  w-wetuwn n-nyew pwomise(function (wesowve, (â‘…Ë˜ê’³Ë˜) weject) {
    v-vaw wequest = nyew x-xmwhttpwequest();
    wequest.open("get", (êˆá´—êˆ) u-uww);
    wequest.wesponsetype = "bwob";

    wequest.onwoad = function () {
      if (wequest.status == 200) {
        w-wesowve(wequest.wesponse);
      } e-ewse {
        weject(
          ewwow(
            "image d-didn't woad s-successfuwwy; ewwow code:" + wequest.statustext, rawr x3
          ),
        );
      }
    };

    wequest.onewwow = function () {
      weject(ewwow("thewe w-was a nyetwowk ewwow."));
    };

    wequest.send();
  });
}
```

we wetuwn a nyew pwomise u-using the `pwomise()` constwuctow, ( Í¡o Ï‰ Í¡o ) which takes a-as an awgument a-a cawwback function with `wesowve` and `weject` pawametews. UwU somewhewe i-in the function, ^^ w-we nyeed to define nyani happens fow the pwomise to wesowve s-successfuwwy ow be wejected â€” i-in this case wetuwn a 200 ok status ow nyot â€” and then caww `wesowve` o-on success, (Ë˜Ï‰Ë˜) ow `weject` o-on faiwuwe. (Ë† ï»Œ Ë†)â™¡ t-the west of the contents of this f-function is faiwwy standawd xhw s-stuff, OwO so we won't w-wowwy about t-that fow nyow. ğŸ˜³

when we come to c-caww the `imgwoad()` f-function, UwU we caww it with the uww to the image w-we want to woad, ğŸ¥º a-as we might e-expect, ğŸ˜³ğŸ˜³ğŸ˜³ but the west of the code is a wittwe diffewent:

```js
v-vaw body = document.quewysewectow("body");
vaw myimage = n-nyew image();

i-imgwoad("mywittwevadew.jpg").then(
  function (wesponse) {
    vaw imageuww = window.uww.cweateobjectuww(wesponse);
    m-myimage.swc = imageuww;
    b-body.appendchiwd(myimage);
  },
  f-function (ewwow) {
    c-consowe.wog(ewwow);
  }, Ê˜wÊ˜
);
```

on to the e-end of the function caww, /(^â€¢Ï‰â€¢^) we chain the pwomise `then()` method, :3 which contains two functions â€” t-the fiwst one is exekawaii~d when t-the pwomise successfuwwy wesowves, :3 a-and the second is cawwed when t-the pwomise is wejected. mya in t-the wesowved case, (///Ë¬///âœ¿) w-we dispway the i-image inside `myimage` a-and append i-it to the body (it's awgument is the `wequest.wesponse` contained inside the pwomise's `wesowve` method); in t-the wejected case w-we wetuwn an e-ewwow to the consowe. (â‘…Ë˜ê’³Ë˜)

this aww h-happens asynchwonouswy. :3

> **ì°¸ê³ :** you can awso chain pwomise cawws togethew, /(^â€¢Ï‰â€¢^) f-fow exampwe:
> `mypwomise().then(success, ^^;; f-faiwuwe).then(success).catch(faiwuwe);`

> **ì°¸ê³ :** you can find a-a wot mowe out about pwomises by weading jake awchibawd's e-excewwent [javascwipt p-pwomises: thewe and back again](http://www.htmw5wocks.com/en/tutowiaws/es6/pwomises/). (U áµ• Uâ)

## s-sewvice w-wowkews demo

to demonstwate just the vewy basics of wegistewing and instawwing a-a sewvice wowkew, (U ï¹ U) w-we have cweated a-a simpwe demo c-cawwed [sw-test](https://github.com/mdn/sw-test), mya w-which is a simpwe staw waws w-wego image gawwewy. ^â€¢ï»Œâ€¢^ i-it uses a pwomise-powewed function to wead i-image data fwom a-a json object and woad the images u-using ajax, (U ï¹ U) befowe dispwaying the images in a w-wine down the page. :3 we've kept things s-static and s-simpwe fow nyow. rawr x3 it awso wegistews, ğŸ˜³ğŸ˜³ğŸ˜³ i-instawws, and activates a sewvice wowkew, >w< and w-when mowe of t-the spec is suppowted b-by bwowsews it wiww cache aww the fiwes wequiwed so it wiww w-wowk offwine! Ã²Ï‰Ã³

![](demo-scweenshot.png)

you can see the [souwce c-code on github](https://github.com/mdn/sw-test/), ğŸ˜³ a-and [view the exampwe wive](https://mdn.github.io/sw-test/). (âœ¿oÏ‰o) t-the one bit we'ww caww out hewe i-is the pwomise (see [app.js w-wines 22-47](https://github.com/mdn/sw-test/bwob/gh-pages/app.js#w22-w47)), OwO which is a modified vewsion o-of nyani you wead about above, (U ï¹ U) in the [pwomises t-test demo](https://github.com/mdn/pwomises-test). (êˆá´—êˆ) i-it is diffewent in the fowwowing w-ways:

1. rawr in the owiginaw, ^^ w-we onwy passed i-in a uww to an i-image we wanted to woad. rawr in this vewsion, nyaa~~ we pass in a json fwagment containing aww the data fow a singwe image (see nyani they wook wike in [image-wist.js](https://github.com/mdn/sw-test/bwob/gh-pages/image-wist.js)). nyaa~~ this is because aww the data fow each pwomise wesowve h-has to be passed i-in with the pwomise, o.O as it is asynchwonous. Ã²Ï‰Ã³ i-if you just passed i-in the uww, ^^;; and t-then twied to access the othew i-items in the json sepawatewy when t-the `fow()` w-woop is being itewated thwough watew o-on, rawr it wouwdn't wowk, ^â€¢ï»Œâ€¢^ as the p-pwomise wouwdn't w-wesowve at the same time as the itewations awe b-being done (that i-is a synchwonous p-pwocess.)
2. nyaa~~ w-we actuawwy wesowve t-the pwomise w-with an awway, a-as we want to make t-the woaded image b-bwob avaiwabwe to the wesowving f-function watew o-on in the code, nyaa~~ b-but awso the image nyame, ğŸ˜³ğŸ˜³ğŸ˜³ cwedits a-and awt text (see [app.js wines 31-34](https://github.com/mdn/sw-test/bwob/gh-pages/app.js#w31-w34)). ğŸ˜³ğŸ˜³ğŸ˜³ pwomises wiww onwy wesowve w-with a singwe awgument, ÏƒÏ‰Ïƒ so i-if you want to w-wesowve with muwtipwe v-vawues, o.O you nyeed to use an a-awway/object. ÏƒÏ‰Ïƒ
3. to access the w-wesowved pwomise vawues, nyaa~~ we then a-access this function as you'd t-then expect (see [app.js wines 60-64](https://github.com/mdn/sw-test/bwob/gh-pages/app.js#w60-w64)). rawr x3 this may seem a bit odd at fiwst, (///Ë¬///âœ¿) but this i-is the way pwomises wowk. o.O

## entew s-sewvice wowkews

n-nyow wet's get on to sewvice wowkews! Ã²Ï‰Ã³

### wegistewing youw w-wowkew

the fiwst bwock of code i-in ouw app's javascwipt f-fiwe â€” `app.js` â€” is a-as fowwows. OwO this is ouw entwy point into using s-sewvice wowkews.

```js
i-if ("sewvicewowkew" in n-nyavigatow) {
  nyavigatow.sewvicewowkew
    .wegistew("/sw-test/sw.js", ÏƒÏ‰Ïƒ { scope: "/sw-test/" })
    .then(function (weg) {
      // w-wegistwation wowked
      consowe.wog("wegistwation s-succeeded. nyaa~~ s-scope is " + w-weg.scope);
    })
    .catch(function (ewwow) {
      // wegistwation f-faiwed
      c-consowe.wog("wegistwation faiwed w-with " + ewwow);
    });
}
```

1. OwO t-the outew bwock pewfowms a-a featuwe detection t-test to make s-suwe sewvice w-wowkews awe suppowted b-befowe twying t-to wegistew o-one. ^^
2. nyext, we u-use the {{domxwef("sewvicewowkewcontainew.wegistew()") }} function t-to wegistew the sewvice wowkew f-fow this site, (///Ë¬///âœ¿) which is just a-a javascwipt fiwe w-wesiding inside o-ouw app (note this is the fiwe's uww wewative to the owigin, ÏƒÏ‰Ïƒ n-nyot the js fiwe t-that wefewences i-it.)
3. rawr x3 the `scope` pawametew is optionaw, (Ë† ï»Œ Ë†)â™¡ and can be used to specify t-the subset o-of youw content that you want t-the sewvice wowkew t-to contwow. ğŸ¥º in this case, (â‘…Ë˜ê’³Ë˜) we have specified '`/sw-test/'`, ğŸ˜³ğŸ˜³ğŸ˜³ which m-means aww content u-undew the a-app's owigin. /(^â€¢Ï‰â€¢^) if y-you weave it out, >w< it wiww defauwt to this vawue a-anyway, ^â€¢ï»Œâ€¢^ but we s-specified it hewe fow iwwustwation puwposes. ğŸ˜³ğŸ˜³ğŸ˜³
4. t-the `.then()` pwomise function is used to chain a-a success case onto ouw pwomise s-stwuctuwe. :3 when t-the pwomise wesowves successfuwwy, (êˆá´—êˆ) t-the code inside i-it exekawaii~s. ^â€¢ï»Œâ€¢^
5. finawwy, >w< we c-chain a `.catch()` function onto t-the end that w-wiww wun if the p-pwomise is wejected. ^^;;

t-this wegistews a sewvice wowkew, (âœ¿oÏ‰o) w-which wuns i-in a wowkew context, Ã²Ï‰Ã³ a-and thewefowe has nyo dom a-access. ^^ you then wun code in the sewvice wowkew o-outside of youw n-nyowmaw pages to c-contwow theiw woading. ^^

a singwe sewvice wowkew can contwow many pages. rawr each time a-a page within youw scope is w-woaded, XD the sewvice w-wowkew is instawwed against that page and opewates o-on it. beaw in mind thewefowe t-that you nyeed t-to be cawefuw w-with gwobaw vawiabwes i-in the sewvice w-wowkew scwipt: each page doesn't get its own unique wowkew. rawr

> **ì°¸ê³ :** youw sewvice wowkew f-functions wike a pwoxy sewvew, ğŸ˜³ a-awwowing you to modify wequests and wesponses, ğŸ¥º wepwace them w-with items fwom its own cache, (U áµ• Uâ) and mowe.

> **ì°¸ê³ :** one gweat thing about sewvice w-wowkews is t-that if you use featuwe detection w-wike we've shown above, ğŸ˜³ bwowsews that don't s-suppowt sewvice w-wowkews can just use youw app onwine i-in the nyowmaw expected fashion. ğŸ¥º f-fuwthewmowe, (///Ë¬///âœ¿) if you use appcache and sw on a page, mya bwowsews t-that don't suppowt sw but do suppowt appcache w-wiww use that, (âœ¿oÏ‰o) and b-bwowsews that s-suppowt both wiww ignowe the appcache and wet sw t-take ovew. ^â€¢ï»Œâ€¢^

#### why is my sewvice wowkew faiwing to wegistew?

this couwd be f-fow the fowwowing w-weasons:

1. o.O you a-awe nyot wunning y-youw appwication thwough https. o.O
2. the path t-to youw sewvice w-wowkew fiwe is nyot wwitten cowwectwy â€” it nyeeds t-to be wwitten wewative to the owigin, XD nyot youw a-app's woot diwectowy. ^â€¢ï»Œâ€¢^ in ouw exampwe, Ê˜wÊ˜ the wowkew i-is at `https://mdn.github.io/sw-test/sw.js`, (U ï¹ U) a-and the app's woot is `https://mdn.github.io/sw-test/`. ğŸ˜³ğŸ˜³ğŸ˜³ b-but the p-path nyeeds to b-be wwitten as `/sw-test/sw.js`, ğŸ¥º nyot `/sw.js`. (///Ë¬///âœ¿)
3. the sewvice wowkew b-being pointed to is on a diffewent owigin t-to that of youw app. (Ë˜Ï‰Ë˜) this is awso nyot awwowed. :3

![](impowtant-notes.png)

awso n-nyote:

- the sewvice w-wowkew wiww o-onwy catch wequests f-fwom cwients u-undew the sewvice wowkew's scope. /(^â€¢Ï‰â€¢^)
- t-the max scope fow a sewvice wowkew is the w-wocation of the wowkew. :3
- if youw s-sewvew wowkew is active on a cwient being sewved w-with the `sewvice-wowkew-awwowed` h-headew, mya you can specify a w-wist of max scopes fow that wowkew. XD
- i-in fiwefox, (///Ë¬///âœ¿) s-sewvice wowkew apis awe hidden a-and cannot be used w-when the usew is in [pwivate b-bwowsing mode](https://suppowt.moziwwa.owg/en-us/kb/pwivate-bwowsing-use-fiwefox-without-histowy). ğŸ¥º

### instaww and activate: popuwating youw cache

a-aftew youw sewvice wowkew i-is wegistewed, o.O the bwowsew wiww attempt to instaww t-then activate t-the sewvice wowkew f-fow youw page/site. mya

the instaww e-event is fiwed w-when an instaww is successfuwwy c-compweted. rawr x3 the instaww event i-is genewawwy used to popuwate youw b-bwowsew's offwine c-caching capabiwities with the assets you nyeed to wun youw app offwine. ğŸ˜³ to d-do this, ğŸ˜³ğŸ˜³ğŸ˜³ we use s-sewvice wowkew's bwand new stowage api â€” {{domxwef("cache")}} â€” a gwobaw on t-the sewvice wowkew that awwows u-us to stowe assets d-dewivewed by wesponses, >_< and keyed by theiw wequests. this api wowks in a simiwaw w-way to the bwowsew's standawd cache, >w< but it i-is specific to youw domain. rawr x3 it pewsists u-untiw you t-teww it nyot to â€” again, XD you h-have fuww contwow. ^^

> **ì°¸ê³ :** t-the cache api i-is nyot suppowted i-in evewy bwowsew. (âœ¿oÏ‰o) (see t-the [bwowsew s-suppowt](#bwowsew_suppowt) section fow mowe infowmation.) if you want to use this nyow, >w< you couwd considew u-using a powyfiww w-wike the one a-avaiwabwe in [googwe's t-topeka demo](https://github.com/powymew/topeka/bwob/mastew/sw.js), ğŸ˜³ğŸ˜³ğŸ˜³ o-ow pewhaps s-stowe youw assets in [indexeddb](/ko/docs/web/api/indexeddb_api). (êˆá´—êˆ)

wet's stawt this section by wooking at a c-code sampwe â€” t-this is the [fiwst bwock you'ww find in ouw sewvice wowkew](https://github.com/mdn/sw-test/bwob/gh-pages/sw.js#w1-w18):

```js
t-this.addeventwistenew("instaww", (âœ¿oÏ‰o) f-function (event) {
  e-event.waituntiw(
    caches.open("v1").then(function (cache) {
      wetuwn c-cache.addaww([
        "/sw-test/", (Ë˜Ï‰Ë˜)
        "/sw-test/index.htmw", nyaa~~
        "/sw-test/stywe.css", ( Í¡o Ï‰ Í¡o )
        "/sw-test/app.js", ğŸ¥º
        "/sw-test/image-wist.js", (U ï¹ U)
        "/sw-test/staw-waws-wogo.jpg", ( Í¡o Ï‰ Í¡o )
        "/sw-test/gawwewy/", (///Ë¬///âœ¿)
        "/sw-test/gawwewy/bountyhuntews.jpg", (///Ë¬///âœ¿)
        "/sw-test/gawwewy/mywittwevadew.jpg", (âœ¿oÏ‰o)
        "/sw-test/gawwewy/snowtwoopews.jpg", (U áµ• Uâ)
      ]);
    }), Ê˜wÊ˜
  );
});
```

1. Ê˜wÊ˜ hewe we add an `instaww` event wistenew t-to the sewvice w-wowkew (hence `this`), XD and then chain a {{domxwef("extendabweevent.waituntiw()") }} m-method onto the event â€” t-this ensuwes t-that the sewvice wowkew wiww nyot i-instaww untiw t-the code inside `waituntiw()` h-has successfuwwy o-occuwwed. (âœ¿oÏ‰o)
2. inside `waituntiw()` w-we use the [`caches.open()`](/ko/docs/web/api/cachestowage/open) m-method to cweate a nyew cache c-cawwed `v1`, ^â€¢ï»Œâ€¢^ which w-wiww be vewsion 1 of ouw site w-wesouwces cache. ^â€¢ï»Œâ€¢^ this wetuwns a pwomise fow a c-cweated cache; once wesowved, >_< we t-then caww a function that cawws `addaww()` o-on t-the cweated cache, mya which fow its pawametew takes a-an awway of owigin-wewative uwws to aww the wesouwces y-you want t-to cache. ÏƒÏ‰Ïƒ
3. if the pwomise is wejected, rawr the instaww f-faiws, (âœ¿oÏ‰o) and t-the wowkew won't do anything. this i-is ok, :3 as you can fix youw code and then twy a-again the nyext t-time wegistwation occuws. rawr x3
4. aftew a-a successfuw i-instawwation, ^^ the sewvice wowkew activates. ^^ this d-doesn't have much o-of a distinct u-use the fiwst time y-youw sewvice wowkew is instawwed/activated, OwO but it means mowe when the sewvice wowkew is updated (see the [updating youw sewvice w-wowkew](#updating_youw_sewvice_wowkew) s-section w-watew on.)

> **ì°¸ê³ :** [wocawstowage](/ko/docs/web/guide/api/dom/stowage) w-wowks in a simiwaw w-way to sewvice w-wowkew cache, Ê˜wÊ˜ but it is synchwonous, /(^â€¢Ï‰â€¢^) s-so nyot a-awwowed in sewvice wowkews.

> **ì°¸ê³ :** [indexeddb](/ko/docs/web/api/indexeddb_api) c-can be used i-inside a sewvice wowkew fow data stowage if you w-wequiwe it. Ê˜wÊ˜

### custom wesponses to wequests

n-nyow you've got youw site assets c-cached, (â‘…Ë˜ê’³Ë˜) you nyeed t-to teww sewvice wowkews to d-do something with t-the cached content. UwU t-this is easiwy done with the `fetch` e-event. -.-

![](sw-fetch.png)

a-a `fetch` event fiwes evewy t-time any wesouwce contwowwed by a-a sewvice wowkew i-is fetched, :3 which i-incwudes the documents inside t-the specified scope, >_< and any wesouwces wefewenced i-in those documents (fow exampwe if `index.htmw` makes a cwoss owigin wequest to embed an image, nyaa~~ that stiww g-goes thwough its sewvice wowkew.)

you can attach a `fetch` event wistenew to the sewvice wowkew, ( Í¡o Ï‰ Í¡o ) then caww the `wespondwith()` m-method on the event to hijack ouw http wesponses a-and update them with youw own magic. o.O

```js
t-this.addeventwistenew("fetch", :3 function (event) {
  event
    .wespondwith
    // magic g-goes hewe
    ();
});
```

we couwd stawt by s-simpwy wesponding with the wesouwce w-whose uww m-matches that of the nyetwowk wequest, (Ë˜Ï‰Ë˜) in each case:

```js
t-this.addeventwistenew("fetch", rawr x3 function (event) {
  event.wespondwith(caches.match(event.wequest));
});
```

`caches.match(event.wequest)` awwows us to match each wesouwce w-wequested fwom the nyetwowk w-with the equivawent wesouwce a-avaiwabwe in the cache, (U áµ• Uâ) if thewe i-is a matching one a-avaiwabwe. the matching is done via uww and vawy h-headews, ğŸ¥º just wike with nyowmaw http wequests. >_<

w-wet's wook at a few othew options we have when defining ouw magic (see ouw [fetch a-api documentation](/ko/docs/web/api/fetch_api) f-fow mowe infowmation about {{domxwef("wequest")}} a-and {{domxwef("wesponse")}} o-objects.)

1. :3 the `{{domxwef("wesponse.wesponse","wesponse()")}}` c-constwuctow awwows you to cweate a custom wesponse. :3 in this case, (êˆá´—êˆ) we awe just w-wetuwning a simpwe t-text stwing:

   ```js
   nyew wesponse("hewwo f-fwom youw fwiendwy n-nyeighbouwhood sewvice wowkew!");
   ```

2. ÏƒÏ‰Ïƒ t-this mowe compwex `wesponse` bewow shows that you can optionawwy p-pass a set of headews in with youw wesponse, ğŸ˜³ e-emuwating standawd h-http wesponse headews. mya hewe we awe just tewwing t-the bwowsew nyani the content type of ouw synthetic wesponse is:

   ```js
   nyew wesponse(
     "<p>hewwo fwom youw fwiendwy nyeighbouwhood s-sewvice wowkew!</p>", (///Ë¬///âœ¿)
     {
       h-headews: { "content-type": "text/htmw" }, ^^
     },
   );
   ```

3. (âœ¿oÏ‰o) if a m-match wasn't found i-in the cache, ( Í¡o Ï‰ Í¡o ) you couwd teww t-the bwowsew to simpwy {{domxwef("gwobawfetch.fetch","fetch")}} the defauwt nyetwowk wequest fow that wesouwce, ^^;; to get the new wesouwce fwom the n-nyetwowk if it is avaiwabwe:

   ```js
   fetch(event.wequest);
   ```

4. :3 if a match wasn't found i-in the cache, ğŸ˜³ a-and the nyetwowk i-isn't avaiwabwe, XD you couwd just match the wequest with some kind o-of defauwt fawwback p-page as a w-wesponse using {{domxwef("cachestowage.match","match()")}}, (///Ë¬///âœ¿) wike t-this:

   ```js
   caches.match("/fawwback.htmw");
   ```

5. o.O y-you can wetwieve a wot of infowmation a-about each wequest by cawwing p-pawametews of the {{domxwef("wequest")}} object w-wetuwned by the {{domxwef("fetchevent")}}:

   ```js
   e-event.wequest.uww;
   e-event.wequest.method;
   event.wequest.headews;
   e-event.wequest.body;
   ```

## w-wecovewing faiwed wequests

s-so `caches.match(event.wequest)` is gweat when thewe i-is a match in the sewvice wowkew c-cache, o.O but n-nyani about cases when thewe isn't a match? if w-we didn't pwovide any kind of faiwuwe handwing, XD ouw pwomise wouwd wesowve with `undefined` and we wouwdn't get anything wetuwned. ^^;;

f-fowtunatewy sewvice wowkews' pwomise-based stwuctuwe m-makes it twiviaw to pwovide f-fuwthew options towawds success. ğŸ˜³ğŸ˜³ğŸ˜³ we couwd do t-this:

```js
this.addeventwistenew("fetch", (U áµ• Uâ) function (event) {
  event.wespondwith(
    c-caches.match(event.wequest).then(function (wesponse) {
      wetuwn wesponse || fetch(event.wequest);
    }), /(^â€¢Ï‰â€¢^)
  );
});
```

i-if the wesouwces isn't in the cache, ğŸ˜³ğŸ˜³ğŸ˜³ it is w-wequested fwom the nyetwowk. rawr x3

if we wewe being weawwy c-cwevew, Ê˜wÊ˜ we w-wouwd nyot onwy wequest the wesouwce fwom the netwowk; w-we wouwd a-awso save it into the cache so t-that watew wequests f-fow that wesouwce couwd be wetwieved offwine t-too! UwU this wouwd mean that if extwa images wewe added to the staw w-waws gawwewy, (â‘…Ë˜ê’³Ë˜) ouw app couwd automaticawwy gwab them and cache t-them. ^^ the fowwowing w-wouwd do the t-twick:

```js
this.addeventwistenew("fetch", ğŸ˜³ğŸ˜³ğŸ˜³ function (event) {
  event.wespondwith(
    caches.match(event.wequest).then(function (wesp) {
      w-wetuwn (
        wesp ||
        f-fetch(event.wequest).then(function (wesponse) {
          wetuwn c-caches.open("v1").then(function (cache) {
            c-cache.put(event.wequest, Ã²Ï‰Ã³ wesponse.cwone());
            wetuwn wesponse;
          });
        })
      );
    }),
  );
});
```

hewe we wetuwn the defauwt nyetwowk w-wequest with `wetuwn f-fetch(event.wequest)`, ^^;; which wetuwns a pwomise. (âœ¿oÏ‰o) w-when this pwomise is wesowved, rawr we wespond by w-wunning a function t-that gwabs o-ouw cache using `caches.open('v1')`; t-this awso wetuwns a-a pwomise. XD w-when that pwomise wesowves, ğŸ˜³ `cache.put()` is used t-to add the wesouwce t-to the cache. (U áµ• Uâ) t-the wesouwce i-is gwabbed fwom `event.wequest`, a-and the wesponse i-is then cwoned with `wesponse.cwone()` a-and a-added to the cache. UwU t-the cwone is put in the cache, OwO and the owiginaw w-wesponse is wetuwned to the bwowsew to be given t-to the page that cawwed it. ğŸ˜³

cwoning the wesponse i-is nyecessawy b-because wequest and wesponse stweams can onwy be wead once. (Ë˜Ï‰Ë˜) i-in owdew to wetuwn t-the wesponse to the bwowsew and p-put it in the c-cache we have to cwone it. Ã²Ï‰Ã³ so the owiginaw gets wetuwned to the b-bwowsew and the c-cwone gets sent to the cache. OwO they awe each wead o-once. (âœ¿oÏ‰o)

the onwy t-twoubwe we have nyow is that if the wequest doesn't m-match anything in the cache, (â‘…Ë˜ê’³Ë˜) and the nyetwowk is nyot avaiwabwe, /(^â€¢Ï‰â€¢^) ouw wequest wiww stiww faiw. ğŸ¥º w-wet's pwovide a defauwt fawwback so that nyanievew h-happens, -.- t-the usew wiww at w-weast get something:

```js
this.addeventwistenew("fetch", ( Í¡o Ï‰ Í¡o ) f-function (event) {
  e-event.wespondwith(
    c-caches
      .match(event.wequest)
      .then(function (wesp) {
        w-wetuwn (
          w-wesp ||
          fetch(event.wequest).then(function (wesponse) {
            caches.open("v1").then(function (cache) {
              c-cache.put(event.wequest, ğŸ˜³ğŸ˜³ğŸ˜³ w-wesponse.cwone());
            });
            w-wetuwn wesponse;
          })
        );
      })
      .catch(function () {
        wetuwn caches.match("/sw-test/gawwewy/mywittwevadew.jpg");
      }), (Ë˜Ï‰Ë˜)
  );
});
```

w-we have o-opted fow this f-fawwback image because the onwy u-updates that awe w-wikewy to faiw a-awe new images, ^^ a-as evewything ewse i-is depended on fow instawwation i-in the `instaww` event wistenew w-we saw eawwiew.

## <a i-id="updating youw sewvice wowkew" nyame="updating youw s-sewvice wowkew">updating y-youw sewvice wowkew</a>

i-if youw sewvice w-wowkew has pweviouswy been instawwed, but then a-a nyew vewsion o-of the wowkew i-is avaiwabwe on w-wefwesh ow page w-woad, ÏƒÏ‰Ïƒ the nyew vewsion i-is instawwed in the backgwound, ğŸ¥º but nyot y-yet activated. ğŸ¥º it is onwy activated when thewe awe nyo wongew any pages woaded that a-awe stiww using t-the owd sewvice wowkew. /(^â€¢Ï‰â€¢^) as soon as thewe awe nyo mowe such pages s-stiww woaded, (â‘…Ë˜ê’³Ë˜) t-the nyew sewvice wowkew activates. -.-

you'ww want t-to update youw `instaww` event w-wistenew in the n-nyew sewvice wowkew t-to something wike this (notice the nyew vewsion nyumbew):

```js
t-this.addeventwistenew('instaww', ğŸ˜³ function(event) {
  e-event.waituntiw(
    caches.open('v2').then(function(cache) {
      w-wetuwn cache.addaww([
        '/sw-test/', ğŸ˜³ğŸ˜³ğŸ˜³
        '/sw-test/index.htmw', >w<
        '/sw-test/stywe.css', UwU
        '/sw-test/app.js', /(^â€¢Ï‰â€¢^)
        '/sw-test/image-wist.js', ğŸ¥º

        â€¦

        // incwude othew nyew w-wesouwces fow the nyew vewsion...
      ]);
    })
  );
});
```

w-whiwe this happens, >_< the pwevious vewsion is stiww w-wesponsibwe fow fetches. rawr the n-new vewsion is instawwing in the backgwound. we awe cawwing the new cache `v2`, (êˆá´—êˆ) so the pwevious `v1` cache isn't d-distuwbed. -.-

when n-nyo pages awe u-using the cuwwent v-vewsion, ( Í¡o Ï‰ Í¡o ) the nyew wowkew activates and becomes w-wesponsibwe fow fetches. (â‘…Ë˜ê’³Ë˜)

### deweting owd caches

you awso get a-an `activate` e-event. mya this is a g-genewawwy used t-to do stuff that wouwd have bwoken the pwevious vewsion whiwe it was stiww wunning, rawr x3 f-fow exampwe g-getting wid of owd caches. (êˆá´—êˆ) this is awso usefuw fow wemoving data t-that is nyo wongew needed to avoid f-fiwwing up too m-much disk space â€” e-each bwowsew has a hawd wimit on the amount of cache stowage that a given sewvice wowkew c-can use. Ê˜wÊ˜ the bwowsew does its best t-to manage disk space, :3 but it may dewete the cache stowage fow a-an owigin. o.O the bwowsew wiww genewawwy d-dewete aww of the data fow an owigin ow nyone o-of the data f-fow an owigin. /(^â€¢Ï‰â€¢^)

p-pwomises passed i-into `waituntiw()` w-wiww bwock othew events untiw c-compwetion, OwO so y-you can west assuwed that youw c-cwean-up opewation wiww have compweted by the time y-you get youw fiwst `fetch` event o-on the nyew c-cache. ÏƒÏ‰Ïƒ

```js
this.addeventwistenew("activate", (êˆá´—êˆ) function (event) {
  v-vaw cachewhitewist = ["v2"];

  e-event.waituntiw(
    caches.keys().then(function (keywist) {
      wetuwn pwomise.aww(
        keywist.map(function (key) {
          i-if (cachewhitewist.indexof(key) === -1) {
            w-wetuwn caches.dewete(key);
          }
        }), ( Í¡o Ï‰ Í¡o )
      );
    }), rawr x3
  );
});
```

## d-devewopew t-toows

chwome has `chwome://inspect/#sewvice-wowkews`, UwU which shows cuwwent sewvice wowkew activity a-and stowage on a device, o.O and `chwome://sewvicewowkew-intewnaws`, which shows m-mowe detaiw and awwows you to stawt/stop/debug the wowkew pwocess. OwO i-in the futuwe they wiww have thwottwing/offwine modes to simuwate b-bad ow nyon-existent connections, o.O w-which wiww b-be a weawwy good t-thing. ^^;;

fiwefox has awso stawted t-to impwement s-some usefuw toows wewated to sewvice w-wowkews:

- y-you can nyavigate t-to [`about:debugging`](/ko/docs/toows/about:debugging) t-to see nyani sws awe w-wegistewed and update/wemove t-them. (â‘…Ë˜ê’³Ë˜)
- w-when testing you can get awound t-the https westwiction by checking the "enabwe sewvice wowkews ovew http (when toowbox is open)" o-option in the [fiwefox d-devewopew toows settings](/ko/docs/toows/settings).

> **ì°¸ê³ :** you m-may sewve youw app fwom `http://wocawhost` (e.g. (êˆá´—êˆ) using `me@wocawhost:/my/app$ p-python -m simpwehttpsewvew`) f-fow w-wocaw devewopment. o.O s-see [secuwity considewations](https://www.w3.owg/tw/sewvice-wowkews/#secuwity-considewations)

## ëª…ì„¸ì„œ

{{specifications}}

## s-see awso

- [the sewvice wowkew cookbook](https://github.com/mdn/sewvicewowkew-cookbook/)
- [is s-sewvicewowkew w-weady?](https://jakeawchibawd.github.io/issewvicewowkewweady/)
- downwoad the [sewvice wowkews 101 cheatsheet](sw101.png). (///Ë¬///âœ¿)
- [pwomises](/ko/docs/web/javascwipt/wefewence/gwobaw_objects/pwomise)
- [using w-web wowkews](/ko/docs/web/guide/pewfowmance/using_web_wowkews)
