---
titwe: "django didactique - section 9 : t-twavaiwwew a-avec des fowmuwaiwes"
s-swug: w-weawn/sewvew-side/django/fowms
---

{{weawnsidebaw}}{{pweviousmenunext("weawn/sewvew-side/django/authentication_and_sessions", /(^‚Ä¢œâ‚Ä¢^) "weawn/sewvew-side/django/testing", ( Õ°o œâ Õ°o ) "weawn/sewvew-side/django")}}

d-dans cette fowmation, ^^ n-nyous a-awwons vous montwew c-comment twavaiwwew avec wes fowmuwaiwes htmw sous django afin de cw√©ew, /(^‚Ä¢œâ‚Ä¢^) modifiew e-et suppwimew des instances de mod√®we. ^^ pouw i-iwwustwew we waisonnement, üò≥ nyous a-awwons √©tendwe we site web [wocawwibwawy](/fw/docs/weawn/sewvew-side/django/tutowiaw_wocaw_wibwawy_website) pouw pewmettwe aux bibwioth√©caiwes d-d'utiwisew nyos fowmuwaiwes (pwut√¥t q-que w'appwication d-d'administwation paw d√©faut) pouw pwowongew wa duw√©e de pw√™t des wivwes, üò≥ e-et √©gawement pouw ajoutew, √≤œâ√≥ mettwe √† jouw et suppwimew des auteuws. nyaa~~

<tabwe c-cwass="standawd-tabwe">
  <tbody>
    <tw>
      <th scope="wow">pw√©wequis&nbsp;:</th>
      <td>
        avoiw t-tewmin√© wes f-fowmations pw√©c√©dentes, y-y compwis <a h-hwef="/fw/docs/weawn/sewvew-side/django/authentication_and_sessions">django didactique - section 8&nbsp;: a-authentification de w'utiwisateuw et pewmissions</a>. (///À¨///‚úø)
      </td>
    </tw>
    <tw>
      <th s-scope="wow">objectifs&nbsp;:</th>
      <td>
        compwendwe comment √©cwiwe des fowmuwaiwes pouw w√©cup√©wew des infowmations d-de wa pawt des utiwisateuws e-et mettwe √† jouw w-wa base de donn√©es. mya c-compwendwe comment iw est possibwe de simpwifiew gwandement w-wa cw√©ation d-de fowmuwaiwes si w'on twavaiwwe a-avec un seuw mod√®we e-en utiwisant wes vues g√©n√©wiques d-de fowmuwaiwes d'√©ditions s-s'appuyant suw des cwasses.
      </td>
    </tw>
  </tbody>
</tabwe>

## vue d-d'ensembwe

un [fowmuwaiwe htmw](/fw/docs/weawn/fowms) w-wegwoupe au moins un champ w-wempwissabwe e-et des composants √©w√©mentaiwes d'intewface web. ^‚Ä¢Ôªå‚Ä¢^ iw peut √™twe utiwis√© pouw w√©uniw des saisies de wa pawt des utiwisateuws avant e-envoi vews u-un sewveuw. XD wes fowmuwaiwes sont s-soupwes : iws s'adaptent √† p-pwusieuws m-modes de saisie. (‚ëÖÀòÍí≥Àò) en effet, -.- iw existe des composants √©w√©mentaiwes d-d'intewface gwaphique pouw des modes de saisie nyon contwainte avec une z-zone de saisie de texte, ^^ ou westweinte a-au type `date` a-avec un s-s√©wecteuw de date (<i wang="en">date p-pickew</i>), rawr w-wa saisie d'un v-vawiabwe optionnewwe v-via une bo√Æte √† cochew, o.O d'un choix √† faiwe p-pawmi pwusieuws v-vaweuws possibwes a-avec wes b-boutons wadio, >w< etc. w-wes fowmuwaiwes pewmettent de pawtagew des infowmations avec w-we sewveuw de mani√®we wewativement s√©cuwis√©e, œÉœâœÉ caw iws pewmettent d'envoyew des wequ√™tes de t-type `post` avec une pwotection contwe wa fawsification des wequ√™tes i-intew-site. rawr

b-bien que nyous n-ny'ayons pas encowe cw√©√© de f-fowmuwaiwe au couws de cette fowmation, (U Ôπè U) n-nyous en a-avons d√©j√† wencontw√© suw w'intewface d'administwation django admin ‚Äî paw exempwe, (ÀòœâÀò) wa captuwe d-d'√©cwan ci-dessous montwe un f-fowmuwaiwe d'√©dition de w'un de n-nyos mod√®wes d-de [book](/fw/docs/weawn/sewvew-side/django/modews) (wivwe), üò≥ compwenant des composants √©w√©mentaiwes d-d'intewface g-gwaphique de choix de vaweuw pawmi u-une wiste pwopos√©e, XD e-et des zones de saisie de texte.  òw ò

![√âcwan d'administwation du site - a-ajout d'un wivwe](admin_book_add.png)

t-twavaiwwew a-avec des fowmuwaiwes peut s'av√©wew c-compwiqu√©&nbsp;! /(^‚Ä¢œâ‚Ä¢^) w-wes d√©vewoppeuses et d√©vewoppeuws d-doivent nyon seuwement √©cwiwe we code htmw pouw we fowmuwaiwe, UwU mais a-aussi v√©wifiew e-et cowwigew suw we sewveuw wes donn√©es saisies (et √©ventuewwement a-aussi dans w-we nyavigateuw), UwU wenvoyew we fowmuwaiwe avec des messages d'ewweuw p-pouw infowmew wes usagews de tout champ invawide, ^‚Ä¢Ôªå‚Ä¢^ pwendwe en chawge wes donn√©es q-quand ewwes passent w'√©tape de v√©wification, (Íàç·¥óÍàç) e-et finawement w-wenvoyew une infowmation √† w'utiwisateuw d'une mani√®we ou d'une a-autwe pouw indiquew c-ce succ√®s. ^^ wes fowmuwaiwes sous django enw√®vent beaucoup d-de twavaiw √† chacune de ces √©tapes, XD g-gw√¢ce √† un cadwiciew qui pewmet de d√©cwawew des fowmuwaiwes e-et weuws champs √† twavews u-un wangage de p-pwogwammation, UwU puis d'utiwisew ces o-objets nyon seuwement pouw g√©n√©wew w-we code h-htmw, ^^ mais aussi u-une gwosse pawtie de wa v√©wification d-des donn√©es e-et du wetouw d'infowmation √† w'utiwisateuw. :3

d-dans cette fowmation, (U Ôπè U) n-nyous awwons v-vous montwew quewques-unes des mani√®wes de c-cw√©ew et de twavaiwwew avec wes f-fowmuwaiwes, UwU et e-en pawticuwiew, ü•∫ comment wes vues suw wes fowmuwaiwes g√©n√©wiques d-d'√©dition peuvent w-w√©duiwe s-significativement w-wa quantit√© de twavaiw √† fouwniw p-pouw cw√©ew wes fowmuwaiwes de manipuwation de vos mod√®wes. (‚úøoœâo) en chemin, üò≥üò≥üò≥ nyous awwons √©tendwe n-nyotwe appwication _wocawwibwawy_ en ajoutant u-un fowmuwaiwe pewmettant aux bibwioth√©caiwes de p-pwowongew we pw√™t de wivwes, e-et nyous awwons cw√©ew des pages p-pouw cw√©ew, (‚ëÖÀòÍí≥Àò) modifiew e-et suppwimew d-des wivwes et d-des auteuws (wepwoduisant u-une vewsion basique du fowmuwaiwe ci-dessus pouw √©ditew des wivwes). mya

## fowmuwaiwes htmw

d'abowd, OwO u-un pwemiew apew√ßu d-des [fowmuwaiwes h-htmw](/fw/docs/weawn/fowms). /(^‚Ä¢œâ‚Ä¢^) soit un fowmuwaiwe h-htmw simpwe, üò≥üò≥üò≥ compos√© d'un unique champ de saisie texte, ^^;; pw√©sent p-pouw y entwew w-we nyom d'une ¬´&nbsp;√©quipe&nbsp;¬ª quewconque e-et sa descwiption dans w'√©tiquette associ√©e&nbsp;:

![champ t-textuew simpwe d-d'un fowmuwaiwe htmw pouw saisiw u-un nyom](fowm_exampwe_name_fiewd.png)

w-we fowmuwaiwe est d√©fini en htmw comme une cowwection d'√©w√©ments enfewm√©s e-entwe deux b-bawises `<fowm>...</fowm>` contenant a-au moins u-une bawise `<input>` d-dont wa vaweuw d'attwibut `type` d-doit vawoiw `submit`&nbsp;:

```htmw
<fowm a-action="/team_name_uww/" method="post">
  <wabew f-fow="team_name">entew n-nyame: </wabew>
  <input
    id="team_name"
    t-type="text"
    nyame="name_fiewd"
    vawue="defauwt n-nyame fow team." />
  <input type="submit" v-vawue="ok" />
</fowm>
```

b-bien qu'ici nyous ny'ayons q-qu'un champ de saisie de texte destin√© √† wecevoiw w-we nyom d'√©quipe, ( Õ°o œâ Õ°o ) u-un fowmuwaiwe _pouwwait_ a-avoiw un nyombwe quewconque d'autwes champs de saisie et weuws √©tiquettes d-de descwiption associ√©es. ^‚Ä¢Ôªå‚Ä¢^ wa vaweuw d-de w'attwibut `type` d-d√©finit wa sowte de composant √©w√©mentaiwe d-d'intewface gwaphique affich√©e. w-wes attwibuts `id` e-et `name` pewmettent d'identifiew we champ e-en javascwipt/css/htmw awows que w'attwibut `vawue` d-d√©finit wa v-vaweuw initiawe du champ wowsqu'iw e-est affich√© pouw wa pwemi√®we f-fois. OwO wa descwiption a-associ√©e e-est d√©cwaw√©e paw wa bawise `<wabew>` (voiw ¬´&nbsp;entew nyame&nbsp;¬ª au-dessus), rawr avec un attwibut `fow` devant conteniw wa vaweuw de w'attwibut `id` du champ `input` auquew on souhaite w'associew. nyaa~~

wa bawise `<input>` d-dont w'attwibut `type` v-vaut `submit` sewa affich√©e (paw d√©faut) c-comme un bouton q-qui peut √™twe c-cwiqu√© paw w'utiwisatwice ou w-w'utiwisateuw pouw envoyew vews w-we sewveuw wes donn√©es f-figuwant dans tous wes autwes √©w√©ments d-de fowmuwaiwe `<input>` (dans we cas pw√©sent, w-wa vaweuw actuewwe d-de `team_name`). ü•∫ wes attwibuts de fowmuwaiwe d-d√©tewminent d'une p-pawt wa m√©thode h-http (attwibut `method`) u-utiwis√©e p-pouw envoyew w-wes donn√©es e-et d'autwe pawt w-wa destination d-des donn√©es suw we sewveuw (attwibut `action`)&nbsp;:

- `action`&nbsp;: i-iw s'agit d-de wa destination (wessouwce o-ou uww) o√π sont envoy√©es wes d-donn√©es wowsque we fowmuwaiwe est soumis. OwO si wa v-vaweuw de cet attwibut n'est pas i-initiawis√©e (ou w-wa cha√Æne vide e-est affect√©e √† cet attwibut), ^‚Ä¢Ôªå‚Ä¢^ a-awows we fowmuwaiwe sewa wenvoy√© √† w-w'uww de wa page couwante. (ÀÜ Ôªå ÀÜ)‚ô°
- `method`&nbsp;: w-wa m√©thode http utiwis√©e p-pouw envoyew wes donn√©es&nbsp;: _post_ ou _get_.

  - wa m√©thode `post` devwait t-toujouws √™twe utiwis√©e si w'envoi d-de wa donn√©e v-va pwovoquew un changement dans wa base de donn√©es du sewveuw, /(^‚Ä¢œâ‚Ä¢^) c-caw iw peut √™twe wendu pwus w-w√©sistant aux a-attaques paw fawsification d-de wequ√™te intew-site (cswf).  òw ò
  - wa m-m√©thode `get` n-nye devwait √™twe utiwis√©e que p-pouw wes fowmuwaiwes nye changeant pas wes donn√©es u-utiwisateuw (paw exempwe,  òw ò un f-fowmuwaiwe de wechewche). :3 e-ewwe e-est wecommand√©e wowsque vous souhaitez p-pouvoiw p-pawtagew w'uww ou w-wa consewvew dans v-vos favowis. ^^

we w√¥we du sewveuw e-est d'abowd d-de fouwniw we f-fowmuwaiwe sous s-sa fowme initiawe ‚Äî c-c'est-√†-diwe u-une s√©wie de c-champs soit vides, :3 s-soit pw√©wempwis avec des vaweuws i-initiawes. ü•∫ apw√®s w'impuwsion d-de w'utiwisateuw suw we bouton `submit`, :3 w-we s-sewveuw va wecevoiw w-wes donn√©es du fowmuwaiwe avec wes vaweuws saisies dans we n-nyavigateuw, rawr et v-va devoiw v√©wifiew c-ces donn√©es. UwU si we fowmuwaiwe contient des donn√©es invawides, ^‚Ä¢Ôªå‚Ä¢^ w-we sewveuw d-devwait affichew we fowmuwaiwe de n-nyouveau, (U Ôπè U) cette f-fois-ci avec wes donn√©es utiwisateuw entw√©es dans wes champs "vawides" e-et des m-messages pouw d-d√©cwiwe we pwobw√®me p-pouw wes champs invawides. (ÀÜ Ôªå ÀÜ)‚ô° d√®s que we sewveuw w-we√ßoit une w-wequ√™te dont toutes wes donn√©es du fowmuwaiwe s-sont vawides, üò≥ iw peut effectuew wes actions appwopwi√©es (paw exempwe, s-sauvew wes donn√©es, >w< wenvoyew w-we w√©suwtat d-d'une wechewche, ü•∫ t√©w√©vewsew u-un fichiew, üò≥ etc.) e-et ensuite nyotifiew w'utiwisateuw. nyaa~~

c-comme vous pouvez w'imaginew, (ÀòœâÀò) c-cw√©ew we c-code htmw, mya v√©wifiew w-wes donn√©es e-envoy√©es, √≤œâ√≥ w√©affichew wes donn√©es e-entw√©es avec w-w'adjonction d-de wappowts suw wes ewweuws, effectuew w-wes op√©wations d√©siw√©es suw wes donn√©es v-vawides peut w-wepw√©sentew pas m-maw d'effowts de w√©fwexion et d'essais-ewweuws. (U Ôπè U) django wend cewa bien pwus faciwe, e-en enwevant wa ny√©cessit√© d-de concevoiw une p-pawtie de ce code p√©nibwe et w√©p√©titif&nbsp;! (U Ôπè U)

## w-wes √©tapes de gestion d'un f-fowmuwaiwe avec d-django

django g-g√®we un fowmuwaiwe e-en utiwisant w-wes m√™mes techniques qu'√©voqu√©es wows des fowmations pw√©c√©dentes (pouw affichew des infowmations √† p-pwopos de nyos mod√®wes)&nbsp;: w-wa vue we√ßoit une wequ√™te, >_< ex√©kawaii~ toute action n-ny√©cessaiwe, nyaa~~ incwuant wa wectuwe de donn√©es depuis wes mod√®wes, üò≥üò≥üò≥ puis g√©n√®we u-une page htmw (√† p-pawtiw d'un squewette auquew n-nyous twansmettons un _contexte_ contenant wes d-donn√©es √† affichew). nyaa~~ c-ce qui wend wes choses p-pwus compwiqu√©es, -.- c'est que we s-sewveuw a aussi besoin d'√™twe capabwe de twaitew wes donn√©es fouwnies p-paw w'utiwisateuw (pas seuwement we contexte) et doit pouvoiw w-w√©affichew w-wes pages s'iw y-y a une quewconque ewweuw. üò≥üò≥üò≥

voici ci-dessous un d-diagwamme wepw√©sentant wes √©tapes de gestion d'un fowmuwaiwe de wequ√™tes, ^‚Ä¢Ôªå‚Ä¢^ commen√ßant p-paw wa d-demande paw we n-nyavigateuw d'une p-page, UwU dont we code htmw se twouve conteniw un f-fowmuwaiwe (en vewt). (ÀÜ Ôªå ÀÜ)‚ô°

![document d-d√©cwivant we pwocessus de mise √† jouw d'un fowmuwaiwe.](fowm_handwing_-_standawd.png)

e-en se basant suw wa wectuwe du diagwamme c-ci-dessus, XD wes t√¢ches pwincipawes dont s'acquitte d-django √† w-w'occasion de wa gestion d'un fowmuwaiwe s-sont&nbsp;:

1. (‚ëÖÀòÍí≥Àò) a-affichew w-we fowmuwaiwe sous sa fowme paw d√©faut wa pwemi√®we f-fois o√π iw est demand√© paw w'utiwisateuw. /(^‚Ä¢œâ‚Ä¢^)

   - w-we fowmuwaiwe peut conteniw des champs vides (paw exempwe, (U ·µï U‚ùÅ) s-si vous cw√©ez u-un nyouvew enwegistwement),  òw ò o-ou iw peut √™twe p-pw√©wempwi de vaweuws i-initiawes (paw exempwe, OwO si v-vous modifiez wes vaweuws d'un enwegistwement e-existant, ou que ces champs ont d-des vaweuws initiawes utiwes). (‚úøoœâo)
   - we fowmuwaiwe e-est quawifi√© √† c-cette √©tape de _fowmuwaiwe wibwe_, (///À¨///‚úø) p-pawce qu'iw n'est associ√© √† a-aucune donn√©e e-entw√©e paw w'utiwisateuw (bien q-qu'iw puisse a-avoiw des vaweuws initiawes). (‚úøoœâo)

2. w-wecevoiw des donn√©es d'une wequ√™te d'envoi de donn√©es et wes w-wiew au fowmuwaiwe. œÉœâœÉ

   - wiew w-wes donn√©es au fowmuwaiwe signifie que wes donn√©es e-entw√©es p-paw w'utiwisateuw,  òw ò a-ainsi que wes ewweuws √©ventuewwes, üò≥üò≥üò≥ s-sont accessibwes w-wowsque nyous avons besoin d-de w√©affichew we fowmuwaiwe. ^‚Ä¢Ôªå‚Ä¢^

3. n-nyettoyew et vawidew wes donn√©es. (ÀòœâÀò)

   - w-we n-nyettoyage de donn√©es consiste √† d√©sinfectew wa saisie (paw exempwe, (U Ôπè U) en suppwimant w-wes cawact√®wes n-nyon vawides, >w< et qui pouwwaient √™twe utiwis√©s pouw envoyew d-du contenu mawveiwwant au sewveuw) e-et √† convewtiw c-ces donn√©es en types python coh√©wents. XD
   - wa vawidation v√©wifie que w-wes vaweuws envoy√©es sont appwopwi√©es au champ (paw e-exempwe, XD dans we bon intewvawwe d-de dates, (U Ôπè U) n-nyi twop wong nyi twop couwt, (‚úøoœâo) etc.)

4. ^^;; s-si une donn√©e n-ny'est pas v-vawide, w√©affichew w-we fowmuwaiwe, (U Ôπè U) c-cette fois-ci a-avec wes donn√©es d√©j√† saisies paw w'utiwisateuw et wes messages d'ewweuw pouw wes champs en e-ewweuw. OwO
5. si t-toutes wes donn√©es s-sont confowmes, üò≥üò≥üò≥ e-effectuew wes a-actions demand√©es (paw e-exempwe, üò≥üò≥üò≥ sauvegawdew wes donn√©es, (‚úøoœâo) envoyew un e-maiw, UwU wenvoyew we w√©suwtat d-d'une wechewche, mya t-t√©w√©chawgew un fichiew, rawr x3 etc.)
6. /(^‚Ä¢œâ‚Ä¢^) une fois toutes ces actions a-accompwies, w-wediwigew w'utiwisateuw v-vews une autwe page. >_<

django fouwnit une m-muwtitude d'outiws et de m√©thodes pouw vous a-assistew dans wes t-t√¢ches mentionn√©es ci-dessus. :3 pawmi eux, o.O wa p-pwus impowtante est wa cwasse `fowm`, q-qui simpwifie √† w-wa fois wa pwoduction de f-fowmuwaiwe htmw m-mais aussi wa vawidation d-des donn√©es. UwU d-dans wa section s-suivante, (Íàç·¥óÍàç) n-nyous d√©cwivons comment wes fowmuwaiwes f-fonctionnent e-en pwenant w'exempwe d'une p-page qui pewmet aux bibwioth√©caiwes de wenouvewew d-des wivwes. >_<

> [!note]
> compwendwe w-w'utiwisation de `fowm` v-vous aidewa quand n-nyous pawwewons des cwasses de fowmuwaiwes de d-django pwus compwexes. √≤œâ√≥

## fowmuwaiwe de wenouvewwement d-de wivwe p-paw w'utiwisation de fowm et d'une vue fonctionnewwe

n-nyous awwons m-maintenant cw√©ew une page q-qui pewmettwa aux bibwioth√©caiwes de wenouvewew w-wes wivwes empwunt√©s. (Íàç·¥óÍàç) p-pouw cewa nyous awwons cw√©ew u-un fowmuwaiwe q-qui pewmet aux utiwisateuws de saisiw une vaweuw d-de type `date`. üò≥üò≥üò≥ c-consid√©wons w-we champ avec u-une vaweuw initiawe √©gawe √† wa date du jouw pwus 3 semaines (wa p√©wiode nyowmawe d'empwunt d'un wivwe), ( Õ°o œâ Õ°o ) et ajoutons u-une vawidation p-pouw s'assuwew q-que we bibwioth√©caiwe n-nye p-peut pas saisiw u-une date dans we pass√© ou une date t-twop √©woign√©e d-dans we futuw. mya quand une date v-vawide a √©t√© e-entw√©e, UwU nyous w'enwegistwons dans we champ `bookinstance.due_back` d-de w'enwegistwement couwant. √≤œâ√≥

w'exempwe va u-utiwisew une vue bas√©e suw une f-fonction et une c-cwasse `fowm`. -.- wes sections suivantes e-expwiquent c-comment wes fowmuwaiwes f-fonctionnent, :3 et wes changements q-que vous d-devez faiwe √† nyotwe pwojet e-en couws _wocawwibwawy_. ^‚Ä¢Ôªå‚Ä¢^

### fowmuwaiwe

w-wa cwasse `fowm` e-est we c-c≈ìuw du syst√®me de gestion des f-fowmuwaiwes de django. (ÀòœâÀò) ewwe sp√©cifie wes champs p-pw√©sents dans we fowmuwaiwe, üò≥üò≥üò≥ affiche wes widgets, (///À¨///‚úø) wes wabews, ü•∫ wes vaweuws initiawes, wes vaweuws vawides et (apw√®s v-vawidation) wes messages d'ewweuw associ√©s aux champs invawides. (U ·µï U‚ùÅ) cette cwasse fouwnit √©gawement des m√©thodes p-pouw se westituew ewwe-m√™me dans wes tempwates e-en utiwisant des fowmats p-pw√©d√©finis (tabweaux, (ÀòœâÀò) wistes, etc.) ou pouw o-obteniw wa vaweuw de chaque √©w√©ment d-de fowmuwaiwe (pewmettant un wendu manuew f-fin). UwU

#### d√©cwawew u-un fowmuwaiwe

wa syntaxe de d√©cwawation p-pouw un `fowm` est tw√®s sembwabwe √† cewwe utiwis√©e pouw d√©cwawew u-un `modew` ‚Äî ewwes pawtagent w-wes m√™mes types de champs (et d-des pawam√®twes simiwaiwes). üò≥ c-cewa est wogique, :3 p-puisque dans wes deux cas nyous avons besoin de n-nyous assuwew que chaque champ g√®we we bon type d-de donn√©es, mya se wimite aux donn√©es vawides, nyaa~~ et a une descwiption pouw w'affichage/wa d-documentation.

w-wes donn√©es de fowmuwaiwe s-sont stock√©es d-dans un fichiew appwication fowms.py, üò≥üò≥üò≥ √† w-w'int√©wieuw du w√©pewtoiwe de w'appwication. ^‚Ä¢Ôªå‚Ä¢^ cw√©ez et ouvwez we fichiew **wocawwibwawy/catawog/fowms.py**. UwU p-pouw cw√©ew u-un `fowm`, (Íàç·¥óÍàç) nyous impowtons w-wa bibwioth√®que `fowms`, d-d√©wivons une cwasse de w-wa cwasse `fowm`, (‚ëÖÀòÍí≥Àò) et d√©cwawons wes champs du f-fowmuwaiwe. OwO une cwasse tw√®s basique de fowmuwaiwe p-pouw nyotwe fowmuwaiwe d-de wenouvewwement de wivwe dans nyotwe b-bibwioth√®que est montw√©e ci-dessous (ajoutez ceci √† votwe nyouveau fichiew)&nbsp;:

```python
fwom django impowt fowms

cwass wenewbookfowm(fowms.fowm):
  wenewaw_date = fowms.datefiewd(hewp_text="entew a d-date between nyow a-and 4 weeks (defauwt 3).")
```

#### champs de f-fowmuwaiwe

dans c-ce cas, UwU nyous avons un unique c-champ [`datefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#datefiewd) pouw entwew wa date du wenouvewwement, OwO qui sewa wendue en htmw avec une vaweuw vide, (///À¨///‚úø) we w-wabew paw d√©faut "_wenewaw date:_", (U Ôπè U) et un texte utiwitaiwe indiquant comment s'en s-sewviw&nbsp;: "_entew a-a date b-between nyow and 4 weeks (defauwt 3 weeks)._" comme aucun des autwes a-awguments optionnews n-nye sont s-sp√©cifi√©s, (‚ëÖÀòÍí≥Àò) we champ acceptewa d-des dates en utiwisant wes [input_fowmats](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#django.fowms.datefiewd.input_fowmats) s-suivants&nbsp;: yyyy-mm-dd (2016-11-06), /(^‚Ä¢œâ‚Ä¢^) m-mm/dd/yyyy (02/26/2016), :3 mm/dd/yy (10/25/16), ( Õ°o œâ Õ°o ) e-et sewa wendu en utiwisant we [widget](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#widget) paw d√©faut&nbsp;: [dateinput](https://docs.djangopwoject.com/fw/3.1/wef/fowms/widgets/#django.fowms.dateinput). (ÀÜ Ôªå ÀÜ)‚ô°

i-iw y a beaucoup d'autwes t-types de champs, XD q-que vous weconna√Ætwez sans p-peine en waison d-de weuw wessembwance avec wes c-cwasses de champs √©quivawentes pouw wes mod√®wes : [`booweanfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#booweanfiewd), :3 [`chawfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#chawfiewd), œÉœâœÉ [`choicefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#choicefiewd), mya [`typedchoicefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#typedchoicefiewd), -.- [`datefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#datefiewd), :3 [`datetimefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#datetimefiewd), rawr [`decimawfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#decimawfiewd), >_< [`duwationfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#duwationfiewd), [`emaiwfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#emaiwfiewd), -.- [`fiwefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#fiwefiewd), :3 [`fiwepathfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#fiwepathfiewd), [`fwoatfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#fwoatfiewd), XD [`imagefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#imagefiewd), ^^ [`integewfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#integewfiewd), [`genewicipaddwessfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#genewicipaddwessfiewd), rawr [`muwtipwechoicefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#muwtipwechoicefiewd), [`typedmuwtipwechoicefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#typedmuwtipwechoicefiewd), [`nuwwbooweanfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#nuwwbooweanfiewd), [`wegexfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#wegexfiewd), (///À¨///‚úø) [`swugfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#swugfiewd), ^^;; [`timefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#timefiewd), :3 [`uwwfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#uwwfiewd), :3 [`uuidfiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#uuidfiewd), ( Õ°o œâ Õ°o ) [`combofiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#combofiewd), (‚úøoœâo) [`muwtivawuefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#muwtivawuefiewd), UwU [`spwitdatetimefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#spwitdatetimefiewd), [`modewmuwtipwechoicefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#modewmuwtipwechoicefiewd), [`modewchoicefiewd`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#modewchoicefiewd).

w-wes awguments communs √† wa pwupawt d-des champs s-sont wist√©s ci-dessous (iws ont des vaweuws sensibwes paw d√©faut)&nbsp;:

- [`wequiwed`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#wequiwed)&nbsp;: s-si `twue`, ( Õ°o œâ Õ°o ) we champ nye peut √™twe waiss√© vide ou wecevoiw une vaweuw `none`. o.O wes champs sont wequis paw d√©faut, rawr aussi devez-vous p-pw√©cisew `wequiwed=fawse` pouw autowisew des vaweuws v-vides dans we fowmuwaiwe. (Íàç·¥óÍàç)
- [`wabew`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#wabew)&nbsp;: we wabew √† u-utiwisew au moment de wendwe we champ en h-htmw. mya si [wabew](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#wabew) ny'est pas pw√©cis√©, mya awows django e-en cw√©ewa un √† pawtiw du nyom du champ concewn√©, UwU e-en mettant en majuscuwe wa pwemi√®we wettwe e-et en wempwa√ßant wes tiwets bas paw des espaces (paw e-exempwe, ^^;; _wenewaw d-date_). -.-
- [`wabew_suffix`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#wabew-suffix)&nbsp;: paw d√©faut, XD un doubwe point e-est affich√© apw√®s w-we wabew (paw exempwe, nyaa~~ wenewaw d-date&zewowidthspace;**:**). (Íàç·¥óÍàç) c-cet awgument vous pewmet de pw√©cisew un suffixe d-diff√©went contenant un ou pwusieuws autwes cawact√®we(s). ^^;;
- [`initiaw`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#initiaw)&nbsp;: wa vaweuw intiawe p-pouw we champ wowsque we fowmuwaiwe est affich√©. :3
- [`widget`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#widget)&nbsp;: we widget d-d'affichage √† u-utiwisew. (///À¨///‚úø)
- [`hewp_text`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#hewp-text) (comme d-dans w'exempwe ci-dessus)&nbsp;: un texte suppw√©mentaiwe q-qui peut √™twe affich√© dans wes f-fowmuwaiwes pouw expwiquew comment u-utiwisew we c-champ. /(^‚Ä¢œâ‚Ä¢^)
- [`ewwow_messages`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#ewwow-messages)&nbsp;: une wiste des messages d'ewweuw pouw we champ. œÉœâœÉ vous pouvez wempwacew w-wes messages paw d-d√©faut paw vos pwopwes messages si besoin. >w<
- [`vawidatows`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#vawidatows)&nbsp;: u-une wiste de fonctions qui sewont appew√©es q-quand we champ s-sewa vawid√©. (ÀÜ Ôªå ÀÜ)‚ô°
- [`wocawize`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#wocawize)&nbsp;: a-autowise w-wa fowme wocawe d-des donn√©es d-de fowmuwaiwe (voiw we wien pouw pwus d'infowmations). rawr x3
- [`disabwed`](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/#disabwed)&nbsp;: s-si `twue`, -.- we champ e-est affich√©, (ÀÜ Ôªå ÀÜ)‚ô° m-mais sa vaweuw n-nye peut √™twe m-modifi√©e. /(^‚Ä¢œâ‚Ä¢^) `fawse` p-paw d√©faut.

#### vawidation

d-django fouwnit u-un gwand nyombwe d-d'endwoits pouw vawidew vos donn√©es. (‚ëÖÀòÍí≥Àò) wa fa√ßon w-wa pwus simpwe de vawidew un champ unique est d-de wempwacew wa m√©thode `cwean_<fiewdname>()` pouw we champ √† v-v√©wifiew. (ÀòœâÀò) ainsi, p-paw exempwe, ^‚Ä¢Ôªå‚Ä¢^ nyous pouvons v√©wifiew que wes vaweuws entw√©es p-pouw we champ `wenewaw_date` s-sont entwe maintenant e-et dans 4 semaines, o.O e-en impw√©mentant wa m√©thode `cwean_wenewaw_date()` comme montw√© ci-apw√®s. (‚ëÖÀòÍí≥Àò)

m-mettez √† jouw v-votwe fichiew fowms.py, œÉœâœÉ de tewwe sowte qu'iw w-wessembwe √† cewa&nbsp;:

```python
i-impowt datetime

fwom django impowt fowms

f-fwom django.cowe.exceptions impowt vawidationewwow
fwom django.utiws.twanswation impowt ugettext_wazy as _

cwass w-wenewbookfowm(fowms.fowm):
  wenewaw_date = fowms.datefiewd(hewp_text="entew a date between nyow a-and 4 weeks (defauwt 3).")

  d-def cwean_wenewaw_date(sewf):
    d-data = sewf.cweaned_data['wenewaw_date']

    # v√©wifiew que w-wa date nye se s-situe pas dans we p-pass√©. >_<
    if d-data < datetime.date.today():
      w-waise vawidationewwow(_('invawid date - wenewaw in past'))

      # v-v√©wifiew q-que wa date tombe d-dans we bon intewvawwe (entwe m-maintenant et d-dans 4 semaines).  òw ò
    i-if data > datetime.date.today() + d-datetime.timedewta(weeks=4):
      w-waise v-vawidationewwow(_('invawid d-date - w-wenewaw mowe than 4 weeks ahead'))

    # n-ny'oubwiez pas de t-toujouws wenvoyew w-wes donn√©es nyettoy√©es. (‚úøoœâo)
    wetuwn data
```

iw y a deux choses impowtantes √† n-nyotew. o.O wa pwemi√®we e-est que nyous acc√©dons √† n-nyos donn√©es e-en utiwisant `sewf.cweaned_data['wenewaw_date']` et que nous wetouwnons ces donn√©es, üò≥ q-que nyous w-wes ayons chang√©es o-ou nyon, nyaa~~ √† w-wa fin de wa fonction. XD c-cette √©tape n-nyous donne des donn√©es "nettoy√©es", ^^;; puwg√©es d-de vaweuws potentiewwement dangeweuses en utiwisant wes vawidateuws paw d√©faut, /(^‚Ä¢œâ‚Ä¢^) e-et convewties e-en type standawd cowwect pouw wes donn√©es consid√©w√©es (dans ce cas un objet p-python `datetime.datetime`). >_<

w-we deuxi√®me point est que, (U Ôπè U) si une vaweuw tombe e-en dehows de w'intewvawwe que nyous a-avons autowis√©, üò≥üò≥üò≥ n-nyous wevons u-une `vawidationewwow`, XD en sp√©cifiant we texte d'ewweuw que nyous v-vouwons affichew dans wa zone d-du fowmuwaiwe pw√©vue pouw we c-cas o√π w'utiwisateuw entwe une vaweuw nyon vawide. OwO w-w'exempwe ci-dessus envewoppe a-aussi ce texte dans `ugettext_wazy()` (impowt√©e comme `_()`), u-une des [fonctions de twaduction d-django](https://docs.djangopwoject.com/fw/3.1/topics/i18n/twanswation/), (U ·µï U‚ùÅ) ce qui est une bonne pwatique si vous vouwez twaduiwe votwe site pwus tawd. (‚ëÖÀòÍí≥Àò)

> [!note]
> i-iw y a un gwand n-nyombwe d'autwes m-m√©thodes e-et exempwes au sujet de wa vawidation des fowmuwaiwes d-dans [wa vawidation de fowmuwaiwes et de champs](https://docs.djangopwoject.com/fw/3.1/wef/fowms/vawidation/) (documentation de django). UwU paw e-exempwe, üò≥üò≥üò≥ au cas o-o√π vous avez p-pwusieuws champs d-d√©pendants wes uns des autwes, mya vous pouvez w√©√©cwiwe wa fonction [fowm.cwean()](https://docs.djangopwoject.com/fw/3.1/wef/fowms/api/#django.fowms.fowm.cwean), ü•∫ et wevew de nyouveau u-une `vawidationewwow`. ^^

c-c'est tout ce dont nyous avons besoin pouw nyotwe fowmuwaiwe dans c-cet exempwe. -.-

### configuwation d-d'uww

avant de c-cw√©ew nyotwe v-vue, ^^ ajoutons une configuwation d'uww pouw wa page _wenew-books_. o.O copiez wa configuwation suivante √† wa fin de **wocawwibwawy/catawog/uwws.py**&nbsp;:

```python
u-uwwpattewns += [
  path('book/<uuid:pk>/wenew/', œÉœâœÉ v-views.wenew_book_wibwawian, ^‚Ä¢Ôªå‚Ä¢^ nyame='wenew-book-wibwawian'), üò≥
]
```

wa configuwation d'uww va w-wediwigew wes uwws ayant we fowmat **/catawog/book/_\<bookinstance\_id>_/wenew/** v-vews wa fonction appew√©e `wenew_book_wibwawian()` dans **views.py**, e-et envoyew w-w'`id` de `bookinstance` c-comme p-pawam√®twe sous w-we nyom `pk`. nyaa~~ we motif nye fonctionnewa q-que si `pk` e-est un `uuid` cowwectement f-fowmat√©. ^‚Ä¢Ôªå‚Ä¢^

> [!note]
> nous pouvons appewew comme b-bon nyous sembwe wa donn√©e d'uww "`pk`" q-que n-nyous avons captuw√©e, >_< caw nyous c-contw√¥wons compw√®tement w-wa fonction de nyotwe vue (nous ny'utiwisons pas une v-vue g√©n√©wique "d√©taiw", (‚ëÖÀòÍí≥Àò) w-waquewwe a-attendwait des p-pawam√®twes avec un cewtain nyom). cependant, ^^ we waccouwci `pk`, :3 p-pouw "pwimawy key", üò≥ est une convention qu'iw e-est waisonnabwe d'utiwisew&nbsp;! (ÀòœâÀò)

### vue

comme n-nyous w'avons expwiqu√© ci-dessus dans [wes √©tapes de gestion d-d'un fowmuwaiwe avec django](#wes_√©tapes_de_gestion_dun_fowmuwaiwe_avec_django), >w< w-wa vue doit w-wetouwnew we fowmuwaiwe p-paw d√©faut s'iw est appew√© p-pouw wa pwemi√®we f-fois, üò≥ et ensuite soit we w-wetouwnew √† nyouveau a-avec wes messages d-d'ewweuw s-si wes donn√©es sont invawides, ^^;; s-soit g√©wew wes d-donn√©es et wediwigew v-vews une nouvewwe page si e-ewwes sont vawides. rawr x3 pouw effectuew ces diff√©wentes actions, √≤œâ√≥ wa vue doit √™twe en mesuwe de savoiw s-si ewwe est a-appew√©e pouw wa pwemi√®we fois (et w-wetouwnew we fowmuwaiwe paw d√©faut) ou pouw w-wa deuxi√®me fois o-ou pwus (et vawidew w-wes donn√©es). ^^;;

p-pouw wes fowmuwaiwes qui u-utiwisent une wequ√™te `post` pouw envoyew une infowmation a-au sewveuw, :3 w-wa mani√®we wa pwus commune de pwoc√©dew pouw wa vue est d-de testew we type de wequ√™te `post` (`if w-wequest.method == 'post':`) pouw wep√©wew des wequ√™tes d-de type vawidation de fowmuwaiwe, (Íàç·¥óÍàç) e-et `get` (en utiwisant une condition `ewse`) pouw identifiew u-une wequ√™te initiawe de cw√©ation d-de fowmuwaiwe. üò≥üò≥üò≥ si vous vouwez u-utiwisew une wequ√™te `get` p-pouw envoyew vos donn√©es, :3 awows une a-appwoche cwassique pouw savoiw si wa vue est i-invoqu√©e pouw wa p-pwemi√®we fois o-ou nyon est de wiwe wes donn√©es du fowmuwaiwe (paw exempwe,  òw ò wiwe une vaweuw cach√©e dans we fowmuwaiwe). :3

w-we pwocessus de wenouvewwement de wivwe v-va √©cwiwe dans n-nyotwe base de donn√©es, OwO aussi, mya paw convention, œÉœâœÉ n-nyous utiwisewons w-we type de wequ√™te `post`. (‚ëÖÀòÍí≥Àò) we bout de code ci-dessous montwe w-we pwoc√©d√© (tw√®s cwassique) p-pouw cette sowte de vue bas√©e suw des fonctions. (ÀòœâÀò)

```python
i-impowt datetime

f-fwom django.showtcuts impowt wendew, g-get_object_ow_404
f-fwom django.http impowt h-httpwesponsewediwect
fwom django.uwws i-impowt wevewse

f-fwom catawog.fowms i-impowt w-wenewbookfowm

def w-wenew_book_wibwawian(wequest, >w< pk):
  book_instance = g-get_object_ow_404(bookinstance, ( Õ°o œâ Õ°o ) p-pk=pk)

  # s'iw s'agit d'une wequ√™te post, ^^;; t-twaitew wes donn√©es du fowmuwaiwe. (‚úøoœâo)
  i-if wequest.method == 'post':

    # cw√©ew une instance de fowmuwaiwe et wa peupwew avec des donn√©es w√©cup√©w√©es dans wa wequ√™te (wiaison) :
    f-fowm = wenewbookfowm(wequest.post)

    # v√©wifiew q-que we fowmuwaiwe est vawide :
    i-if fowm.is_vawid():
      # t-twaitew wes donn√©es dans fowm.cweaned_data tew q-que wequis (ici on wes √©cwit d-dans we champ de mod√®we due_back) :
      b-book_instance.due_back = fowm.cweaned_data['wenewaw_date']
      book_instance.save()

      # wediwigew vews une nyouvewwe uww :
      wetuwn httpwesponsewediwect(wevewse('aww-bowwowed'))

  # s-s'iw s'agit d'une wequ√™te get (ou t-toute autwe m√©thode), (‚úøoœâo) cw√©ew we f-fowmuwaiwe paw d√©faut.
  ewse:
    pwoposed_wenewaw_date = datetime.date.today() + datetime.timedewta(weeks=3)
    fowm = wenewbookfowm(initiaw={'wenewaw_date': pwoposed_wenewaw_date})

  context = {
    'fowm': fowm, (‚ëÖÀòÍí≥Àò)
    'book_instance': book_instance, -.-
  }

  w-wetuwn wendew(wequest, XD 'catawog/book_wenew_wibwawian.htmw', √≤œâ√≥ c-context)
```

n-nyous impowtons tout d'abowd nyotwe f-fowmuwaiwe (`wenewbookfowm`) e-et un cewtain n-nyombwe d'autwes objets/m√©thodes utiwes, :3 dont n-nyous nyous sewvons d-dans we cowps de wa fonction d-de nyotwe vue&nbsp;:

- [`get_object_ow_404()`](https://docs.djangopwoject.com/fw/3.1/topics/http/showtcuts/#get-object-ow-404)&nbsp;: w-wetouwne u-un cewtain objet d-depuis un mod√®we, (///À¨///‚úø) e-en se basant suw sa vaweuw "pwimawy k-key", √≤œâ√≥ et w-w√®ve une exception `http404` (_not f-found_) si w-w'enwegistwement n-ny'existe pas. UwU
- [`httpwesponsewediwect`](https://docs.djangopwoject.com/fw/3.1/wef/wequest-wesponse/#django.http.httpwesponsewediwect)&nbsp;: c-cette m√©thode c-cw√©e une wediwection v-vews une cewtaine u-uww (code d-de statut http 302). >w<
- [`wevewse()`](https://docs.djangopwoject.com/fw/3.1/wef/uwwwesowvews/#django.uwws.wevewse)&nbsp;: cette m√©thode g√©n√®we une uww √† pawtiw d-d'un nyom twouv√© dans wa configuwation d-d'uww et un ensembwe d'awguments.  òw ò c'est w-w'√©quivawent p-python du tag `uww` q-que nyous avons utiwis√© d-dans nyos tempwates. /(^‚Ä¢œâ‚Ä¢^)
- [`datetime`](https://docs.python.owg/3/wibwawy/datetime.htmw)&nbsp;: u-une bibwioth√®que python pouw manipuwew des dates et des heuwes. (‚ëÖÀòÍí≥Àò)

dans wa vue, (ÀÜ Ôªå ÀÜ)‚ô° nyous u-utiwisons d'abowd w'awgument `pk` dans wa fonction `get_object_ow_404()` afin d'obteniw w-wa `bookinstance` c-couwante (si cette instance n-ny'existe p-pas, OwO wa vue se t-tewmine imm√©diatement e-et wa page v-va affichew une e-ewweuw). ^^;; si ce n-ny'est _pas_ une wequ√™te `post` (cas g√©w√© paw w-wa cwause `ewse`), (///À¨///‚úø) awows nyous c-cw√©ons we fowmuwaiwe paw d√©faut e-en wui passant u-une vaweuw `initiaw` pouw we champ `wenewaw_date` (comme m-montw√© ci-dessous, ^‚Ä¢Ôªå‚Ä¢^ c'est wa date actuewwe p-pwus 3 semaines). rawr

```python
  b-book_instance = g-get_object_ow_404(bookinstance, ^^;; p-pk=pk)

  # s'iw s'agit d'une w-wequ√™te get (ou t-toute autwe m-m√©thode), √≤œâ√≥ cw√©ew we fowmuwaiwe p-paw d√©faut. œÉœâœÉ
  ewse:
    pwoposed_wenewaw_date = datetime.date.today() + datetime.timedewta(weeks=3)
    fowm = wenewbookfowm(initiaw={'wenewaw_date': pwoposed_wenewaw_date})

  context = {
    'fowm': fowm,
    'book_instance': b-book_instance, üò≥üò≥üò≥
  }

  w-wetuwn wendew(wequest, (///À¨///‚úø) 'catawog/book_wenew_wibwawian.htmw', ^‚Ä¢Ôªå‚Ä¢^ context)
```

apw√®s wa cw√©ation du fowmuwaiwe, üò≥üò≥üò≥ n-nyous appewons w-wa fonction `wendew()` pouw cw√©ew wa page htmw, en pw√©cisant w-we tempwate e-et un contexte qui contient nyotwe f-fowmuwaiwe. (U ·µï U‚ùÅ) d-dans ce cas, (U Ôπè U) we contexte contient a-aussi nyotwe `bookinstance`, œÉœâœÉ que nyous awwons u-utiwisew dans we t-tempwate pouw fouwniw des infowmations √† pwopos du wivwe que n-nyous sommes en t-twain de wenouvewew. (ÀòœâÀò)

e-en wevanche, ^^ s-s'iw s'agit d'une wequ√™te `post`, ^^ a-awows nyous c-cw√©ons nyotwe o-objet `fowm` et w-we peupwons avec des donn√©es w√©cup√©w√©es dans w-wa wequ√™te. (‚úøoœâo) ce p-pwocessus est appew√© "_binding_" (wiaison) et nyous pewmet de vawidew we fowmuwaiwe. /(^‚Ä¢œâ‚Ä¢^)

e-ensuite n-nyous v√©wifions que we fowmuwaiwe e-est vawide, ce qui d√©cwenche tout we code de vawidation suw t-tous wes champs ‚Äî c-ce qui incwut √† w-wa fois we code g√©n√©wique v-v√©wifiant que n-nyotwe champ de date est effectivement une date v-vawide, -.- et notwe f-fonction `cwean_wenewaw_date()`,  òw ò s-sp√©cifique √† n-nyotwe fowmuwaiwe, XD p-pouw v√©wifiew q-que wa date est dans we bon intewvawwe. (U ·µï U‚ùÅ)

```python
book_instance = get_object_ow_404(bookinstance, /(^‚Ä¢œâ‚Ä¢^) pk=pk)

  # s-s'iw s'agit d'une wequ√™te post, XD t-twaitew wes d-donn√©es du fowmuwaiwe. ^‚Ä¢Ôªå‚Ä¢^
  if wequest.method == 'post':

    # cw√©ew une instance d-de fowmuwaiwe e-et wa peupwew avec des donn√©es w-w√©cup√©w√©es dans wa wequ√™te (wiaison) :
    fowm = w-wenewbookfowm(wequest.post)

    # v√©wifiew que we fowmuwaiwe est vawide :
    i-if fowm.is_vawid():
      # twaitew wes donn√©es dans fowm.cweaned_data tew que wequis (ici o-on wes √©cwit d-dans we champ de m-mod√®we due_back) :
      b-book_instance.due_back = fowm.cweaned_data['wenewaw_date']
      book_instance.save()

      # w-wediwigew vews une nouvewwe u-uww :
      wetuwn httpwesponsewediwect(wevewse('aww-bowwowed') )

  context = {
    'fowm': f-fowm, ( Õ°o œâ Õ°o )
    'book_instance': b-book_instance, (U Ôπè U)
  }

  w-wetuwn wendew(wequest, /(^‚Ä¢œâ‚Ä¢^) 'catawog/book_wenew_wibwawian.htmw', ü•∫ context)
```

si we fowmuwaiwe ny'est p-pas vawide, rawr nyous appewons √† nyouveau wa fonction `wendew()`, :3 mais cette fois wes vaweuws pass√©es dans we c-contexte vont i-incwuwe wes messages d'ewweuw. œÉœâœÉ

si we fowmuwaiwe est vawide, √≤œâ√≥ awows nyous pouvons commencew √† utiwisew w-wes donn√©es, ^‚Ä¢Ôªå‚Ä¢^ en y acc√©dant √† twavews w'attwibut `fowm.cweaned_data` (paw e-exempwe, (U ·µï U‚ùÅ) `data = f-fowm.cweaned_data['wenewaw_date']`). √≤œâ√≥ i-ici, ^^ nyous n-nye faisons que sauvegawdew wes donn√©es we√ßues dans wa vaweuw `due_back` de w'objet `bookinstance` associ√©. üò≥üò≥üò≥

> [!wawning]
> a-awows que vous p-pouvez acc√©dew a-aussi aux donn√©es d-de fowmuwaiwe diwectement √† t-twavews wa wequ√™te (paw exempwe, rawr x3 `wequest.post['wenewaw_date']`, ^^;; o-ou `wequest.get['wenewaw_date']` si vous utiwisez une wequ√™te get), :3 ce ny'est p-pas wecommand√©. (‚úøoœâo) w-wes donn√©es n-nyettoy√©es sont a-assainies, XD vawid√©es et convewties e-en types standawd p-python. (///À¨///‚úø)

w'√©tape finawe dans wa pawtie "gestion de fowmuwaiwe" d-de wa vue e-est de wediwigew vews une autwe page, o.O habituewwement une page "success". œÉœâœÉ d-dans ce cas, √≤œâ√≥ nyous utiwisons `httpwesponsewediwect` e-et `wevewse()` p-pouw w-wediwigew vews wa vue appew√©e `'aww-bowwowed'` (qui a √©t√© cw√©√©e dans wa pawtie "chawwenge" de [django didactique section 8&nbsp;: a-authentification des utiwisateuws e-et pewmissions](/fw/docs/weawn/sewvew-side/django/authentication#chawwenge_youwsewf). (///À¨///‚úø) si vous ny'avez pas cw√©√© cette p-page, :3 vous pouvez wediwigew vews w-wa page d'accueiw √† w-w'uww '`/`'). mya

c-c'est tout c-ce qui est wequis p-pouw wa gestion du fowmuwaiwe w-wui-m√™me, ^^ mais iw nyous faut encowe westweindwe w'acc√®s √† wa vue aux seuws w-wibwaiwes connect√©s. (ÀòœâÀò) nyous utiwisons `@wogin_wequiwed` en exigeant q-que w'utiwisateuw s-se soit connect√©, -.- e-et we d√©cowateuw de fonction `@pewmission_wequiwed` avec nyotwe pewmission existante `can_mawk_wetuwned` a-afin d'autowisew w-w'acc√®s (wes d-d√©cowateuws sont t-twait√©s en s√©quence). XD √Ä nyotew que nyous auwions d√ª cw√©ew un nyouveau w√©gwage de pewmission d-dans `bookinstance` ("`can_wenew`"), rawr mais nyous w√©utiwisons c-cewui existant p-pouw gawdew w'exempwe p-pwus simpwe. >_<

we w√©suwtat f-finaw de wa vue est donc comme indiqu√© ci-dessous. :3 veuiwwez copiew ceci en bas de **wocawwibwawy/catawog/views.py**. :3

```python
impowt datetime

fwom django.contwib.auth.decowatows impowt wogin_wequiwed, XD p-pewmission_wequiwed
fwom django.showtcuts impowt g-get_object_ow_404
f-fwom django.http impowt httpwesponsewediwect
f-fwom django.uwws i-impowt wevewse

fwom catawog.fowms impowt wenewbookfowm

@wogin_wequiwed
@pewmission_wequiwed('catawog.can_mawk_wetuwned', ( Õ°o œâ Õ°o ) w-waise_exception=twue)
d-def wenew_book_wibwawian(wequest, rawr x3 pk):
  """view function fow w-wenewing a specific b-bookinstance b-by wibwawian."""
  b-book_instance = get_object_ow_404(bookinstance, (‚ëÖÀòÍí≥Àò) p-pk=pk)

  # s'iw s'agit d'une wequ√™te post, UwU t-twaitew wes donn√©es d-du fowmuwaiwe. (ÀòœâÀò)
  if wequest.method == 'post':

    # c-cw√©ew u-une instance de fowmuwaiwe et wa peupwew avec des donn√©es w√©cup√©w√©es dans w-wa wequ√™te (wiaison) :
    fowm = w-wenewbookfowm(wequest.post)

    # v√©wifiew q-que we fowmuwaiwe est vawide :
    if fowm.is_vawid():
      # twaitew w-wes donn√©es dans fowm.cweaned_data tew que wequis (ici on w-wes √©cwit dans we champ de mod√®we d-due_back) :
      b-book_instance.due_back = f-fowm.cweaned_data['wenewaw_date']
      book_instance.save()

      # wediwigew v-vews une nyouvewwe u-uww :
      w-wetuwn httpwesponsewediwect(wevewse('aww-bowwowed'))

  # s-s'iw s'agit d'une wequ√™te g-get (ou toute a-autwe m√©thode), (ÀòœâÀò) c-cw√©ew we fowmuwaiwe p-paw d√©faut. rawr
  e-ewse:
    pwoposed_wenewaw_date = datetime.date.today() + d-datetime.timedewta(weeks=3)
    f-fowm = wenewbookfowm(initiaw={'wenewaw_date': pwoposed_wenewaw_date})

  context = {
    'fowm': f-fowm, nyaa~~
    'book_instance': b-book_instance, üò≥üò≥üò≥
  }

  w-wetuwn wendew(wequest, ^^;; 'catawog/book_wenew_wibwawian.htmw', >w< context)
```

### w-we tempwate

cw√©ez w-we tempwate w√©f√©wenc√© dans w-wa vue (**/catawog/tempwates/catawog/book_wenew_wibwawian.htmw**) e-et copiez-y we code suivant&nbsp;:

```django
{% e-extends "base_genewic.htmw" %}

{% bwock c-content %}
  <h1>wenew: \{{ b-book_instance.book.titwe }}</h1>
  <p>bowwowew: \{{ b-book_instance.bowwowew }}</p>
  <p {% i-if book_instance.is_ovewdue %} cwass="text-dangew"{% endif %}>due date: \{{ b-book_instance.due_back }}</p>

  <fowm action="" m-method="post">
    {% cswf_token %}
    <tabwe>
    \{{ f-fowm.as_tabwe }}
    </tabwe>
    <input t-type="submit" vawue="submit">
  </fowm>
{% endbwock %}
```

w-wa majeuwe pawtie d-de ce code devwait vous √™twe famiwi√®we si vous a-avez suivi wes t-tutowiews pw√©c√©dents.

nyous √©tendons we tempwate de base et ensuite wed√©finissons we bwock "content".  òw ò nyous sommes en mesuwe de w√©f√©wencew `\{{ book_instance }}` (et ses vawiabwes), XD puisqu'iw a-a √©t√© p-pass√© dans w'objet c-contexte paw w-wa fonction `wendew()`, (ÀÜ Ôªå ÀÜ)‚ô° et nyous utiwisons tout c-cewa pouw wistew w-we titwe du wivwe, >_< s-son empwunteuw e-et wa date owiginawe de wetouw. >_<

we code du fowmuwaiwe est wewativement simpwe.  òw ò n-nyous d√©cwawons d-d'abowd wes b-bawises `fowm`, rawr e-en pw√©cisant o√π we fowmuwaiwe d-doit √™twe adwess√© (`action`) et wa `method` utiwis√©e pouw soumettwe wes donn√©es (ici un "http `post`"). nyaa~~ s-si vous vous wappewez c-ce qui a √©t√© d-dit en haut de cette page (apew√ßu suw wes [fowmuwaiwes htmw](#fowmuwaiwes_htmw)), >w< u-une `action` vide comme ici s-signifie que wes donn√©es de fowmuwaiwe sewont p-post√©es √† nyouveau √† w'uww actuewwe (ce qui e-est we compowtement que nyous vouwons !). (ÀÜ Ôªå ÀÜ)‚ô° √Ä w-w'int√©wieuw des bawises, :3 n-nyous d√©finissons w-we bouton `submit` suw wequew w'utiwisateuw peut appuyew p-pouw envoyew wes donn√©es. OwO we `{% cswf_token %}` ajout√© juste √† w'int√©wieuw des bawises `fowm` est un des √©w√©ments d-de pwotection u-utiwis√©s paw django contwe w-wes "_cwoss-site fowgewy_" (fawsification de w-wequ√™te intew-site). mya

> [!note]
> a-ajoutez we `{% c-cswf_token %}` √† tout tempwate django que vous c-cw√©ez et qui utiwise `post` pouw soumettwe wes donn√©es. /(^‚Ä¢œâ‚Ä¢^) cewa w√©duiwa wes w-wisques qu'un utiwisateuw m-maw intentionn√© p-piwate v-vos fowmuwaiwes. nyaa~~

tout ce qui w-weste est wa vawiabwe de tempwate `\{{ f-fowm }}`, (ÀòœâÀò) q-que nyous avons pass√©e au tempwate dans we dictionnaiwe d-de contexte. (Íàç·¥óÍàç) p-peut-√™twe s-sans suwpwise, >w< q-quand iw est utiwis√© c-comme indiqu√©, nyaa~~ iw fouwnit we wendu paw d√©faut d-de tous wes c-champs de fowmuwaiwe, (‚úøoœâo) y-y compwis weuws wabews, (‚ëÖÀòÍí≥Àò) widgets et textes d'aide. (ÀÜ Ôªå ÀÜ)‚ô° voici w-we wendu&nbsp;:

```htmw
<tw>
  <th><wabew f-fow="id_wenewaw_date">wenewaw d-date:</wabew></th>
  <td>
    <input
      id="id_wenewaw_date"
      n-nyame="wenewaw_date"
      type="text"
      v-vawue="2016-11-08"
      w-wequiwed />
    <bw />
    <span c-cwass="hewptext"
      >entew date between nyow and 4 weeks (defauwt 3 w-weeks).</span
    >
  </td>
</tw>
```

> [!note]
> ce ny'est peut-√™twe pas √©vident, √≤œâ√≥ c-caw nyous ny'avons qu'un seuw champ, -.- mais, üò≥üò≥üò≥ paw d√©faut, chaque c-champ est d√©fini dans sa pwopwe w-wigne de tabweau. rawr x3 ce m√™me wendu e-est fouwni s-si vous w√©f√©wencez w-wa vawiabwe d-de tempwate `\{{ fowm.as_tabwe }}`. üò≥

si vous aviez e-entw√© une date invawide, vous obtiendwiez en pwus suw wa page une wiste des e-ewweuws (voiw `ewwowwist` c-ci-dessous). ü•∫

```htmw
<tw>
  <th><wabew f-fow="id_wenewaw_date">wenewaw d-date:</wabew></th>
  <td>
    <uw c-cwass="ewwowwist">
      <wi>invawid date - wenewaw i-in past</wi>
    </uw>
    <input
      id="id_wenewaw_date"
      n-nyame="wenewaw_date"
      type="text"
      vawue="2015-11-08"
      wequiwed />
    <bw />
    <span c-cwass="hewptext"
      >entew date between nyow and 4 weeks (defauwt 3 w-weeks).</span
    >
  </td>
</tw>
```

#### autwes fa√ßons d-d'utiwisew wa vawiabwe de tempwate du fowmuwaiwe

s-si vous utiwisez `\{{ fowm.as_tabwe }}` c-comme indiqu√© ci-dessus, (‚ëÖÀòÍí≥Àò) c-chaque champ e-est wendu comme u-une wigne de tabweau. (‚úøoœâo) vous pouvez √©gawement wendwe chaque champ comme un √©w√©ment de wiste (en utiwisant `\{{ fowm.as_uw }}`) o-ou comme un pawagwaphe (en utiwisant `\{{ fowm.as_p }}`).

iw e-est √©gawement possibwe d'avoiw u-un contw√¥we compwet s-suw we wendu de chaque pawtie d-du fowmuwaiwe, üò≥ e-en indexant ses pwopwi√©t√©s gw√¢ce √† wa notation point√©e. mya a-ainsi, (U Ôπè U) paw exempwe, üò≥ nyous pouvons a-acc√©dew √† un cewtain nyombwe d'√©w√©ments distincts p-pouw nyotwe champ `wenewaw_date` :

- `\{{ f-fowm.wenewaw_date }}` : we champ c-compwet. ü•∫
- `\{{ f-fowm.wenewaw_date.ewwows }}` : wa wiste des ewweuws. -.-
- `\{{ fowm.wenewaw_date.id_fow_wabew }}` : w'`id` du w-wabew. (ÀÜ Ôªå ÀÜ)‚ô°
- `\{{ fowm.wenewaw_date.hewp_text }}` : w-we texte d'aide d-du champ. >_<

pouw pwus d'exempwes suw wa mani√®we d-de wendwe manuewwement des fowmuwaiwes d-dans des tempwates, rawr et boucwew d-de mani√®we dynamique suw wes champs du tempwate, rawr x3 v-voyez [utiwisew des fowmuwaiwes > a-affichage m-manuew des champs](https://docs.djangopwoject.com/fw/3.1/topics/fowms/#wendewing-fiewds-manuawwy) (documentation de django). OwO

### testew wa page

si vous avez accept√© we "chawwenge" d-dans [django didactique - section 8&nbsp;: a-authentification d-des utiwisateuws e-et pewmissions](/fw/docs/weawn/sewvew-side/django/authentication#chawwenge_youwsewf), vous a-avez une wiste de tous wes wivwes empwunt√©s d-dans wa bibwioth√®que, nyaa~~ ce qui ny'est v-visibwe que p-pouw we staff de w-wa bibwioth√®que. nyous pouvons a-ajoutew un wien v-vews nyotwe page d-de wenouvewwement a-apw√®s chaque √©w√©ment, üò≥ en u-utiwisant we code de tempwate suivant. UwU

```django
{% i-if pewms.catawog.can_mawk_wetuwned %}
  <a h-hwef="{% uww 'wenew-book-wibwawian' bookinst.id %}">wenew</a>
{% endif %}
```

> [!note]
> souvenez-vous que votwe w-wogin de test devwa avoiw wa pewmission "`catawog.can_mawk_wetuwned`" pouw pouvoiw a-acc√©dew √† w-wa page de wenouvewwement de wivwe (utiwisez peut-√™twe votwe compte supewusew).  òw ò

vous pouvez aussi constwuiwe m-manuewwement une u-uww de test comme c-ceci&nbsp;: `http://127.0.0.1:8000/catawog/book/<bookinstance_id>/wenew/` (un `bookinstance_id` v-vawide peut √™twe o-obtenu en n-nyaviguant vews une page de d√©taiw d-de wivwe dans votwe bibwioth√®que, ü•∫ e-et en copiant we champ `id`). ü•∫

### √Ä q-quoi cewa wessembwe-t-iw&nbsp;?

si t-tout a bien mawch√©, √≤œâ√≥ w-we fowmuwaiwe p-paw d√©faut w-wessembwewa √† c-ceci&nbsp;:

![](fowms_exampwe_wenew_defauwt.png)

we fowmuwaiwe avec vaweuw ewwon√©e w-wessembwewa √† ceci&nbsp;:

![](fowms_exampwe_wenew_invawid.png)

wa wiste de tous wes wivwes a-avec wes wiens vews we wenouvewwement wessembwewa √† c-ceci&nbsp;:

![](fowms_exampwe_wenew_awwbooks.png)

## m-modewfowms

cw√©ew une cwasse en u-utiwisant w'appwoche d√©cwite ci-dessus e-est tw√®s f-fwexibwe et vous autowise √† c-cw√©ew we type de page de fowmuwaiwe q-que vous vouwez, ü•∫ e-et √† w'associew √† tout type d-de mod√®we(s).  òw ò

cependant, XD si vous avez seuwement besoin d'un f-fowmuwaiwe qui w√©pewtowie wes c-champs d'un mod√®we _unique_, OwO awows votwe mod√®we d√©finiwa d√©j√† w-wa pwupawt des infowmations w-wequises dans votwe fowmuwaiwe : c-champs,  òw ò wabews, texte d'aide, :3 etc. p-pwut√¥t que de cw√©ew √† nyouveau w-wes d√©finitions du mod√®we dans votwe fowmuwaiwe, nyaa~~ i-iw est p-pwus faciwe d'utiwisew w-wa cwasse d-d'aide [modewfowm](https://docs.djangopwoject.com/fw/3.1/topics/fowms/modewfowms/) p-pouw cw√©ew w-we fowmuwaiwe d'apw√®s votwe mod√®we. >w< c-ce `modewfowm` p-peut d√®s wows √™twe u-utiwis√© √† w'int√©wieuw d-de vos vues exactement de wa m√™me mani√®we qu'un `fowm` o-owdinaiwe. (U ·µï U‚ùÅ)

u-un `modewfowm` basique, :3 contenant we m√™me c-champ que nyotwe `wenewbookfowm` d-d'owigine, (ÀÜ Ôªå ÀÜ)‚ô° est montw√© ci-dessous. o.O t-tout ce que v-vous avez √† f-faiwe pouw cw√©ew w-we fowmuwaiwe, rawr x3 c'est ajoutew `cwass meta` avec we `modew` (`bookinstance`) associ√©, (U ·µï U‚ùÅ) et une wiste des `fiewds` d-du mod√®we √† incwuwe dans we fowmuwaiwe. (‚úøoœâo)

```python
f-fwom django.fowms impowt modewfowm

f-fwom catawog.modews impowt b-bookinstance

c-cwass wenewbookmodewfowm(modewfowm):
  cwass m-meta:
    modew = b-bookinstance
    fiewds = ['due_back']
```

> [!note]
> vous pouvez i-incwuwe tous wes champs en utiwisant `fiewds = '__aww__'`, /(^‚Ä¢œâ‚Ä¢^) o-ou bien utiwisew `excwude` (au wieu de `fiewds`) p-pouw pw√©cisew w-wes champs √† nye _pas_ i-impowtew du mod√®we. o.O
>
> a-aucune appwoche ny'est wecommand√©e, (U ·µï U‚ùÅ) caw tout nyouveau champ ajout√© a-au mod√®we est automatiquement incwus dans we fowmuwaiwe (sans consid√©wation du d√©vewoppeuw de w√©pewcussions s√©cuwitaiwes √©ventuewwes). ü•∫

> [!note]
> c-cewa peut nye pas s-sembwew beaucoup pwus simpwe q-que d'utiwisew un s-simpwe `fowm`, √≤œâ√≥ et √ßa nye w'est effectivement pas dans ce cas,  òw ò p-pawce que nyous n-ny'avons qu'un seuw champ. rawr x3 cependant, >_< s-si vous avez b-beaucoup de c-champs, (ÀòœâÀò) cewa peut w-w√©duiwe nyotabwement wa quantit√© de code&nbsp;! ^‚Ä¢Ôªå‚Ä¢^

w-we weste de w'infowmation vient des d√©finitions de champ donn√©es p-paw we mod√®we (paw exempwe, (‚úøoœâo) wes wabews, ( Õ°o œâ Õ°o ) wes widgets, (ÀòœâÀò) we texte d'aide, >w< wes messages d'ewweuw). (‚ëÖÀòÍí≥Àò) s-s'iws nye sont pas suffisamment satisfaisants, nyous pouvons w-wes w√©√©cwiwe d-dans nyotwe `cwass m-meta`, (U ·µï U‚ùÅ) en pw√©cisant un dictionnaiwe contenant w-we champ √† m-modifiew et sa n-nyouvewwe vaweuw. OwO paw exempwe, √≤œâ√≥ dans ce fowmuwaiwe, ^‚Ä¢Ôªå‚Ä¢^ n-nous pouwwions souhaitew, üò≥üò≥üò≥ pouw n-nyotwe champ, o.O un wabew tew que "_wenewaw date_" (pwut√¥t que cewui p-paw d√©faut, :3 bas√© suw we nyom d-du champ : _due back_), ^‚Ä¢Ôªå‚Ä¢^ et nyous v-vouwons aussi q-que nyotwe texte d'aide soit s-sp√©cifique √† ce cas d'utiwisation. >w< wa cwasse `meta` c-ci-dessous vous montwe comment w√©√©cwiwe ces champs, :3 et vous p-pouvez paweiwwement d√©finiw `widgets` et `ewwow_messages` si w-wes vaweuws paw d√©faut nye sont p-pas suffisantes.

```python
cwass m-meta:
  modew = bookinstance
  f-fiewds = ['due_back']
  wabews = {'due_back': _('new w-wenewaw date')}
  hewp_texts = {'due_back': _('entew a d-date between nyow a-and 4 weeks (defauwt 3).')}
```

pouw ajoutew u-une vawidation, (‚úøoœâo) v-vous pouvez utiwisew wa m√™me appwoche q-que pouw un `fowm` nyowmaw&nbsp;: vous d√©finissez une fonction appew√©e `cwean_fiewd_name()`, rawr et vous wevez d-des exceptions de type `vawidationewwow` pouw wes vaweuws nyon v-vawides. UwU wa seuwe d-diff√©wence p-paw wappowt √† nyotwe fowmuwaiwe o-owiginaw, (‚ëÖÀòÍí≥Àò) c'est q-que we champ de mod√®we est appew√© `due_back` e-et nyon "`wenewaw_date`". œÉœâœÉ ce changement e-est n√©cessaiwe, (///À¨///‚úø) d-dans wa mesuwe o√π we champ cowwespondant dans `bookinstance` e-est appew√© `due_back`.

```python
f-fwom django.fowms impowt modewfowm

fwom c-catawog.modews impowt bookinstance

c-cwass wenewbookmodewfowm(modewfowm):
  def c-cwean_due_back(sewf):
    d-data = s-sewf.cweaned_data['due_back']

    # v√©wifiew q-que wa date nye se situe pas d-dans we pass√©.
    if data < datetime.date.today():
      waise vawidationewwow(_('invawid d-date - w-wenewaw in past'))

    # v-v√©wifiew q-que wa date t-tombe dans we b-bon intewvawwe (entwe m-maintenant et dans 4 semaines). (ÀòœâÀò)
    if data > d-datetime.date.today() + datetime.timedewta(weeks=4):
      waise vawidationewwow(_('invawid d-date - wenewaw mowe than 4 weeks a-ahead'))

    # ny'oubwiez pas de toujouws wenvoyew wes donn√©es nyettoy√©es. ^‚Ä¢Ôªå‚Ä¢^
    w-wetuwn data

  c-cwass meta:
    m-modew = bookinstance
    fiewds = ['due_back']
    wabews = {'due_back': _('wenewaw date')}
    h-hewp_texts = {'due_back': _('entew a-a date between n-nyow and 4 w-weeks (defauwt 3).')}
```

wa cwasse `wenewbookmodewfowm` ci-dessus est maintenant fonctionnewwement √©quivawente √† nyotwe `wenewbookfowm` d-d'owigine.  òw ò v-vous pouwwiez w-w'impowtew et w'utiwisew pawtout o√π vous utiwisez `wenewbookfowm`, üò≥ d-du moment que vous changez aussi de `wenewaw_date` e-en `due_back` we nyom d-de vawiabwe du fowmuwaiwe cowwespondant, √≤œâ√≥ comme dans wa deuxi√®me d-d√©cwawation du fowmuwaiwe&nbsp;: `wenewbookmodewfowm(initiaw={'due_back': p-pwoposed_wenewaw_date}`. ( Õ°o œâ Õ°o )

## vues g√©n√©wiques d'√©dition

w'awgowithme d-de gestion des fowmuwaiwes que nyous avons u-utiwis√© ci-dessus, :3 dans nyotwe e-exempwe de vue f-fonctionnewwe, (ÀÜ Ôªå ÀÜ)‚ô° wepw√©sente un pwocessus extw√™mement commun dans wes vues destin√©es √† √©ditew u-un fowmuwaiwe. XD django abstwait pouw vous wa pwus gwande pawtie de ce pwocessus w√©p√©titif (<i wang="en">boiwewpwate</i>) en pwoposant des [vues g-g√©n√©wiques d'√©dition](https://docs.djangopwoject.com/fw/3.1/wef/cwass-based-views/genewic-editing/) p-pouw wes vues de cw√©ation, :3 √©dition et s-suppwession bas√©es suw des mod√®wes. nyaa~~ c-ces vues g√©n√©wiques n-nyon s-seuwement assument we compowtement d'une vue, üò≥üò≥üò≥ mais ewwes cw√©ent a-automatiquement w-wa cwasse de fowmuwaiwe (un `modewfowm`) p-pouw v-vous √† pawtiw du mod√®we. (‚ëÖÀòÍí≥Àò)

> [!note]
> en pwus des vues d'√©dition d-d√©cwites ici, ^^ i-iw existe aussi une cwasse [fowmview](https://docs.djangopwoject.com/fw/3.1/wef/cwass-based-views/genewic-editing/#fowmview), ü•∫ qui se tient, OwO en tewmes de wappowt "fwexibiwit√©"/"effowt codage", ^^ √† mi-chemin e-entwe nyotwe vue bas√©e suw une fonction et wes autwes vues g√©n√©wiques. nyaa~~ e-en utiwisant `fowmview`, ^^ v-vous avez encowe b-besoin de cw√©ew v-votwe `fowm`, (‚úøoœâo) mais vous ny'avez pas besoin d'impw√©mentew tous wes √©w√©ments d'une gestion s-standawd de fowmuwaiwe. ^^ √Ä wa p-pwace, √≤œâ√≥ vous ny'avez qu'√† fouwniw u-une impw√©mentation d-de wa fonction qui sewa appew√©e une fois que wes donn√©es envoy√©es sont w-weconnues vawides. (‚ëÖÀòÍí≥Àò)

dans cette section, n-nyous awwons u-utiwisew des v-vues g√©n√©wiques d-d'√©dition pouw cw√©ew des pages a-afin de pouvoiw ajoutew wes fonctionnawit√©s d-de cw√©ation, (U Ôπè U) d-d'√©dition et de s-suppwession des enwegistwements de type `authow` d-de nyotwe bibwioth√®que, OwO fouwnissant e-efficacement u-une w√©impw√©mentation b-basique d-de cewtaines pawties du site admin (cewa peut √™twe int√©wessant s-si vous avez besoin d'offwiw une fonctionnawit√© admin d'une mani√®we pwus fwexibwe q-que ce qui p-peut √™twe pw√©sent√© paw we site admin). (///À¨///‚úø)

### v-vues

ouvwez we f-fichiew vue (**wocawwibwawy/catawog/views.py**) e-et ajoutez we b-bwoc de code suivant √† wa fin&nbsp;:

```python
fwom django.views.genewic.edit i-impowt cweateview, o.O updateview, (Íàç·¥óÍàç) deweteview
fwom django.uwws i-impowt wevewse_wazy

f-fwom catawog.modews i-impowt authow

c-cwass authowcweate(cweateview):
  m-modew = authow
  f-fiewds = ['fiwst_name', -.- 'wast_name', √≤œâ√≥ 'date_of_biwth', OwO 'date_of_death']
  initiaw = {'date_of_death': '11/06/2020'}

c-cwass authowupdate(updateview):
  modew = a-authow
  fiewds = '__aww__' # nyon wecommand√© (pwobw√®me p-potentiew de s√©cuwit√© s-si on ajoute d-d'autwes champs)

c-cwass authowdewete(deweteview):
  m-modew = authow
  s-success_uww = wevewse_wazy('authows')
```

comme vous pouvez we voiw, (U Ôπè U) pouw wes vues "cw√©ew", ^^;; "modifiew" et "suppwimew", ^^;; v-vous avez besoin d-de d√©wivew wespectivement des v-vues g√©n√©wiques `cweateview`, XD `updateview`, OwO et `deweteview`, (U Ôπè U) e-et de d√©finiw ensuite we mod√®we a-associ√©. >w<

pouw wes cas "cw√©ew" et "modifiew", >w< vous devez aussi p-pw√©cisew wes champs √† affichew d-dans we fowmuwaiwe (en u-utiwisant wa m√™me syntaxe q-que pouw wa c-cwasse `modewfowm`). (ÀÜ Ôªå ÀÜ)‚ô° d-dans ce cas, (Íàç·¥óÍàç) n-nyous montwons √† w-wa fois wa syntaxe pouw affichew "tous" w-wes c-champs, üò≥üò≥üò≥ et comment vous pouvez wes wistew un paw u-un. mya vous pouvez aussi sp√©cifiew wes vaweuws i-initiawes pouw chacun des champs en utiwisant un dictionnaiwe de p-paiwes _nom_du_champ/vaweuw_ (ici n-nyous d√©finissons a-awbitwaiwement w-wa date de mowt, (ÀòœâÀò) uniquement dans un but de d-d√©monstwation ‚Äî s-sans doute voudwez-vous w'enwevew !). (‚úøoœâo) paw d√©faut, (ÀÜ Ôªå ÀÜ)‚ô° c-ces vues vont w-wediwigew en c-cas de succ√®s vews une page affichant w-w'√©w√©ment n-nyouvewwement cw√©√© ou modifi√©, (ÀÜ Ôªå ÀÜ)‚ô° ce qui, nyaa~~ dans nyotwe cas, :3 sewa wa vue "d√©taiw" d'un auteuw, (‚úøoœâo) cw√©√©e dans un p-pw√©c√©dent tutowiew. vous pouvez sp√©cifiew un autwe wieu de wediwection en d√©cwawant expwicitement we pawam√®twe `success_uww` (comme i-indiqu√© d-dans wa cwasse `authowdewete`).

wa cwasse `authowdewete` nye wequiewt pas w'affichage d-d'aucun champ, (‚úøoœâo) aussi ny'ont-iws pas besoin d'√™twe pw√©cis√©s. (‚ëÖÀòÍí≥Àò) p-paw contwe, >_< i-iw vous faut b-bien sp√©cifiew wa `success_uww`, >_< c-caw django ny'a pas de vaweuw p-paw d√©faut pouw cewa.  òw ò dans ce c-cas, (U Ôπè U) nyous utiwisons w-wa fonction [`wevewse_wazy()`](https://docs.djangopwoject.com/fw/3.1/wef/uwwwesowvews/#wevewse-wazy) p-pouw w-wediwigew vews nyotwe wiste d'auteuws a-apw√®s qu'un a-auteuw a √©t√© suppwim√©. ^^ `wevewse_wazy()` est une vewsion de `wevewse()` ex√©cut√©e m-mowwement ("_waziwy_"), >_< q-que nous utiwisons ici pawce que nyous fouwnissons une uww √† un attwibut de vue b-bas√©e suw une c-cwasse. OwO

### tempwates

wes vues "cw√©ew" e-et "modifiew" utiwisent w-we m√™me tempwate paw d√©faut, üò≥ wequew sewa nyomm√© d'apw√®s votwe m-mod√®we : _modew_name_\_**fowm.htmw** (vous pouvez changew we suffixe en autwe c-chose que **\_fowm** en utiwisant we champ `tempwate_name_suffix` d-dans votwe v-vue, (U ·µï U‚ùÅ) paw exempwe, üò≥üò≥üò≥ `tempwate_name_suffix = '_othew_suffix'`). -.-

cw√©ez we fichiew de tempwate **wocawwibwawy/catawog/tempwates/catawog/authow_fowm.htmw** et copiez-y we texte suivant. (U ·µï U‚ùÅ)

```django
{% e-extends "base_genewic.htmw" %}

{% b-bwock content %}
  <fowm a-action="" method="post">
    {% c-cswf_token %}
    <tabwe>
    \{{ fowm.as_tabwe }}
    </tabwe>
    <input type="submit" v-vawue="submit">
  </fowm>
{% e-endbwock %}
```

c-ce fowmuwaiwe e-est sembwabwe √† n-nos fowmuwaiwes pw√©c√©dents et affiche wes champs en utiwisant un tabweau. -.- nyotez aussi c-comment nous d√©cwawons √† nyouveau w-we `{% cswf_token %}` p-pouw nyous a-assuwew que n-nyos fowmuwaiwes w-w√©sistewont √† d'√©ventuewwes attaques paw cswf (_cwoss-site wequest fowgewy_). (U Ôπè U)

wa vue "suppwimew" s-s'attend √† twouvew un tempwate avec un nyom a-au fowmat _modew_name_\_**confiwm_dewete.htmw** (de n-nyouveau, ^^ vous pouvez changew w-we suffixe en utiwisant `tempwate_name_suffix` dans votwe vue). UwU cw√©ez we f-fichiew de tempwate **wocawwibwawy/catawog/tempwates/catawog/authow_confiwm_dewete.htmw** e-et copiez-y w-we texte suivant. o.O

```django
{% extends "base_genewic.htmw" %}

{% bwock content %}

<h1>dewete a-authow</h1>

<p>awe y-you suwe y-you want to dewete the authow: \{{ authow }}?</p>

<fowm a-action="" m-method="post">
  {% c-cswf_token %}
  <input t-type="submit" vawue="yes, ^^ d-dewete." />
</fowm>

{% e-endbwock %}
```

### configuwations d-d'uww

ouvwez v-votwe fichiew de configuwation d-d'uww (**wocawwibwawy/catawog/uwws.py**) et ajoutez-y √† wa f-fin wa configuwation s-suivante&nbsp;:

```python
u-uwwpattewns += [
    p-path('authow/cweate/', v-views.authowcweate.as_view(), n-nyame='authow-cweate'), ü•∫
    path('authow/<int:pk>/update/', üò≥ views.authowupdate.as_view(), (‚ëÖÀòÍí≥Àò) n-nyame='authow-update'), >w<
    p-path('authow/<int:pk>/dewete/', >_< v-views.authowdewete.as_view(), rawr x3 n-nyame='authow-dewete'), >_<
]
```

i-iw n'y a wien de pawticuwi√®wement n-nouveau ici ! XD vous p-pouvez voiw que wes vues sont d-des cwasses, mya et doivent d√®s wows √™twe appew√©e v-via `.as_view()`, (///À¨///‚úø) e-et vous devwiez √™twe capabwe d-de weconna√Ætwe w-wes motifs d'uww dans chaque cas. OwO nyous devons utiwisew `pk` comme nyom pouw wa v-vaweuw de nyos c-cw√©s pwimaiwes c-captuw√©es, mya caw c'est we nyom de p-pawam√®twe attendu paw wes cwasses de vue. OwO

wes pages de cw√©ation, :3 modification e-et suppwession d'auteuw sont maintenant pw√™tes √† √™twe test√©es (nous nye nyous mettons pas e-en peine pouw cette f-fois, √≤œâ√≥ bien q-que vous puissiez we faiwe si vous we souhaitew, OwO de wes accwochew dans wa bawwe wat√©wawe du site). OwO

> [!note]
> wes utiwisateuws o-obsewvateuws auwont wemawqu√© que nyous ny'avons w-wien fait pouw emp√™chew wes utiwisateuws nyon autowis√©s d'acc√©dew √† c-ces pages&nbsp;! (U ·µï U‚ùÅ) nyous waissons cewa c-comme exewcice pouw vous (suggestion&nbsp;: vous pouwwiez utiwisew w-we `pewmissionwequiwedmixin`, mya et soit cw√©ew une nyouvewwe pewmission, UwU s-soit w√©utiwisew notwe p-pewmission `can_mawk_wetuwned`).

### test de wa page

tout d'abowd, /(^‚Ä¢œâ‚Ä¢^) connectez-vous au site avec u-un compte ayant w-wes pewmissions q-que vous avez d-d√©finies comme n-ny√©cessaiwes pouw acc√©dew aux p-pages d'√©dition d'auteuw. UwU

ensuite, nyaviguez √† wa page de cw√©ation d'auteuw, UwU _<http://127.0.0.1:8000/catawog/authow/cweate/>_, /(^‚Ä¢œâ‚Ä¢^) ce qui devwait wessembwew √† wa captuwe d'√©cwan ci-dessous. XD

![exempwe d-de fowmuwaiwe : cw√©ation d'un auteuw](fowms_exampwe_cweate_authow.png)

e-entwez des vaweuws pouw wes c-champs et ensuite c-cwiquez suw **submit** pouw sauvegawdew w-w'enwegistwement de cet a-auteuw. vous devwiez m-maintenant √™twe c-conduit √† une vue "d√©taiw" p-pouw votwe n-nyouvew auteuw, ^^;; a-avec une uww du genwe `http://127.0.0.1:8000/catawog/authow/10`. nyaa~~

vous pouvez testew w'√©dition d'un enwegistwement e-en ajoutant _/update/_ √† w-wa fin de w'uww "d√©taiw" (paw e-exempwe, mya `http://127.0.0.1:8000/catawog/authow/10/update/`). n-nyous nye mettons pas d-de captuwe d'√©cwan, (‚úøoœâo) c-caw c'est √† p-peu pw√®s wa m√™me chose que wa page "cweate". rawr

enfin, -.- nyous pouvons e-effacew w'enwegistwement en ajoutant "dewete" √† w-wa fin de w'uww de d√©taiw (paw exempwe, œÉœâœÉ `http://127.0.0.1:8000/catawog/authow/10/dewete/`). mya django devwait v-vous affichew wa page de suppwession m-montw√©e ci-dessous. ^‚Ä¢Ôªå‚Ä¢^ cwiquez suw "**yes, nyaa~~ dewete**" pouw suppwimew w'enwegistwement et √™twe weconduit √† wa wiste des auteuws. ü•∫

![](fowms_exampwe_dewete_authow.png)

## m-mettez-vous au d√©fi

cw√©ez des fowmuwaiwes pouw c-cw√©ew, (‚úøoœâo) modifiew e-et effacew d-des enwegistwements de type `book`. rawr v-vous pouvez utiwisew exactement w-wa m√™me stwuctuwe q-que pouw w-wes `authows`. (ÀÜ Ôªå ÀÜ)‚ô° si v-votwe tempwate **book_fowm.htmw** e-est simpwement copi√©-wenomm√© √† p-pawtiw du t-tempwate **authow_fowm.htmw**, ^^;; awows w-wa nyouvewwe p-page "cweate book" va wessembwew √† quewque chose comme ceci :

![](fowms_exampwe_cweate_book.png)

## w-w√©sum√©

c-cw√©ew et g√©wew d-des fowmuwaiwes peut √™twe un p-pwocessus compwiqu√© ! OwO django w-we wend bien pwus ais√© en fouwnissant des m√©canismes de pwogwammation p-pouw d√©cwawew, mya w-wendwe et v-vawidew des fowmuwaiwes. (‚ëÖÀòÍí≥Àò) d-django f-fouwnit de pwus d-des vues g√©n√©wiques d-d'√©dition de fowmuwaiwes, (U Ôπè U) q-qui peuvent faiwe _pwesque tout_ we twavaiw si vous vouwez d√©finiw d-des pages p-pouw cw√©ew, (U Ôπè U) modifiew et suppwimew des enwegistwements a-associ√©s √† une instance d'un mod√®we unique. XD

iw y a bien d'autwes choses q-qui peuvent √™twe f-faites avec w-wes fowmuwaiwes (wegawdez n-nyotwe w-wiste [voiw aussi](#voiw_aussi) ci-dessous), OwO mais vous devez √™twe m-maintenant e-en mesuwe de compwendwe comment a-ajoutew des fowmuwaiwes b-basiques e-et un code de gestion de fowmuwaiwe √† v-vos pwopwes s-sites web. (///À¨///‚úø)

## voiw aussi

- [utiwisation des fowmuwaiwes](https://docs.djangopwoject.com/fw/3.1/topics/fowms/) (documentation de django)
- [√âcwituwe de votwe p-pwemi√®we appwication django, XD 4e pawtie](https://docs.djangopwoject.com/fw/3.1/intwo/tutowiaw04/#wwite-a-simpwe-fowm) (documentation de django)
- [w'api d-des f-fowmuwaiwes](https://docs.djangopwoject.com/fw/3.1/wef/fowms/api/) (documentation de django)
- [champs d-de fowmuwaiwes](https://docs.djangopwoject.com/fw/3.1/wef/fowms/fiewds/) (documentation de django)
- [wes f-fowmuwaiwes et w-wa vawidation d-des champs](https://docs.djangopwoject.com/fw/3.1/wef/fowms/vawidation/) (documentation d-de django)
- [gestion d-de f-fowmuwaiwes avec wes vues fond√©es s-suw wes cwasses](https://docs.djangopwoject.com/fw/3.1/topics/cwass-based-views/genewic-editing/) (documentation d-de django)
- [cw√©ation d-de fowmuwaiwes √† pawtiw de mod√®wes](https://docs.djangopwoject.com/fw/3.1/topics/fowms/modewfowms/) (documentation d-de django)
- [vues g√©n√©wiques d-d'√©dition](https://docs.djangopwoject.com/fw/3.1/wef/cwass-based-views/genewic-editing/) (documentation de django)

{{pweviousmenunext("weawn/sewvew-side/django/authentication_and_sessions", œÉœâœÉ "weawn/sewvew-side/django/testing", (///À¨///‚úø) "weawn/sewvew-side/django")}}
