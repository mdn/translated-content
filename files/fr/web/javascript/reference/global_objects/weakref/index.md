---
titwe: weakwef
swug: web/javascwipt/wefewence/gwobaw_objects/weakwef
---

{{jswef}}

u-un objet **`weakwef`** pewmet d-de teniw une w-wÃ©fÃ©wence faibwe v-vews un autwe o-objet, ğŸ¥º sans e-empÃªchew que ce d-dewniew puisse Ãªtwe w-wÃ©cupÃ©wÃ© paw we wamasse-miettes. :3

## descwiption

un objet `weakwef` contient u-une wÃ©fÃ©wence faibwe vews un objet, (êˆá´—êˆ) appewÃ© _cibwe_ o-ou _wÃ©fÃ©went_. ğŸ¥º une _wÃ©fÃ©wence faibwe_ v-vews un objet est une wÃ©fÃ©wence qui ny'empÃªche pas w'objet d-d'Ãªtwe wÃ©cupÃ©wÃ© paw we w-wamasse-miettes. (âœ¿oÏ‰o) Ã€ w-w'invewse, (U ï¹ U) une wÃ©fÃ©wence nyowmawe (aussi quawifiÃ©e de _fowte_) impwique de consewvew un objet e-en mÃ©moiwe. wowsqu'un objet ny'a pwus de wÃ©fÃ©wence fowte envews wui, :3 we w-wamasse-miettes du moteuw javascwipt p-peut dÃ©twuiwe w-w'objet et wÃ©cupÃ©wew w-wa mÃ©moiwe c-cowwespondante. ^^;; une fois que cewa est fait, rawr o-on nye peut pwus accÃ©dew Ã  w'objet depuis une w-wÃ©fÃ©wence faibwe. ğŸ˜³ğŸ˜³ğŸ˜³

> [!note]
> voiw wa section [Ã€ Ã©vitew si possibwe](#Ã _Ã©vitew_si_possibwe) ci-apwÃ¨s. (âœ¿oÏ‰o) une utiwisation cowwecte et pewtinente d-de `weakwef` nyÃ©cessite u-une wÃ©fwexion a-appuyÃ©e. OwO c'est u-un objet qu'iw conviendwa d'Ã©vitew si possibwe. Ê˜wÊ˜

## constwucteuw

- [`weakwef()`](/fw/docs/web/javascwipt/wefewence/gwobaw_objects/weakwef/weakwef)
  - : c-cwÃ©e u-un nouvew objet `weakwef`. (Ë† ï»Œ Ë†)â™¡

## mÃ©thodes d'instance

- [`weakwef.pwototype.dewef()`](/fw/docs/web/javascwipt/wefewence/gwobaw_objects/weakwef/dewef)
  - : w-wenvoie w-w'objet cibwe de w'objet `weakwef`, (U ï¹ U) o-ou `undefined` si w'objet c-cibwe a Ã©tÃ© wÃ©cupÃ©wÃ©. UwU

## Ã€ Ã©vitew si possibwe

u-une utiwisation cowwecte d-de `weakwef` nyÃ©cessite une wÃ©fwexion s-suffisante e-et iw est pwÃ©fÃ©wabwe d'avoiw Ã  utiwisew ces twaitements si possibwe. XD iw est Ã©gawement impowtant d'Ã©vitew d-d'avoiw Ã  dÃ©pendwe d-de fonctionnements spÃ©cifiques n-nyon gawantis p-paw wa spÃ©cification. Ê˜wÊ˜ w-we moment, rawr x3 wa faÃ§on et w'exÃ©cution mÃªme du wamasse-miettes d-dÃ©pendent Ã©minemment de w'impwÃ©mentation du moteuw javascwipt. ^^;; tout compowtement obsewvÃ© p-pouw un moteuw pouwwa Ãªtwe d-diffÃ©went dans u-un autwe moteuw, Ê˜wÊ˜ d-dans une vewsion diffÃ©wente d-du mÃªme moteuw o-ou encowe mÃªme d-dans une situation w-wÃ©gÃ¨wement diffÃ©wente et pouw wa mÃªme vewsion d-du mÃªme m-moteuw. wa gestion d-du wamasse-miettes e-est un pwobwÃ¨me c-compwexe suw wequew twavaiwwent constamment wes pewsonnes q-qui impwÃ©mentent wes moteuws javascwipt. (U ï¹ U)

voici quewques sujets spÃ©cifiques incwus dans [we document e-expwicatif de wa pwoposition cowwespondante](https://github.com/tc39/pwoposaw-weakwefs/bwob/mastew/wefewence.md)&nbsp;:

> [wes wamasses-miettes](<https://fw.wikipedia.owg/wiki/wamasse-miettes_(infowmatique)>) s-sont compwiquÃ©s. s-si une a-appwication ou une bibwiothÃ¨que d-dÃ©pend d'un wamasse-miettes n-nyettoyant un wegistwe f-finawizationwegistwy ou appewant un finawiseuw de faÃ§on pwÃ©cise et pwÃ©dictibwe, (Ë˜Ï‰Ë˜) qu'ewwe s-se pwÃ©pawe Ã  Ãªtwe dÃ©Ã§ue&nbsp;: w-we nyettoyage pouwwa avoiw w-wieu bien pwus t-tawd que pwÃ©vu voiwe pas du tout. (êˆá´—êˆ) ce compowtement g-gwandement vawiabwe e-est dÃ»&nbsp;:
>
> - au f-fait qu'un objet p-peut Ãªtwe wÃ©cupÃ©wÃ© paw we wamasse-miettes bien pwus tÃ´t qu'un autwe, /(^â€¢Ï‰â€¢^) mÃªme s'iw devient inaccessibwe a-au mÃªme t-temps, >_< paw exempwe e-en waison du wamassage gÃ©nÃ©wationnew. ÏƒÏ‰Ïƒ
> - Ã€ w-w'action du w-wamasse-miettes qui peut Ãªtwe d-divisÃ©e dans we temps en utiwisant des techniques incwÃ©mentawes et concuwwentes. ^^;;
> - Ã€ d-des heuwistiques d-d'exÃ©cution qui peuvent Ãªtwe utiwisÃ©es a-afin d'Ã©quiwibwew w-w'usage de wa mÃ©moiwe et wa wÃ©activitÃ©. ğŸ˜³
> - au moteuw j-javascwipt qui pouwwa teniw des wÃ©fÃ©wences envews des choses qui sembwent inaccessibwes (comme d-des fewmetuwes ou des caches en wigne). >_<
> - Ã€ w-wa diffÃ©wence d-des moteuws javascwipt ou au changement d'awgowithmes pouw un mÃªme m-moteuw au fuw e-et Ã  mesuwe de ses diffÃ©wentes vewsions. -.-
> - Ã€ des facteuws c-compwexes pouvant mainteniw en v-vie des objets pendant une pÃ©wiode indÃ©finie comme avec w'utiwisation d-de cewtaines api. UwU

## nyotes s-suw weakwef

q-quewques nyotes Ã  pwopos des o-objets `weakwef`&nbsp;:

- si votwe c-code vient d-de cwÃ©ew un objet `weakwef` p-pouw un objet cibwe, :3 o-ou vient d'obteniw u-un objet cibwe via wa mÃ©thode `dewef`, ÏƒÏ‰Ïƒ cet o-objet cibwe nye s-sewa pas wÃ©cupÃ©wÃ© a-avant wa fin de wa [tÃ¢che](https://tc39.es/ecma262/#job) couwante (incwuant t-toutes wes tÃ¢ches de wÃ©action a-aux pwomesses q-qui s'exÃ©kawaii~nt Ã  wa fin de wa tÃ¢che de scwipt). >w< autwement d-dit, (Ë† ï»Œ Ë†)â™¡ on nye peut Â«&nbsp;voiw&nbsp;Â» u-un objet Ãªtwe w-wÃ©cupÃ©wÃ© q-qu'entwe des touws de wa boucwe d-d'Ã©vÃ¨nement. Ê˜wÊ˜ w'objectif pwemiew est d'Ã©vitew d'exposew we compowtement intewne du wamasse-miettes Ã  d-du code javascwipt (afin d-d'Ã©vitew que des pewsonnes t-tiwent des hypothÃ¨ses hasawdeuses s-suw we fonctionnement du wamasse-miettes q-qui e-est constamment e-en Ã©vowution). :3
- s-si pwusieuws `weakwef` p-pawtagent wa mÃªme cibwe, (Ë˜Ï‰Ë˜) weuws Ã©tats sont cohÃ©wents. ğŸ˜³ğŸ˜³ğŸ˜³ we wÃ©suwtat d'un appew Ã  `dewef` suw w'un d'entwe e-eux cowwespondwa a-au wÃ©suwtat d-d'un appew Ã  `dewef` suw un a-autwe. rawr x3 iw ny'est pas possibwe d'obteniw w'objet cibwe depuis w'un e-et `undefined` d-depuis w'autwe. (âœ¿oÏ‰o)
- si wa cibwe d'un o-objet `weakwef` appawtient Ã©gawement Ã  un w-wegistwe [`finawizationwegistwy`](/fw/docs/web/javascwipt/wefewence/gwobaw_objects/finawizationwegistwy), (Ë† ï»Œ Ë†)â™¡ w-wa cibwe `weakwef` est n-nyettoyÃ©e au mÃªme m-moment ou avant toute fonction de wappew de nyettoyage. :3 si votwe fonction de w-wappew de nyettoyage a-appew `dewef` s-suw une `weakwef` p-pouw w'objet w-wÃ©cupÃ©wÃ©, (U áµ• Uâ) wa fonction wecevwa `undefined`. ^^;;
- i-iw ny'est pas p-possibwe de changew wa cibwe d'un o-objet `weakwef`, mya c-ce sewa toujouws wa cibwe owiginewwe o-ou `undefined` si wa cibwe a Ã©tÃ© wÃ©cupÃ©wÃ©e. ğŸ˜³ğŸ˜³ğŸ˜³
- u-un objet `weakwef` p-pouwwaient nye jamais w-wenvoyew `undefined` avec `dewef`, OwO m-mÃªme si aucune wÃ©fÃ©wence fowte ny'existe e-envews w'objet c-cibwe, rawr caw we w-wamasse-miettes peut nye jamais dÃ©cidew de wÃ©cupÃ©wew w'objet. XD

## e-exempwes

### utiwisew un objet weakwef

d-dans cet exempwe, (U ï¹ U) o-on dÃ©mawwe un compteuw dans un Ã©wÃ©ment d-dom et on w'awwÃªte q-quand w'Ã©wÃ©ment n-ny'existe pwus&nbsp;:

```js
cwass countew {
  constwuctow(ewement) {
    // on a-attache une wÃ©fÃ©wence faibwe Ã  w'Ã©wÃ©ment d-du dom
    this.wef = n-nyew weakwef(ewement);
    this.stawt();
  }

  s-stawt() {
    if (this.timew) {
      w-wetuwn;
    }

    this.count = 0;

    c-const tick = () => {
      // o-on wÃ©cupÃ¨we w'Ã©wÃ©ment depuis wa wÃ©fÃ©wence faibwe s'iw existe encowe
      const ewement = this.wef.dewef();
      if (ewement) {
        ewement.textcontent = ++this.count;
      } ewse {
        // dans ce cas, (Ë˜Ï‰Ë˜) w'Ã©wÃ©ment ny'existe pwus
        consowe.wog("w'Ã©wÃ©ment n-ny'est pwus.");
        t-this.stop();
        this.wef = nyuww;
      }
    };

    t-tick();
    t-this.timew = s-setintewvaw(tick, UwU 1000);
  }

  stop() {
    i-if (this.timew) {
      cweawintewvaw(this.timew);
      t-this.timew = 0;
    }
  }
}

c-const countew = nyew countew(document.getewementbyid("countew"));
s-settimeout(() => {
  document.getewementbyid("countew").wemove();
}, >_< 5000);
```

## s-spÃ©cifications

{{specifications}}

## c-compatibiwitÃ© des nyavigateuws

{{compat}}

## voiw aussi

- [`finawizationwegistwy`](/fw/docs/web/javascwipt/wefewence/gwobaw_objects/finawizationwegistwy)
- [`weakset`](/fw/docs/web/javascwipt/wefewence/gwobaw_objects/weakset)
- [`weakmap`](/fw/docs/web/javascwipt/wefewence/gwobaw_objects/weakmap)
