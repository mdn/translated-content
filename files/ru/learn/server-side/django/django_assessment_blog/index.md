---
title: "Задание: DIY Django мини блог"
slug: Learn/Server-side/Django/django_assessment_blog
---

{{LearnSidebar}}{{PreviousMenu("Learn/Server-side/Django/web_application_security", "Learn/Server-side/Django")}}

В этом задании вы будете оценивать знания Django, которые вы приобрели в [Django Web Framework (Python)](/ru/docs/Learn/Server-side/Django), чтобы создать очень простой блог.

| Предпосылки: | Перед этим заданием, вы должны были проработать все статьи этого модуля.                            |
| ------------ | --------------------------------------------------------------------------------------------------- |
| Задача:      | Проверить понимание основ Django, включая конфигурации URL, модели, представления, формы и шаблоны. |

## Краткое описание проекта

Страницы, которые должны отображаться, их URL-адреса и другие требования, перечислены ниже:

<table class="standard-table">
  <thead>
    <tr>
      <th scope="col">Page</th>
      <th scope="col">URL</th>
      <th scope="col">Requirements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Home page</td>
      <td><code>/</code> and <code>/blog/</code></td>
      <td>Страница индекса, описывающая сайт.</td>
    </tr>
    <tr>
      <td>List of all blog posts</td>
      <td><code>/blog/blogs/</code></td>
      <td>
        <p>Список всех сообщений блога:</p>
        <ul>
          <li>Доступно для всех пользователей из боковой панели.</li>
          <li>
            Список отсортирован по дате публикации (от самого нового до самого
            старого).
          </li>
          <li>Список разбит на группы по 5 статьям.</li>
          <li>
            Элементы списка отображают название блога, дату публикации и автора.
          </li>
          <li>
            Названия сообщений блога связаны с страницами подробных сведений о
            блоге.
          </li>
          <li>
            Blogger (имена авторов) связаны с страницами подробных сведений о
            блоге.
          </li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>Blog author (blogger) detail page</td>
      <td>
        <code>/blog/blogger/<em>&#x3C;author-id></em></code>
      </td>
      <td>
        <p>Информация для указанного автора (по id) и список постов:</p>
        <ul>
          <li>
            Доступен для всех пользователей по ссылкам на автора в сообщениях в
            блогах и т. Д.
          </li>
          <li>Содержит некоторые биографические данные в blogger/author.</li>
          <li>Список отсортирован по дате добавления (от новых к старым).</li>
          <li>Не разбит на страницы.</li>
          <li>
            Элементы списка отображают только имя сообщения в блоге и дату
            публикации.
          </li>
          <li>Названия блога связаны со страницей блога.</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>Blog post detail page</td>
      <td>
        <code>/blog/<em>&#x3C;blog-id></em></code>
      </td>
      <td>
        <p>Сведения о блоге.</p>
        <ul>
          <li>Доступно для всех пользователей из списков блога.</li>
          <li>
            Страница содержит сообщение в блоге: имя, автор, дата публикации и
            содержание.
          </li>
          <li>Комментарии к сообщению в блоге должны отображаться внизу.</li>
          <li>
            Комментарии должны быть отсортированы по порядку: от старых до самых
            последних.
          </li>
          <li>
            Содержит ссылку для добавления комментариев на конец для
            зарегистрированных пользователей (см. Страницу формы комментариев)
          </li>
          <li>
            В блогах и комментариях должен отображаться только обычный текст.
            Нет необходимости поддерживать какую-либо разметку HTML (например,
            ссылки, изображения, полужирный / курсив и т. Д.).
          </li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>List of all bloggers</td>
      <td><code>/blog/bloggers/</code></td>
      <td>
        <p>Список блогеров в системе:</p>
        <ul>
          <li>Доступный для всех пользователей с боковой панели сайта</li>
          <li>Имя блогера связано с блогом автора страницы.</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>Comment form page</td>
      <td><code>/blog/<em>&#x3C;blog-id></em>/create</code></td>
      <td>
        <p>Создать комментарий для публикации в блоге:</p>
        <ul>
          <li>
            Доступно только зарегистрированным пользователям (только) из ссылки
            внизу страницы с подробными сведениями блога.
          </li>
          <li>
            Отображает форму с описанием для ввода комментариев (дата публикации
            и блог недоступны для редактирования).
          </li>
          <li>
            После того, как комментарий будет опубликован, страница будет
            перенаправлена на связанную страницу блога.
          </li>
          <li>
            Пользователи не могут редактировать или удалять свои сообщения.
          </li>
          <li>
            Вышедшие пользователи будут перенаправлены на страницу входа в
            систему, чтобы добавить комментарии. После входа в систему они будут
            перенаправлены на страницу блога, которую они хотели бы
            прокомментировать.
          </li>
          <li>
            Страницы комментариев должны содержать имя / ссылку на комментарий
            блога.
          </li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>User authentication pages</td>
      <td>
        <code>/accounts/<em>&#x3C;standard urls></em></code>
      </td>
      <td>
        <p>
          Стандартные страницы аутентификации Django для входа, выхода и
          установки пароля:
        </p>
        <ul>
          <li>
            Вход / выход должен быть доступен через ссылки боковой панели.
          </li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>Admin site</td>
      <td>
        <code>/admin/<em>&#x3C;standard urls></em></code>
      </td>
      <td>
        <p>
          Админ-сайт должен быть включён, чтобы разрешить создание /
          редактирование / удаление сообщений в блогах, авторов блога и
          комментариев блога (это механизм для создания блогеров в блогах):
        </p>
        <ul>
          <li>
            В админ панеле должен отображаться список комментариев в строке
            (внизу каждого сообщения в блоге).
          </li>
          <li>
            Имена комментариев в админке создаются усеканием описания
            комментария до 75 знаков
          </li>
          <li>Другие типы записей могут использовать базовую регистрацию.</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

Кроме того, вы должны написать некоторые базовые тесты для проверки:

- Все поля модели имеют правильную метку и длину.
- Все модели имеют ожидаемое имя объекта (например, `__str__()` выдаёт ожидаемое значение).
- Модели имеют ожидаемый URL для отдельных записей в блогах и комментариях (например, `get_absolute_url()` возвращает ожидаемый URL-адрес).
- Страница BlogListView (страница на всех блогах) доступна в ожидаемом месте (например, /blog/blogs)
- Страница BlogListView (страница на всех блогах) доступна на ожидаемом именованном URL-адресе (например, 'blogs')
- Страница BlogListView (страница на всех блогах) использует ожидаемый шаблон (например, по умолчанию)
- BlogListView разбивает записи на 5 (по крайней мере, на первой странице)

> [!NOTE]
> Конечно, есть много других тестов, которые вы можете запустить. Используйте на своё усмотрение, но мы ожидаем, что вы сделаете хотя бы тесты выше.

В следующем разделе показаны [скриншоты](#Screenshots) сайта, который выполняет перечисленные выше требования.

## Скриншоты

Следующий скриншот - пример того, что должна выводить готовая программа.

### Список всех сообщений в блоге

Это отображает список всех сообщений в блоге (доступны из ссылки "All blogs" на боковой панели). Что нужно отметить:

- На боковой панели также списки вошедшего в систему пользователя.
- Индивидуальные блоги и блогеры доступны в виде ссылок на странице.
- Разбивка включена (в группах по 5)
- Показ от новых к старым.

![List of all blogs](diyblog_allblogs.png)

### Список всех блогеров

Это ссылки на всех блогеров в "All bloggers" по ссылке, которая на боковой панели. В этом случае мы можем увидеть на боковой панели, что ни один пользователь не вошёл в систему.

![List of all bloggers](diyblog_blog_allbloggers.png)

### Подробная страница блога

Это показывает подробную страницу для конкретного блога.

![Blog detail with add comment link](diyblog_blog_detail_add_comment.png)

Обратите внимание, что комментарии имеют дату _и_ время, и расположены в порядке от самых старых до новейших (противоположно порядку ведения блога). В конце у нас есть ссылка для доступа к форме, чтобы добавить новый комментарий. Если пользователь не вошёл в систему, мы бы увидели предложение войти в систему.

![Comment link when not logged in](diyblog_blog_detail_not_logged_in.png)

### Добавить форму комментария

Это форма добавления комментариев. Обратите внимание, что мы вошли в систему. Когда это удастся, мы должны вернуться к связанной странице блога.

![Add comment form](diyblog_comment_form.png)

### Об авторе

Здесь отображается информация о блогере вместе со списком его блогов.

![Blogger detail page](diyblog_blogger_detail.png)

## Завершающие шаги

В следующих разделах описывается, что вам нужно делать.

1. Создайте скелет проекта и веб-приложение для сайта (как описано в [Django Tutorial Part 2: Creating a skeleton website](/ru/docs/Learn/Server-side/Django/skeleton_website)). Вы можете использовать «diyblog» для имени проекта и «blog» для имени приложения.
2. Создавайте модели для записей в блогах, комментариев и любых других необходимых объектов.

   - Каждый комментарий будет иметь только один блог, но блог может иметь много комментариев.
   - Посты в блоге и комментарии должны быть отсортированы по дате поста.
   - Не каждый пользователь обязательно будет автором блога, хотя любой пользователь может быть комментатором.
   - Блог автора также должен включать информацию о себе.

3. Запустите миграцию для новых моделей и создайте суперпользователя.
4. Используйте админ панель, чтобы создать какой-нибудь пример блога и комментарии в блогах.
5. Создайте представления, шаблоны, и URL-конфигурации для публикации блога и списка страниц блогера.
6. Создайте представления, шаблоны, и URL-конфигурации для публикации блога и подробных страниц блогера.
7. Создайте страницу с формой для добавления новых комментариев (не забудьте сделать это доступным только для зарегистрированных пользователей!)

## Советы и подсказки

Этот проект очень похож на [LocalLibrary](/ru/docs/Learn/Server-side/Django/Tutorial_local_library_website) учебник. Вы сможете настроить скелет, поведение входа пользователя / выхода из системы, поддержку статических файлов, представлений, URL-адресов, форм, базовых шаблонов и конфигурации админ-панели, используя почти все те же подходы.

Некоторые общие рекомендации:

1. Индексная страница (index page) может быть реализована в качестве основной функции представления и шаблона (как и для locallibrary).
2. Просмотр списка публикаций блога и блогеров, а также подробное представление для сообщений в блоге можно создать с помощью [generic list and detail views](/ru/docs/Learn/Server-side/Django/Generic_views).
3. Список постов в блоге конкретного автора может быть создан с помощью общего списка Blog list view и фильтрация для объекта блога, соответствующего указанному автору.

   - Вам придётся реализовать `get_queryset(self)` для фильтрации (как и в нашем классе библиотеки `LoanedBooksAllListView`) и получить информацию об авторе из URL-адреса.
   - Вам также необходимо передать имя автора на страницу в контексте. Чтобы сделать это в представлении на основе классов, вам необходимо реализовать `get_context_data()` (обсуждается ниже).

4. Форма _добавления комментариев_ может быть создана с использованием функционального представления (и связанной модели и формы) или с использованием общего `CreateView`. Если вы используете `CreateView` (рекомендуется):

   - Вам также нужно будет передать имя блога на страницу комментариев в контексте (реализовать `get_context_data()` как обсуждается ниже).
   - Форма должна отображать только комментарий «описание» для записи пользователя (дата и связанная с ними запись в блоге не должны редактироваться). Поскольку они не будут в форме, ваш код должен будет установить автора комментария в `form_valid()` функцию, поэтому он может быть сохранён в модели ([as described here](https://docs.djangoproject.com/en/2.0/topics/class-based-views/generic-editing/#models-and-request-user) — Django docs). В этой же функции мы устанавливаем связанный блог. Возможная реализация показана ниже (`pk` это идентификатор блога, переданный из URL / URL конфигурации ).

     ```python
         def form_valid(self, form):
             """
             Add author and associated blog to form data before setting it as valid (so it is saved to model)
             """
             #Add logged-in user as author of comment
             form.instance.author = self.request.user
             #Associate comment with blog based on passed id
             form.instance.blog=get_object_or_404(Blog, pk = self.kwargs['pk'])
             # Call super-class form validation behaviour
             return super(BlogCommentCreate, self).form_valid(form)
     ```

   - Для успешного перенаправления после проверки формы вам нужно будет указать URL-адрес; это должен быть оригинальный блог. Для этого вам нужно будет переопределить `get_success_url()` и «обратный» URL-адрес для исходного блога. Вы можете получить требуемый ID блога, используя `self.kwargs` атрибут, как показано в методе `form_valid()` выше.

Мы кратко говорили о передаче контекста шаблону в представлении на основе классов в теме [Django Tutorial Part 6: Generic list and detail views](/ru/docs/Learn/Server-side/Django/Generic_views#Overriding_methods_in_class-based_views). Для этого вам нужно переопределить `get_context_data()` (сначала получить существующий контекст, обновить его любыми дополнительными переменными, которые вы хотите передать шаблону, а затем вернуть обновлённый контекст). Например, фрагмент кода ниже показывает, как вы можете добавить объект blogger в контекст на основе его `BlogAuthor` id.

```python
class SomeView(generic.ListView):
    ...

    def get_context_data(self, **kwargs):
        # Call the base implementation first to get a context
        context = super(SomeView, self).get_context_data(**kwargs)
        # Get the blogger object from the "pk" URL parameter and add it to the context
        context['blogger'] = get_object_or_404(BlogAuthor, pk = self.kwargs['pk'])
        return context
```

## Аттестация

Оценка этого задания [доступна здесь на Github](https://github.com/mdn/django-diy-blog/blob/master/MarkingGuide.md). Эта оценка в основном основана на том, насколько хорошо ваше приложение соответствует требованиям, перечисленным выше, хотя есть некоторые части оценки, которые проверяют ваш код на использование соответствующих моделей и что вы написали хотя бы некоторый тестовый код. Когда вы закончите, вы можете проверить по нашему [готовому примеру](https://github.com/mdn/django-diy-blog) который соответствует "высокой оценке проекта".

После того, как вы завершили этот модуль, вы также закончили весь контент MDN для изучения базового веб-сайта на сервере Django! Надеемся, вам понравится этот модуль и вы почувствуете, что у вас есть хорошее понимание основ!

{{PreviousMenu("Learn/Server-side/Django/web_application_security", "Learn/Server-side/Django")}}
