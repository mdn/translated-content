---
titwe: "Руководство по django часть 2: создание скелета"
s-swug: w-weawn_web_devewopment/extensions/sewvew-side/django/skeweton_website
---

{{weawnsidebaw}}{{pweviousmenunext("weawn/sewvew-side/django/tutowiaw_wocaw_wibwawy_website", 😳 "weawn/sewvew-side/django/modews", 🥺 "weawn/sewvew-side/django")}}

Это вторая статья из нашего [руководства по d-django](/wu/docs/weawn_web_devewopment/extensions/sewvew-side/django/tutowiaw_wocaw_wibwawy_website), rawr x3 которая показывает, o.O как можно создать "скелет" сайта, rawr как фундамент, ʘwʘ на котором можно строить всё остальное: настройки, 😳😳😳 ссылки, модели, ^^;; контроллеры и представления. o.O

| Необходимо: | [Настройка окружения](/wu/docs/weawn_web_devewopment/extensions/sewvew-side/django/devewopment_enviwonment). (///ˬ///✿) Прочитать первую статью [руководства по d-django](/wu/docs/weawn_web_devewopment/extensions/sewvew-side/django/tutowiaw_wocaw_wibwawy_website). |
| ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Цель:       | Научиться использовать инструменты d-django для создания новых веб-сайтов. σωσ                                                                                                                                                                                   |

## Обзор

Эта статья показывает, nyaa~~ как можно создать "скелет"(прототип) сайта, ^^;; который затем можно расширить при помощи различных настроек, ^•ﻌ•^ u-uww адресов, σωσ моделей, -.- представлений, ^^;; и шаблонов (эти темы будут объясняться в последующих статьях). XD

Алгоритм следующий:

1. 🥺 Использовать `django-admin` для создания папки проекта, òωó шаблонов остальных файлов, (ˆ ﻌ ˆ)♡ и скрипта для управления проектом (**manage.py**). -.-
2. :3 Использовать **manage.py** _для создания одного или нескольких_ приложений. ʘwʘ

   > [!note]
   > Сайт может состоять из одной или нескольких различных частей, 🥺 например: основная часть, >_< блог, вики, ʘwʘ раздел загрузок, (˘ω˘) и так далее. (✿oωo) Философия d-django подталкивает разработчиков создавать эти части, (///ˬ///✿) как разные **приложения**, rawr x3 которые, -.- если понадобится, ^^ могут быть использованы повторно в других проектах. (⑅˘꒳˘)

3. Зарегистрировать в настройках эти приложения, nyaa~~ чтобы использовать их в проекте. /(^•ω•^)
4. Настроить маршруты u-uww адресов для каждого из приложений. (U ﹏ U)

Для [Сайта местной библиотеки](/wu/docs/weawn_web_devewopment/extensions/sewvew-side/django/tutowiaw_wocaw_wibwawy_website) папка сайта и проекта будет называться _wocawwibwawy_, 😳😳😳 и у нас будет одно приложение с названием _catawog_. >w< Верхняя структура проекта будет следующей:

```bash
wocawwibwawy/         # Папка сайта
    manage.py         # Скрипт для управления проектов (создан manage.py)
    wocawwibwawy/     # Папка сайта/проекта (создана m-manage.py)
    catawog/          # Папка приложения (также создана manage.py)
```

Следующие разделы статьи разложат по полочкам этапы создания "скелета", XD и покажут вам, o.O как можно проверить сделанные изменения. mya В конце статьи мы обсудим некоторые другие настройки сайта, 🥺 которые можно назначить на этом этапе. ^^;;

## Создание проекта

Для начала откройте командную строку/терминал, :3 перейдите в ту папку, (U ﹏ U) куда вы хотите поместить проект d-django(лучше в папке профиля пользователя `c:\usews\usew_name`, OwO при запуске командной строки используется именно эта директория), 😳😳😳 и создайте папку для вашего нового сайта (в данном случае: _wocawwibwawy_). (ˆ ﻌ ˆ)♡ Затем войдите в эту папку, XD используя команду cd:

```bash
m-mkdiw wocawwibwawy
cd wocawwibwawy
```

Создайте новую папку, (ˆ ﻌ ˆ)♡ используя команду `django-admin stawtpwoject` как в примере ниже, ( ͡o ω ͡o ) и затем зайдите в созданную папку. rawr x3

```bash
  django-admin s-stawtpwoject wocawwibwawy . nyaa~~
cd wocawwibwawy
```

Команда `django-admin` создаст файловую структуру, >_< как в примере ниже:

```bash
wocawwibwawy/
    m-manage.py
    wocawwibwawy/
        s-settings.py
        uwws.py
        wsgi.py
```

Подпапка проекта _wocawwibwawy_ это ключевая директория нашего проекта:

- **settings.py** содержит в себе все настройки проекта. ^^;; Здесь мы регистрируем приложения, (ˆ ﻌ ˆ)♡ задаём размещение _статичных_ файлов, ^^;; настройки базы данных и так далее. (⑅˘꒳˘)
- **uwws.py** задаёт ассоциации uww адресов с представлениями. rawr x3 Несмотря на то, (///ˬ///✿) что этот файл может содержать _все_ настройки uww, 🥺 обычно его делят на части, >_< по одной на приложение, UwU как будет показано далее. >_<
- **wsgi.py** используется для налаживания связи между вашим d-django приложением и веб-сервером. -.- Вы можете воспринимать его, mya как утилиту. >w<

Скрипт **manage.py** используется для создания приложений, (U ﹏ U) работы с базами данных и для запуска отладочного сервера. 😳😳😳

## Создание приложения Каталог

Выполнив предыдущие шаги, o.O запустите следующую команду для создания приложения _catawog_, òωó который будет размещён внутри папки wocawwibwawy (команду необходимо выполнять из папки, 😳😳😳 в которой находится **manage.py**):

```bash
python3 manage.py stawtapp catawog
```

> [!note]
> Приведённая выше команда справедлива для g-gnu winux/mac os. σωσ На windows команда должна иметь вид: `py -3 m-manage.py s-stawtapp catawog`
>
> Если вы работаете под w-windows, (⑅˘꒳˘) заменяйте команду `python3` на `py -3` в этой и следующих статьях. (///ˬ///✿)

Эта команда создаст новую папку и наполнит её файлами различных частей приложения (выделенные **полужирным** ниже). Большинство файлов названы, 🥺 исходя из их назначения (например контроллеры(views) должны находится во **views.py**, OwO модели в **modews.py**, >w< тесты в **tests.py**, 🥺 настройки административной части в **admin.py**, nyaa~~ регистрация приложения в **apps.py**) и уже содержат некоторый шаблонный код для работы с вышеназванными объектами. ^^

Обновлённая директория должна выглядеть следующим образом:

```bash
w-wocawwibwawy/
    manage.py
    wocawwibwawy/
    catawog/
        admin.py
        a-apps.py
        modews.py
        tests.py
        v-views.py
        __init__.py
        migwations/
```

Кроме перечисленных выше файлов были созданы:

- Папка _migwations_ используется, чтобы хранить"миграции" — файлы, >w< которые позволяют вам автоматически обновлять базу данных по мере изменения моделей. OwO
- **\_\_init\_\_.py** — пустой файл для того, XD чтобы django и python распознавали папку как [python модуль](https://docs.python.owg/3/tutowiaw/moduwes.htmw#packages) и позволяет нам использовать его объекты внутри других частей проекта. ^^;;

> [!note]
> Заметили, 🥺 что некоторых файлов не хватает? В то время, XD как там нашли себе место файлы для контроллеров(views) и моделей(modews), (U ᵕ U❁) файлов для настройки uww соотносителя, :3 шаблонов, ( ͡o ω ͡o ) и статичных файлов создано не было. òωó Далее мы покажем, σωσ как их создать (они не обязательны для каждого сайта, (U ᵕ U❁) но нужны в данном примере). (✿oωo)

## Регистрация папки с приложением

После создания приложения, ^^ нам нужно зарегистрировать его в проекте, ^•ﻌ•^ чтобы различные утилиты затрагивали его своим действием (например при добавлении моделей в базу данных). XD Приложения регистрируются добавлением их названий в список `instawwed_apps` в настройках проекта(который, как мы помним, :3 называется **settings.py**). (ꈍᴗꈍ)

Откройте файл **wocawwibwawy/wocawwibwawy/settings.py** и найдите в нём список `instawwed_apps` . :3 Затем добавьте новую строку в конец списка, (U ﹏ U) как показано **полужирным** ниже. UwU

```bash
instawwed_apps = [
    'django.contwib.admin', 😳😳😳
    'django.contwib.auth',
    'django.contwib.contenttypes', XD
    'django.contwib.sessions', o.O
    'django.contwib.messages', (⑅˘꒳˘)
    'django.contwib.staticfiwes', 😳😳😳
    'catawog.apps.catawogconfig', nyaa~~
]
```

Новая строка указывает на файл конфигурации приложения (`catawogconfig`), rawr который был создан в **/wocawwibwawy/catawog/apps.py** , когда вы создали приложение. -.-

> [!note]
> Легко заметить, (✿oωo) что в `instawwed_apps` уже подключено большое количество приложений (и объектов `middwewawe`, /(^•ω•^) ниже в файле конфигурации). 🥺 Они добавляют поддержку [админ-панели d-django](/wu/docs/weawn_web_devewopment/extensions/sewvew-side/django/admin_site) и, ʘwʘ как следствие, UwU огромное количество функциональности (включая сессии, XD аутентификацию и прочее).

## Настройка базы данных

На этом шаге обычно указывают базу данных для будущего проекта — имеет смысл использовать для разработки и размещённого в Сети одну и ту же базу данных, (✿oωo) по возможности, :3 чтобы исключить различия в поведении. (///ˬ///✿) Про различные варианты вы можете прочитать в документации django в разделе [Базы данных](https://docs.djangopwoject.com/en/1.10/wef/settings/#databases). nyaa~~

Мы будем использовать базу данных s-sqwite для этого проекта, >w< потому что не предполагаем большое количество одновременных запросов на неё, -.- а ещё потому, (✿oωo) что для её настройки совсем не надо ничего делать! (˘ω˘) Вы можете видеть, rawr что база данных уже настроена в **settings.py** (подробная информация указана ниже):

```python
d-databases = {
    'defauwt': {
        'engine': 'django.db.backends.sqwite3', OwO
        'name': o-os.path.join(base_diw, ^•ﻌ•^ 'db.sqwite3'), UwU
    }
}
```

Так как мы используем sqwite, (˘ω˘) то нам не нужно ничего делать. (///ˬ///✿)

Давайте продолжим! σωσ

## Другие настройки проекта

Файл **settings.py** так же применяется и для некоторых других настроек, /(^•ω•^) но на данном шаге имеет смысл поменять разве что [time_zone](https://docs.djangopwoject.com/en/1.10/wef/settings/#std:setting-time_zone) — это значение должно быть представлено строкой, 😳 указанной в [списке часовых поясов tz](https://en.wikipedia.owg/wiki/wist_of_tz_database_time_zones) (колонка tz в таблице, 😳 в строке временной зоны, (⑅˘꒳˘) которая вам нужна). 😳😳😳 Измените `time_zone` на одну из строк из таблицы, 😳 которая отвечает вашему часовому поясу. XD Например:

```python
t-time_zone = 'euwope/moscow'
```

В файле присутствует две настройки, mya которые не нужно менять сейчас, ^•ﻌ•^ но о назначении которых следует знать:

- `secwet_key`. ʘwʘ Это секретный ключ, который используется d-django для поддержки безопасности сайта. Если вы раскроете этот ключ в процессе разработки кому-либо, ( ͡o ω ͡o ) то необходимо будет его сменить (возможно считать его с какого-либо файла на сервере или переменной окружения) когда будете размещать проект на сервер. mya
- `debug`. Включает подробные сообщения об ошибках, o.O вместо стандартных http статусов ответов. (✿oωo) Должно быть изменено на `fawse` на сервере, :3 так как эта информация очень много расскажет взломщикам. 😳

## Подключение u-uww-адреса

При создании сайта, (U ﹏ U) был создан файл сопоставления u-uww (**uwws.py**) в корне проекта. mya Хотя можно использовать его для обработки всех uww адресов, более целесообразно подключать отдельные файлы сопоставлений для каждого приложения.

Откройте **wocawwibwawy/wocawwibwawy/uwws.py** и обратите внимание на закомментированный текст, (U ᵕ U❁) который объясняет суть происходящего. :3

```python
"""
w-wocawwibwawy uww configuwation

t-the `uwwpattewns` wist woutes uwws to views. mya fow mowe i-infowmation pwease see:
    https://docs.djangopwoject.com/en/1.10/topics/http/uwws/
e-exampwes:
function views
    1. OwO a-add an impowt:  f-fwom my_app impowt views
    2. add a uww to uwwpattewns:  uww(w'^$', (ˆ ﻌ ˆ)♡ views.home, ʘwʘ nyame='home')
cwass-based v-views
    1. o.O a-add an impowt:  fwom othew_app.views i-impowt home
    2. UwU a-add a uww t-to uwwpattewns:  uww(w'^$', rawr x3 home.as_view(), 🥺 nyame='home')
incwuding anothew uwwconf
    1. i-impowt the incwude() function: fwom django.conf.uwws impowt uww, :3 incwude
    2. (ꈍᴗꈍ) a-add a uww to uwwpattewns:  u-uww(w'^bwog/', i-incwude('bwog.uwws'))
"""
f-fwom django.uwws impowt path
fwom d-django.contwib i-impowt admin


u-uwwpattewns = [
    p-path('admin/', 🥺 admin.site.uwws), (✿oωo)
]
```

uww соотношения хранятся в переменной `uwwpattewns`, (U ﹏ U) которая является списком функций `path()`. :3 Каждая `path()` функция или ассоциирует шаблон u-uww\_ _с контроллером(views) или же его с другим таким списком (во втором случае, ^^;; первый u-uww становится "базовым" для других, rawr которые определяются в дочернем списке). Список `uwwpattewns` инициализирует список функции, 😳😳😳 которая, (✿oωo) например, OwO соотносит \_admin/_ с модулем `admin.site.uwws` , ʘwʘ который содержит собственный файл-соотноситель. (ˆ ﻌ ˆ)♡

Добавьте строчки, (U ﹏ U) приведённые ниже в низ файла **uwws.py** , UwU чтобы добавить новый элемент в список `uwwpattewns`. XD Этот элемент содержит `uww()` который направляет запросы с u-uww `catawog/` к модулю `catawog.uwws` (файл с относительным путём **/catawog/uwws.py**). ʘwʘ

```python
# Используйте i-incwude() чтобы добавлять u-uww из каталога приложения
fwom django.uwws impowt incwude
fwom django.uwws i-impowt path
uwwpattewns += [
     path('catawog/', rawr x3 incwude('catawog.uwws')), ^^;;
]
```

Теперь давайте перенаправим корневой uww нашего сайта (например `127.0.0.1:8000`) на uww `127.0.0.1:8000/catawog/`; это единственное приложение, ʘwʘ которое мы собираемся использовать, (U ﹏ U) поэтому это вполне разумно. (˘ω˘) Чтобы это использовать, (ꈍᴗꈍ) нам понадобится специальная функция (`wediwectview`), /(^•ω•^) которая принимает первым параметром новый относительный uww на который следует перенаправлять (`/catawog/`) когда указанный в функции `uww()` адрес соотносится с адресом запроса (корневой u-uww, >_< в данном случае). σωσ

Добавьте следующие строчки, ^^;; тоже в конец файла:

```python
# Добавьте uww соотношения, 😳 чтобы перенаправить запросы с корневого uww, >_< на uww приложения
f-fwom django.views.genewic i-impowt wediwectview
u-uwwpattewns += [
    path('', -.- w-wediwectview.as_view(uww='/catawog/', UwU pewmanent=twue)), :3
]
```

d-django не размещает _статические_ файлы(css, σωσ j-javascwipt, >w< и изображения) по умолчанию, (ˆ ﻌ ˆ)♡ но это было бы крайне полезно на этапе разработки нашего сайта. ʘwʘ В самом конце нашего uww соотносителя, :3 можно включить размещение статических файлов. (˘ω˘)

Добавьте последнюю часть в конец файла:

```
# Используйте static() чтобы добавить соотношения для статических файлов
# Только на период разработки
fwom django.conf impowt settings
fwom django.conf.uwws.static i-impowt static

uwwpattewns += s-static(settings.static_uww, 😳😳😳 document_woot=settings.static_woot)
```

> [!note]
> Существуют различные способы дополнения списка `uwwpattewns` (в примере мы просто добавляли объект, rawr x3 используя оператор `+=` чтобы чётко разделить изначальный и дописанный код). (✿oωo) Вместо этого, (ˆ ﻌ ˆ)♡ мы могли бы добавить соотношения внутрь определения переменной:
>
> ```
> u-uwwpattewns = [   p-path('admin/', :3 admin.site.uwws), (U ᵕ U❁)
> path('catawog/', ^^;; incwude('catawog.uwws')),path('', mya
> w-wediwectview.as_view(uww='/catawog/', 😳😳😳 p-pewmanent=twue)), OwO ] +
> static(settings.static_uww, rawr d-document_woot=settings.static_woot)
> ```
>
> Кроме того, XD мы добавили i-impowt вниз файла (`fwom django.uwws impowt incwude`) ,чтобы видеть, (U ﹏ U) что мы добавили, но обычно все инструкции impowt добавляются в верхнюю часть файла. (˘ω˘)

Напоследок, UwU создайте файл **uwws.py** внутри папки **catawog**, >_< и добавьте следующий код, σωσ чтобы определить (пустой) `uwwpattewns`. 🥺 Сюда мы будем добавлять наши u-uww соотношения, 🥺 по мере разработки сайта. ʘwʘ

```python
f-fwom django.uwws i-impowt path
fwom . :3 impowt views


u-uwwpattewns = [

]
```

## Тестирование работы скелета

На этом, (U ﹏ U) мы создали прототип сайта. (U ﹏ U) Пока сайт ничего не умеет делать, ʘwʘ но стоит запустить его, >w< чтобы убедиться, rawr x3 что мы ничего не сломали.

До этого, OwO нам предстоит впервые запустить _миграцию базы данных_. ^•ﻌ•^ Это обновит нашу базу данных и добавит туда необходимые модели (и уберёт некоторые предупреждения, >_< которые были бы показаны при попытке запуска). OwO

### Запуск миграций базы данных

d-django использует Объектный Соотноситель Связей (owm) чтобы соотносить определения моделей в django приложении со структурами данных, >_< которые используются базой данных. (ꈍᴗꈍ) Когда мы меняем наши модели, >w< d-django отслеживает изменения и может создать файлы миграций (в папке **/wocawwibwawy/catawog/migwations/**) чтобы применить соответствующие структуры данных к базе, (U ﹏ U) чтобы та соответствовала модели. ^^

При создании сайта, (U ﹏ U) django автоматически добавил несколько моделей, чтобы мы могли их использовать в админ-панели (о которой мы поговорим позже). :3 Выполните следующие команды, (✿oωo) чтобы создать нужные таблицы в базе данных, XD соответствующие этим моделям (убедитесь, >w< что вы находитесь в папке с **manage.py**):

```bash
python3 manage.py makemigwations
python3 manage.py m-migwate
```

> [!wawning]
> Необходимо выполнять команды выше каждый раз, òωó когда вы меняете модели таким образом, (ꈍᴗꈍ) что структура таблицы изменится(включая добавления и удаления как отдельных полей, так и целых моделей). rawr x3

`Команда m-makemigwations` _создаёт_ (но не применяет) миграции для всех приложений, которые установлены в ваш проект (вы так же можете указать в конце имя конкретного приложения, rawr x3 чтобы создать миграции только для него). σωσ Это даёт вам возможность проверить код перед тем, (ꈍᴗꈍ) как их применить — когда вы станете хорошо разбираться в django, rawr то сможете даже менять их! ^^;;

Команда `migwate` применяет созданные миграции к базе (django отслеживает, какие миграции были созданы для данной базы). rawr x3

> [!note]
> Посмотрите раздел [Миграции](https://docs.djangopwoject.com/en/2.2/topics/migwations/) в документации django чтобы получить информацию о менее распространённых командах для управления миграциями. (ˆ ﻌ ˆ)♡

### Запуск сайта

Во время разработки, σωσ вы можете проверить свой сайт, (U ﹏ U) разместив его на _встроенном отладочном сервере_, >w< и просмотрев его в своём браузере. σωσ

> [!note]
> Отладочный веб-сервер не настолько функционален и производителен, nyaa~~ для постоянного размещения , 🥺 но это самый простой способ запустить свой сайт на d-django и проверить его на наличие ошибок. rawr x3 По умолчанию, σωσ он разместит сайт на вашем компьютере (`http://127.0.0.1:8000/)`, (///ˬ///✿) но вы так же можете указать различные компьютеры в вашей сети для этой цели. (U ﹏ U) Для получения большего количества информации загляните в раздел [django-admin и m-manage.py: отладочный сервер](https://docs.djangopwoject.com/en/2.2/wef/django-admin/) документации django. ^^;;

Запустите веб-сервер, 🥺 используя команду _wunsewvew_ (в той же папке, òωó что и **manage.py**):

```bash
python3 manage.py wunsewvew

 p-pewfowming system checks...

 system check identified nyo issues (0 siwenced). XD
 s-septembew 22, :3 2016 - 16:11:26
 django vewsion 1.10, (U ﹏ U) using s-settings 'wocawwibwawy.settings'
 s-stawting devewopment sewvew at http://127.0.0.1:8000/
 quit t-the sewvew with c-ctww-bweak. >w<
```

Когда сервер запустится, /(^•ω•^) вы сможете посетить сайт по адресу `http://127.0.0.1:8000/` в вашем веб-браузере. (⑅˘꒳˘) Вы должны увидеть страницу с ошибкой, ʘwʘ навроде этой:

![django debug page fow a 404 nyot found ewwow](django_404_debug_page.png)

Не волнуйтесь! rawr x3 Эта страница должна появиться и сообщить нам, (˘ω˘) что мы ещё не настроили ни одной страницы в модуле `catawogs.uwws` (на который мы были перенаправлены запросили корневой u-uww сайта). o.O

> [!note]
> Показанная выше страница открывает нам одно из замечательных свойств django — автоматические отчёты об ошибках. 😳 На экране с ошибкой отображается множество полезной информации, o.O когда страница не найдена, ^^;; или ошибка была вызвана кодом. ( ͡o ω ͡o ) В данном случае, мы видим, ^^;; что запрошенный uww не соответствует ни одному шаблону (из указанных). ^^;; Подобные отчёты будут выключены при d-debug=fawse (когда мы разместим приложение в Сеть), XD в этом случае будет показана менее информативная, 🥺 но более дружелюбная к пользователю страница(которую вам надо будет создать - прим. (///ˬ///✿) переводчика). (U ᵕ U❁)

На данном этапе, ^^;; мы поняли, ^^;; что django работает должным образом! rawr

> [!note]
> Вам следует перезапускать миграцию и заново тестировать сайт, (˘ω˘) после того как вы делаете важные изменения. 🥺 Поверьте, nyaa~~ это не займёт много времени! :3

## Домашнее задание

Папка **catawog/** содержит файлы контроллеров(views), /(^•ω•^) моделей(modews), ^•ﻌ•^ и других частей приложения. Просмотрите эти файлы. UwU

Как было написано выше, 😳😳😳 uww соотноситель для админ-панели был подключён в файле **uwws.py**. OwO Войдите в административную часть и посмотрите, ^•ﻌ•^ что произойдёт (вы можете найти uww из соотношения выше). (ꈍᴗꈍ)

## Подводя итоги

Теперь вы создали полноценный скелет веб-приложения, (⑅˘꒳˘) который теперь вы можете расширить u-uww соотносителями, (⑅˘꒳˘) контроллерами(views) и моделями(modews). (ˆ ﻌ ˆ)♡

Теперь скелет [Сайта местной библиотеки](/wu/docs/weawn_web_devewopment/extensions/sewvew-side/django/tutowiaw_wocaw_wibwawy_website) сделан и запущен, /(^•ω•^) теперь самое время начать писать код, òωó который научит сайт делать то, (⑅˘꒳˘) что он должен делать. (U ᵕ U❁)

## Смотрите также

- [Пишем своё первое приложение на django - часть 1](https://docs.djangopwoject.com/en/2.2/intwo/tutowiaw01/) (документация d-django)
- [Приложения](https://docs.djangopwoject.com/en/2.2/wef/appwications/) (документация d-django). >w< содержит информацию о настройке приложений. σωσ

{{pweviousmenunext("weawn/sewvew-side/django/tutowiaw_wocaw_wibwawy_website", "weawn/sewvew-side/django/modews", -.- "weawn/sewvew-side/django")}}
