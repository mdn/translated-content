---
title: Использование событий касания
slug: Web/API/Touch_events/Using_Touch_Events
---

{{DefaultAPISidebar("Touch Events")}}

На сегодняшний день бо́льшая часть содержимого в вебе рассчитана на работу с использованием клавиатуры и мыши. Тем не менее, всё больше появляется устройств с сенсорным экраном (особенно мобильных) и веб-приложения могут либо напрямую обрабатывать сенсорный ввод с помощью {{domxref("Touch_events","Событий касаний")}}, либо интерпретировать события мыши. Недостатком использования событий мыши является то, что они не поддерживают одновременный ввод, тогда как события касаний поддерживают несколько одновременных прикосновений (возможно в разных местах сенсорной поверхности), повышая тем самым удобство работы с интерфейсом.

Интерфейсы событий касания поддерживают взаимодействие с приложением с помощью одного или нескольких одновременных прикосновений, такие как жест двумя пальцами. Взаимодействие с помощью нескольких одновременных прикосновений начинается, когда палец (или стилус) впервые касается контактной поверхности. Другие пальцы могут последовательно касаться поверхности и, если нужно, перемещаться по ней. Взаимодействие заканчивается, когда пальцы убираются с поверхности. На протяжении этого взаимодействия приложение получает события касания на начальной стадии, стадии перемещения и стадии завершения. Приложение может применять собственную семантику к сенсорному вводу.

## Интерфейсы

События касаний включают три интерфейса {{domxref("Touch")}}, {{domxref("TouchEvent")}} и {{domxref("TouchList")}}, а также следующие типы событий

- [`touchstart`](/ru/docs/Web/Events/touchstart) - вызывается в момент касания сенсорной поверхности
- [`touchmove`](/ru/docs/Web/Events/touchmove) - вызывается при перемещении по сенсорной поверхности
- [`touchend`](/ru/docs/Web/Events/touchend) - вызывается, если убрали палец
- [`touchcancel`](/ru/docs/Web/Events/touchcancel) - вызывается в момент прерывания события (например, создано слишком много точек касания).

Интерфейс {{domxref("Touch")}} представляет собой одну точка контакта с сенсорной поверхностью. Точка контакта обычно называется точкой касания или просто касанием. Касание обычно генерируется пальцем или стилусом на сенсорной поверхности. [Свойства](/ru/docs/Web/API/Touch#Properties) точки касания включают уникальный идентификатор, целевой элемент точки касания, а также координаты X и Y точки касания относительно области видимости, страницы или экрана.

Интерфейс {{domxref("TouchList")}} представляет список точек контакта с сенсорной поверхностью, по одной точке касания на каждый контакт с поверхностью. Таким образом, если пользователь активировал сенсорную поверхность одним пальцем, список будет содержать один элемент, а если пользователь прикоснулся к поверхности тремя пальцами, в списке будет три элемента.

Интерфейс {{domxref("TouchEvent")}} представляет событие, которое отправляется, когда меняется состояние контактов с сенсорной поверхностью. Изменения состояния включают начальный контакт с сенсорной поверхностью, перемещение точки касания при сохранении контакта с поверхностью, отпускание точки касания и прерывание события касания. Атрибуты интерфейса включают состояние нескольких клавиш-модификаторов (например, клавиши <kbd>Shift</kbd>) и следующий список данных:

- {{domxref("TouchEvent.touches","touches")}} - список всех точек касания, находящихся в данный момент на экране
- {{domxref("TouchEvent.targetTouches","targetTouches")}} - список точек касания на целевом DOM-элементе
- {{domxref("TouchEvent.changedTouches","changedTouches")}} - список точек касания, элементы которых зависят от типа связанного события:

  - Для события [`touchstart`](/ru/docs/Web/Events/touchstart) - список точек касания, которые стали активными во время события
  - Для события [`touchmove`](/ru/docs/Web/Events/touchmove) - список точек касания, которые изменились с последнего события
  - Для события [`touchend`](/ru/docs/Web/Events/touchend) - список точек касания, которые были удалены с поверхности (то есть, набор точек касания, соответствующих пальцам, которые больше не касаются поверхности)

Вместе эти интерфейсы определяют относительно низкоуровневый набор функций, но при этом поддерживают множество видов взаимодействия с помощью касаний, включая знакомые жесты с несколькими касаниями, такие как пролистывание несколькими пальцами, вращение, сжатие и масштабирование.

## От интерфейсов к жестам

При определении семантики жеста, приложение может учитывать различные факторы. Например, расстояние, которое прошла точка от начала до конца касания. Другим возможным фактором может быть время, например, количество времени между началом касания и завершением, или количество времени между двумя последовательными касаниями, предназначенными для создания жеста двойного нажатия. Направленность свайпа (например, слева направо, справа налево и т.д) является ещё одним фактором.

Списки касаний, которые использует приложение, зависят от семантики его жестов. Например, если приложение поддерживает однократное касание (тап) одного элемента, будет использоваться список {{domxref("TouchEvent.targetTouches","targetTouches")}} в обработчике события [`touchstart`](/ru/docs/Web/Events/touchstart) для обработки точки касания в свойственной приложению манере. Если приложение поддерживает свайп двумя пальцами для любых двух точек касания, оно будет использовать список {{domxref("TouchEvent.changedTouches","changedTouches")}} в обработчике [`touchmove`](/ru/docs/Web/Events/touchmove) для того, чтобы определить, были ли перемещены эти две точки касания, а затем реализовать семантику этого жеста в свойственной приложению манере.

Когда есть только одна активная точка касания, браузер обычно отправляет эмулированные события и мыши и клика. Мультитач-действия, включающие две и больше активных точек касания, обычно генерируют только события касания. Чтобы предотвратить отправку эмулированных событий мыши, используйте метод {{domxref("Event.preventDefault()","preventDefault()")}} в обработчиках событий касания. Дополнительную информацию о взаимодействии между событиями мыши и событиями касаний можно найти в статье {{domxref("Touch_events.Supporting_both_TouchEvent_and_MouseEvent", "Поддержка TouchEvent и MouseEvent")}}.

## Основные шаги

Этот раздел содержит пример базового использования приведённых выше интерфейсов. Более подробный пример можно найти в статье {{domxref ("Touch_events", "События касаний (тач-события)")}}.

Назначьте обработчик событий для каждого типа события касания.

```js
// Назначение обработчика событий касания
someElement.addEventListener("touchstart", process_touchstart, false);
someElement.addEventListener("touchmove", process_touchmove, false);
someElement.addEventListener("touchcancel", process_touchcancel, false);
someElement.addEventListener("touchend", process_touchend, false);
```

Обработчик события, реализующий семантику жестов приложения

```
// Обработчик touchstart
function process_touchstart(ev) {
  // Используется данные события, чтобы вызвать соответствующие обработчики жестов
  switch (ev.touches.length) {
    case 1: handle_one_touch(ev); break;
    case 2: handle_two_touches(ev); break;
    case 3: handle_three_touches(ev); break;
    default: gesture_not_supported(ev); break;
  }
}
```

Доступ к атрибутам точки касания.

```js
// Создание обработчика события "touchstart"
someElement.addEventListener(
  "touchstart",
  function (ev) {
    // Перебор точек события, которые были активированы
    // для этого элемента и обработка каждого целевого элемента события
    for (var i = 0; i < ev.targetTouches.length; i++) {
      process_target(ev.targetTouches[i].target);
    }
  },
  false,
);
```

Предотвращение эмуляции событий мыши

```js
// Обработчик события "touchmove"
function process_touchmove(ev) {
  // Вызов "preventDefault()"
  ev.preventDefault();
}
```

## Лучшие практики

Вот несколько моментов, которых следует придерживаться при работе с событиями касаний:

- Сводите к минимуму объём работы, выполняемой в обработчиках касаний
- Добавляйте обработчики точек касаний к определённому целевому элементу, а не ко всему документу или узлам, расположенным выше в дереве
- Добавляйте обработчики событий [`touchmove`](/ru/docs/Web/Events/touchmove), [`touchend`](/ru/docs/Web/Events/touchend) и [`touchcancel`](/ru/docs/Web/Events/touchcancel) внутрь [`touchstart`](/ru/docs/Web/Events/touchstart).
- Целевой элемент или узел для события касания должен быть достаточно большим, для касания пальцем. Если целевая область слишком мала, прикосновений к ней может привести к вызову событий для других прилегающих элементов.

## Информация о совместимости с браузерами

Согласно [данным о совместимости с браузерами](/ru/docs/Web/API/Touch_events#Browser_compatibility), поддержка событий касания среди мобильных браузеров относительно неплохая. Десктопные браузеры немного отстают, хотя над этим уже ведётся работа.

Некоторые новые функции, связанные с областью касания (областью контакта между пользователем и сенсорной поверхностью) - находятся в процессе стандартизации. Новый функционал включает в себя радиусы эллипса по осям X и Y, которые наиболее точно описывают область контакта с сенсорной поверхностью. _Угол поворота_ точки касания - градус, на который нужно повернуть упомянутый эллипс, чтобы соответствовать области контакта - также стандартизирован, как и степень давления в точке касания.

## А что насчёт Событий Указателя?

Внедрение новых механизмов ввода усложняет обработку всех возможных событий, таких как события клавиатуры, мыши, пера, касаний. Чтобы помочь решить эту проблему, [стандарт "Pointer Events"](http://www.w3.org/TR/pointerevents/) определяет события и связанные с ними интерфейсы для обработки ввода с таких указывающих устройств, как мышь, перо, сенсорный экран и т.д. То есть, абстрактный _указатель_ создаёт унифицированную модель ввода, которая может представлять точку контакта пальца, пера/стилуса или мыши. Подробнее в MDN-статье [События указателя](/ru/docs/Web/API/Pointer_events).

Модель событий указателя может упростить обработку разных способов ввода, поскольку указатель представляет ввод с любого устройства. В дополнение к этому, типы событий указателя очень похожи на типы событий мыши (например, `pointerdown` `pointerup`), таким образом, код для обработки событий указателя полностью совпадает с кодом обработки ввода с помощью мыши.

Статус реализации событий указателя в браузерах [относительно высок](/ru/docs/), поскольку Chrome, Firefox, IE11 и Edge имеют полные реализации.

## Примеры

Следующие документы описывают, как использовать события касаний и включают код с примерами

- {{domxref("Touch_events","События касаний")}}
- [Реализация кастомных жестов](https://developers.google.com/web/fundamentals/design-and-ui/input/touch/touch-events)
- [Введение в события касаний в JavaScript](http://www.javascriptkit.com/javatutors/touchevents.shtml)
- [Добавление поддержки сенсорных экранов на сайта (простой способ)](http://www.codicode.com/art/easy_way_to_add_touch_support_to_your_website.aspx)

Демонстрация событий касания:

- [Paint Program (by Rick Byers)](https://rbyers.github.io/paint.html)
- [Touch/pointer tests and demos (by Patrick H. Lauke)](http://patrickhlauke.github.io/touch/)

## Сообщество

- [Группа сообщества Событий касания](https://github.com/w3c/touch-events)
- [Mail list](http://lists.w3.org/Archives/Public/public-touchevents/)
- [W3C #touchevents IRC channel](irc://irc.w3.org:6667/)

## Связанные темы и источники

- [Стандарт "Pointer Events"](http://www.w3.org/TR/pointerevents/)
