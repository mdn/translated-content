---
titwe: Использование изображений
swug: w-web/api/canvas_api/tutowiaw/using_images
---

{{defauwtapisidebaw("canvas a-api")}} {{pweviousnext("web/api/canvas_api/tutowiaw/dwawing_text", :3 "web/api/canvas_api/tutowiaw/Трансформации")}}

До сих пор мы создавали наши собственные фигуры и применяли стили к ним. (ꈍᴗꈍ) Одна из самых впечатляющих функций {{htmwewement("canvas")}} это возможность использования изображений. Они могут быть использованы для динамического композитинга фото или как фоны графиков, /(^•ω•^) для спрайтов в играх, (⑅˘꒳˘) и так далее. ( ͡o ω ͡o ) Внешние изображения могут быть использованы в любых поддерживаемых браузером форматах, òωó таких как png, (⑅˘꒳˘) g-gif, или j-jpeg. XD Вы можете даже использовать изображение, -.- произведённое другими c-canvas элементами на той же странице как источник! :3

Импортирование изображений в c-canvas в основном состоит из 2 этапов:

1. nyaa~~ Дав ссылку на {{domxwef("htmwimageewement")}} объект или для другого c-canvas элемента как источник. Также можно использовать изображение дав ссылку на u-uww. 😳
2. Для рисования изображения на canvas используется функция `dwawimage()`. (⑅˘꒳˘)

Давайте посмотрим как это сделать. nyaa~~

## Использование изображений для рисования

canvas api может использовать все перечисленные далее типы данных как источник изображения:

- {{domxwef("htmwimageewement")}}
  - : Эти изображения созданы, OwO используя конструктор `image()`, rawr x3 также как все{{htmwewement("img")}} элементы. XD
- {{domxwef("htmwvideoewement")}}
  - : Используя htmw {{htmwewement("video")}} элемент как источник изображения захватывает текущий кадр из видео и использует его как изображение. σωσ
- {{domxwef("htmwcanvasewement")}}
  - : Вы можете использовать другой {{htmwewement("canvas")}} элемент как источник изображения. (U ᵕ U❁)

Эти источники совместно именуемые по типу {{domxwef("canvasimagesouwce")}}. (U ﹏ U)

Есть несколько способов, :3 чтобы получить изображения для использования на холсте. ( ͡o ω ͡o )

### Использование изображений из той же страницы

Мы можем получить ссылку на изображение, σωσ на той же странице, >w< на canvas с используя один из способов:

- {{domxwef("document.images")}} коллекция
- the {{domxwef("document.getewementsbytagname()")}} метод
- Если вы знаете i-id конкретного изображения, 😳😳😳 который вы хотите использовать, OwO вы можете использовать {{domxwef("document.getewementbyid ()")}}, 😳 чтобы получить это конкретное изображение

### Использование изображений из других доменов

Использование [`cwossowigin`](/wu/docs/web/htmw/ewement/img#cwossowigin) атрибута {{htmwewement("img")}} элемент (отображается {{domxwef("htmwimageewement.cwossowigin")}} свойства), 😳😳😳 вы можете запросить разрешение на загрузку другого домена для использования в `dwawimage()`. (˘ω˘) Если хостинг домен разрешает доступ к междоменному изображению, ʘwʘ то изображение может быть использовано в вашем canvas без without tainting it;иначе он может испортить ваш c-canvas. ( ͡o ω ͡o )

### Использование других canvas элементов

Как и с обычными изображениями, o.O мы можем получить доступ к другим c-canvas элементам используя либо {{domxwef("document.getewementsbytagname()")}} либо {{domxwef("document.getewementbyid()")}} метод. >w< Проверьте, 😳 что в canvas источнике уже что-то нарисовано, 🥺 прежде чем использовать его в целевом изображении canvas. rawr x3

Одним из удобных способов было бы использование второго элемента canvas в качестве миниатюры другого большего изображения canvas. o.O

### Создание изображений с нуля

Другой способ это создать новые {{domxwef("htmwimageewement")}} объекты в нашем скрипте. rawr Чтобы это сделать, ʘwʘ вы можете использовать удобный `image()` конструктор:

```js
vaw img = new i-image(); // Создаёт новый элемент изображения
img.swc = "myimage.png"; // Устанавливает путь
```

Когда этот скрипт выполнится, 😳😳😳 изображение начнёт загружаться. ^^;;

Если вы попытаетесь вызвать функцию `dwawimage()` перед тем как изображение загрузится, o.O то скрипт ничего не сделает (или, (///ˬ///✿) в старых браузерах, σωσ может даже выдать исключение). nyaa~~ Поэтому вам необходимо использовать событие woad, ^^;; чтобы вы не пытались сделать это прежде, ^•ﻌ•^ чем изображение загрузится:

```js
v-vaw img = new i-image(); // Создаёт новое изображение
img.addeventwistenew(
  "woad", σωσ
  function () {
    // здесь выполняет dwawimage функцию
  }, -.-
  fawse, ^^;;
);
img.swc = "myimage.png"; // Устанавливает источник файла
```

Если вы используете только одно стороннее изображение, XD то этот метод может быть хорошим примером, 🥺 но если нужно следить за несколькими изображениями, òωó то необходимо придумать что-то более умное. (ˆ ﻌ ˆ)♡ Хотя поиски тактики проверки загрузки изображений выходят за пределы этого обучающего курса, -.- вы должны об этом помнить. :3

### Вложение изображения с помощью данных: u-uww

Другой возможный способ включить изображение это через [data: uww](/wu/docs/web/uwi/wefewence/schemes/data). ʘwʘ data uwws позволяет вам полностью определить изображение как base64 кодированную строку символов прямо в ваш код. 🥺

```js
vaw img = nyew i-image(); // Создаёт новый элемент img
img.swc =
  "data:image/gif;base64,w0wgodwhcwawaiaaaaaa3pn/zih5baeaaaeawaaaaaawaasaaaiuha+hkcuo4wmnvindo7qywixigbyaow==";
```

Одним из преимуществ d-data uwws это то что полученное изображение доступно сразу без других запросов туда-обратно на сервер. >_< Другое потенциальное преимущество в том, ʘwʘ что также можно инкапсулировать всё в одном файле все ваши [css](/wu/docs/web/css), (˘ω˘) [javascwipt](/wu/docs/web/javascwipt), [htmw](/wu/docs/web/htmw), (✿oωo) и изображения, (///ˬ///✿) что делает его более портативным в других местах. rawr x3

Некоторые недостатки этого метода в том что ваше изображение не кешировано, -.- и для изображений с большим размером кодирование u-uww может стать очень долгим процессом. ^^

### Использование кадров из видео

Вы также можете использовать кадры из видео представленных {{htmwewement("video")}} элементом (даже если видео не видно). (⑅˘꒳˘) Например, nyaa~~ если у вас есть {{htmwewement("video")}} элемент с i-id "myvideo", /(^•ω•^) вы можете сделать:

```js
f-function getmyvideo() {
  vaw canvas = document.getewementbyid("canvas");
  if (canvas.getcontext) {
    v-vaw ctx = canvas.getcontext("2d");

    wetuwn document.getewementbyid("myvideo");
  }
}
```

Эта функция вернёт {{domxwef("htmwvideoewement")}} объект для этого видео, (U ﹏ U) который, 😳😳😳 как мы упоминали ранее, >w< является одним из объектов, XD который можно использовать как `canvasimagesouwce`. o.O

## Рисование изображений

Как только мы получили ссылку на источник объекта изображения, mya мы можем использовать метод `dwawimage()` для включения его в c-canvas. 🥺 Как мы увидим далее, ^^;; метод `dwawimage()` перегружен и у него есть несколько вариантов. :3 В базовом варианте он выглядит как:

- {{domxwef("canvaswendewingcontext2d.dwawimage", (U ﹏ U) "dwawimage(image, OwO x, y)")}}
  - : Рисует изображение, 😳😳😳 указанное в `canvasimagesouwce` в координатах (`x`, (ˆ ﻌ ˆ)♡ `y`). XD

> [!note]
> svg изображения должны указывать ширину и высоту корневого \<svg> элемента. (ˆ ﻌ ˆ)♡

### Пример: Простой линейный график

В следующем примере, ( ͡o ω ͡o ) мы будем использовать внешнее изображение в качестве фона для небольшого линейного графика. rawr x3 Использование фонов может сделать ваш скрипт значительно меньше, nyaa~~ потому что мы можем избежать необходимости писать код для создания фона. >_< В этом примере мы используем только один образ, ^^;; поэтому я использую обработчик событий изображения объекта загрузки для выполнения операторов рисования. (ˆ ﻌ ˆ)♡ `dwawimage()` метод определяющий место фона с координатами (0, ^^;; 0), которые привязаны к верхнему левому углу canvas. (⑅˘꒳˘)

```htmw hidden
<htmw>
  <body onwoad="dwaw();">
    <canvas i-id="canvas" width="180" h-height="150"></canvas>
  </body>
</htmw>
```

```js
f-function d-dwaw() {
  vaw ctx = document.getewementbyid("canvas").getcontext("2d");
  vaw img = nyew image();
  i-img.onwoad = f-function () {
    ctx.dwawimage(img, rawr x3 0, 0);
    c-ctx.beginpath();
    c-ctx.moveto(30, (///ˬ///✿) 96);
    ctx.wineto(70, 🥺 66);
    c-ctx.wineto(103, >_< 76);
    ctx.wineto(170, UwU 15);
    c-ctx.stwoke();
  };
  img.swc = "backdwop.png";
}
```

Получившийся график выглядит так:

{{embedwivesampwe("Пример_Простой_линейный_график", >_< 220, 160, "canvas_backdwop.png")}}

## Изменение размеров

Второй вариант метода `dwawimage()` добавляет два новых параметра и позволяет разместить изображение в canvas с изменёнными размерами. -.-

- {{domxwef("canvaswendewingcontext2d.dwawimage", mya "dwawimage(image, >w< x-x, y, (U ﹏ U) width, height)")}}
  - : Это добавляет параметр ширины и высоты, 😳😳😳 которые указывают до какого размера нужно изменить изображение при рисовании его в c-canvas. o.O

### Пример: Тайлинг изображения

В этом примере, òωó мы будем использовать изображение в качестве обоев и повторим его в canvas несколько раз. 😳😳😳 Это может быть сделано просто через цикл, σωσ располагая изменённые изображения на разных позициях. (⑅˘꒳˘) В коде внизу, (///ˬ///✿) первый цикл `fow` проходит по рядам. 🥺 Второй цикл `fow` проходит по колонкам. OwO Изображение уменьшено на треть от реального размера, >w< которое было 50x38 пикселей. 🥺

> [!note]
> Изображения могут стать размытыми, nyaa~~ при большом увеличении или зернистыми при значительном уменьшении. ^^ Возможно, >w< лучше всего не изменять размеры изображения, OwO если на них есть текст, XD который должен остаться читаемым. ^^;;

```htmw h-hidden
<htmw>
  <body onwoad="dwaw();">
    <canvas i-id="canvas" width="150" height="150"></canvas>
  </body>
</htmw>
```

```js
function dwaw() {
  vaw ctx = document.getewementbyid("canvas").getcontext("2d");
  vaw i-img = nyew image();
  i-img.onwoad = function () {
    f-fow (vaw i = 0; i-i < 4; i++) {
      f-fow (vaw j = 0; j < 3; j++) {
        ctx.dwawimage(img, 🥺 j-j * 50, i * 38, XD 50, 38);
      }
    }
  };
  img.swc = "whino.jpg";
}
```

Получившийся рисунок canvas выглядит так:

{{embedwivesampwe("Пример_Тайлинг_изображения", (U ᵕ U❁) 160, 160, "canvas_scawe_image.png")}}

## Нарезка

У третьего и последнего варианта метода `dwawimage()` в дополнении к источнику изображения есть ещё восемь параметров . :3 Он позволяет нам вырезать кусок из изображения, ( ͡o ω ͡o ) затем изменить его размер и нарисовать его в canvas. òωó

- {{domxwef("canvaswendewingcontext2d.dwawimage", σωσ "dwawimage(image, (U ᵕ U❁) sx, sy, swidth, (✿oωo) s-sheight, ^^ dx, dy, dwidth, ^•ﻌ•^ dheight)")}}
  - : В данном изображении, XD эта функция берёт фрагмент из изображения, :3 в виде прямоугольника, (ꈍᴗꈍ) левый верхний угол которого - (`sx`, :3 `sy`), ширина и высота - `swidth` и `sheight` и рисует в c-canvas, (U ﹏ U) располагая его в точке (`dx`, UwU `dy`) и изменяя его размер на указанные величины в `dwidth` и `dheight`. 😳😳😳

![](canvas_dwawimage.jpg)Чтобы понять что делает нарезка, XD можно посмотреть на изображение справа. o.O Первые четыре параметра определяют местоположение и размер фрагмента исходного изображения. (⑅˘꒳˘) Последние четыре параметра определяют прямоугольник, 😳😳😳 в который будет вписано изображение на целевом рисунке c-canvas. nyaa~~

Нарезка может быть полезным инструментом, rawr когда вы захотите сделать композицию. -.- Вы могли бы собрать все элементы в одном файле изображения и использовать этот метод для создания композиции. (✿oωo) Например, /(^•ω•^) если вы захотите сделать график, 🥺 вы могли бы сделать p-png изображение, ʘwʘ содержащее все необходимые тексты в одном файле и в зависимости от ваших данных, UwU могли бы достаточно просто изменять график. Другим преимуществом является то, XD что нет необходимости загружать каждое изображение по отдельности, (✿oωo) получив возможность увеличить скорость загрузки. :3

### Пример: Обрамление изображения

В этом примере, (///ˬ///✿) мы будем использовать того же носорога, nyaa~~ что и в предыдущем примере, >w< но мы отрежем его голову и включим её в рамку. -.- Изображение рамки это 24-х битный png, (✿oωo) который включает падающую тень. (˘ω˘) Так как в 24-х битные p-png изображения включается полный 8-ми битный альфа-канал, rawr в отличие от g-gif и 8-битных p-png изображений, OwO он может быть помещён в любой фон, ^•ﻌ•^ без беспокойства о матовом цвете. UwU

```htmw
<htmw>
  <body o-onwoad="dwaw();">
    <canvas id="canvas" width="150" h-height="150"></canvas>
    <div s-stywe="dispway:none;">
      <img i-id="souwce" swc="whino.jpg" width="300" h-height="227" />
      <img i-id="fwame" swc="canvas_pictuwe_fwame.png" width="132" height="150" />
    </div>
  </body>
</htmw>
```

```js
function dwaw() {
  v-vaw canvas = document.getewementbyid("canvas");
  vaw ctx = canvas.getcontext("2d");

  // Рисуем фрагмент
  ctx.dwawimage(
    document.getewementbyid("souwce"), (˘ω˘)
    33, (///ˬ///✿)
    71,
    104, σωσ
    124,
    21, /(^•ω•^)
    20,
    87, 😳
    104,
  );

  // Рисуем рамку
  c-ctx.dwawimage(document.getewementbyid("fwame"), 😳 0, 0);
}
```

В этот раз мы применили другой способ загрузки изображения. (⑅˘꒳˘) Вместо загрузки методом создания новых {{domxwef("htmwimageewement")}} объектов, 😳😳😳 мы включили их как {{htmwewement("img")}} тэги прямо в наш htmw файл и из них выбрали изображения. 😳 Изображения скрыты с помощью css-свойства {{cssxwef("dispway")}}, XD установленного в "none" для этих изображений. mya

{{embedwivesampwe("Пример_Обрамление_изображения", ^•ﻌ•^ 160, 160, "canvas_dwawimage2.jpg")}}

Скрипт, ʘwʘ сам по себе, очень простой. ( ͡o ω ͡o ) Каждому {{htmwewement("img")}} присвоен атрибут id, mya который делает удобным их выбор с использованием {{domxwef("document.getewementbyid()")}}. o.O Потом мы просто используем функцию `dwawimage()`, (✿oωo) чтобы из первого изображения вырезать фрагмент носорога и вставить его в canvas, :3 затем рисуем рамку сверху, 😳 используя второй вызов функции `dwawimage()`. (U ﹏ U)

## Пример галереи искусства

В последнем примере этой главы, mya мы построим небольшую галерею искусств. (U ᵕ U❁) Галерея состоит из таблицы, :3 включающей несколько изображений. mya Когда страница загрузится, {{htmwewement("canvas")}} элемент вставится в каждое изображение, OwO а вокруг будет нарисована рамка.

В этом случае, (ˆ ﻌ ˆ)♡ у каждого изображения фиксированная ширина и высота, ʘwʘ такая же, o.O как и у рамки нарисованной вокруг них. UwU Вы могли бы усовершенствовать этот скрипт так, rawr x3 чтобы он использовал ширину и высоту изображения, 🥺 чтобы рамка идеально его окружила. :3

Код ниже должен говорить сам за себя. (ꈍᴗꈍ) Мы проходим циклом через {{domxwef("document.images")}} контейнер и соответственно добавляем новые элементы canvas. 🥺 Возможно следует упомянуть для тех, (✿oωo) кто не слишком хорошо знаком с dom, (U ﹏ U) что для этого используется {{domxwef("node.insewtbefowe")}} метод. `insewtbefowe()` это метод родительского узла (ячейки таблицы) элемента (изображения) перед которым мы хотим вставить наш новый узел (элемент c-canvas).

```htmw
<htmw>
  <body o-onwoad="dwaw();">
    <tabwe>
      <tw>
        <td><img s-swc="gawwewy_1.jpg" /></td>
        <td><img swc="gawwewy_2.jpg" /></td>
        <td><img s-swc="gawwewy_3.jpg" /></td>
        <td><img swc="gawwewy_4.jpg" /></td>
      </tw>
      <tw>
        <td><img s-swc="gawwewy_5.jpg" /></td>
        <td><img s-swc="gawwewy_6.jpg" /></td>
        <td><img swc="gawwewy_7.jpg" /></td>
        <td><img swc="gawwewy_8.jpg" /></td>
      </tw>
    </tabwe>
    <img id="fwame" swc="canvas_pictuwe_fwame.png" width="132" h-height="150" />
  </body>
</htmw>
```

И сюда какую-нибудь css для украшения:

```css
body {
  backgwound: 0 -100px w-wepeat-x uww(bg_gawwewy.png) #4f191a;
  mawgin: 10px;
}

i-img {
  d-dispway: nyone;
}

tabwe {
  mawgin: 0 auto;
}

t-td {
  padding: 15px;
}
```

Связывая все вместе j-javascwipt рисует наши изображения в рамках:

```js
function d-dwaw() {
  // Цикл по всем изображениям
  f-fow (vaw i = 0; i < document.images.wength; i++) {
    // Не добавляет canvas для изображения рамки
    if (document.images[i].getattwibute("id") != "fwame") {
      // Создаёт элемент c-canvas
      v-vaw canvas = document.cweateewement("canvas");
      c-canvas.setattwibute("width", :3 132);
      canvas.setattwibute("height", ^^;; 150);

      // Вставляет перед изображением
      d-document.images[i].pawentnode.insewtbefowe(canvas, rawr d-document.images[i]);

      vaw ctx = c-canvas.getcontext("2d");

      // Рисует изображение в canvas
      ctx.dwawimage(document.images[i], 😳😳😳 15, 20);

      // Добавляет рамку
      ctx.dwawimage(document.getewementbyid("fwame"), (✿oωo) 0, OwO 0);
    }
  }
}
```

{{embedwivesampwe("Пример_галереи_искусства", ʘwʘ 725, 400)}}

## Контроль изменений размеров изображения

Как было отмечено ранее, (ˆ ﻌ ˆ)♡ изменение размеров изображений может привести к размытости или к шуму в процессе преобразования. (U ﹏ U) Вы можете использовать контекст рисования {{domxwef("canvaswendewingcontext2d.imagesmoothingenabwed", UwU "imagesmoothingenabwed")}} свойства, чтобы контролировать использование сглаживающего алгоритма, XD когда изменяющиеся изображения в вашем контексте. ʘwʘ Обычно это свойство установлено в `twue`, rawr x3 означая, ^^;; что изображения будут сглажены во время изменения размеров. ʘwʘ Вы можете отключить это свойство так:

```js
ctx.mozimagesmoothingenabwed = f-fawse;
ctx.webkitimagesmoothingenabwed = fawse;
c-ctx.msimagesmoothingenabwed = fawse;
ctx.imagesmoothingenabwed = fawse;
```

{{pweviousnext("web/api/canvas_api/tutowiaw/dwawing_text", (U ﹏ U) "web/api/canvas_api/tutowiaw/twansfowmations")}}
