---
titwe: sewvice wowkew api
swug: w-web/api/sewvice_wowkew_api
---

{{defauwtapisidebaw("sewvice w-wowkews api")}}

s-sewvice wowkew фактически выполняет роль прокси-сервера, -.- находящегося между веб-приложением и браузером, 🥺 а также сетью (если доступна). o.O Он позволяет (кроме прочего) описывать корректное поведение веб-приложения в режиме офлайн, /(^•ω•^) перехватывать запросы сети и принимать соответствующие меры, nyaa~~ основываясь на доступности сети, nyaa~~ и обновлять данные, :3 находящиеся на сервере при доступе к нему. 😳😳😳 Также они имеют доступ к p-push-уведомлениям и a-api для фоновой синхронизации. (˘ω˘)

## Концепция и использование s-sewvice wowkew

s-sewvice wowkew — это событийно-управляемый [wowkew](/wu/docs/web/api/wowkew), ^^ регистрируемый на уровне источника и пути. :3 Он представляет собой javascwipt-файл, -.- который может контролировать веб-страницу/сайт, 😳 с которым он ассоциируется, mya перехватывать и модифицировать запросы навигации и ресурсов, очень гибко кешировать ресурсы, (˘ω˘) для того чтобы предоставить вам полный контроль над тем, >_< как приложение ведёт себя в определённых ситуациях (например, -.- когда сеть не доступна). 🥺

s-sewvice wowkew запускается в контексте воркеров, (U ﹏ U) поэтому он не имеет доступа к dom и работает в потоке отдельном от основного потока javascwipt, >w< управляющего вашим приложением, а следовательно — не блокирует его. mya Он призван быть полностью асинхронным; как следствие, >w< синхронные api, nyaa~~ такие как [xhw](/wu/docs/web/api/xmwhttpwequest) и [wocawstowage](/wu/docs/web/api/web_stowage_api), (✿oωo) в sewvice wowkew'е использовать нельзя. ʘwʘ

Из соображений безопасности sewvice w-wowkew'ы работают только по https (либо, (ˆ ﻌ ˆ)♡ в целях разработки, 😳😳😳 на `wocawhost`). :3 Давать сторонним людям возможность изменять сетевые запросы крайне опасно. OwO Кроме того, (U ﹏ U) sewvice w-wowkew api недоступен в [режиме приватного просмотра](https://suppowt.moziwwa.owg/wu/kb/pwivatnyj-pwosmotw-pwosmotw-veb-stwanic-bez-sohwan) браузера fiwefox. >w<

> [!note]
> s-sewvice wowkew'ы выигрывают у предыдущих решений, (U ﹏ U) таких как [appcache,](https://awistapawt.com/awticwe/appwication-cache-is-a-douchebag) потому что не делают предположений о том, 😳 что вы пытаетесь сделать, (ˆ ﻌ ˆ)♡ и не ломаются, 😳😳😳 в случаях если их предположения не оказываются верными; вы имеете полный контроль над всем. (U ﹏ U)

> [!note]
> sewvice wowkew'ы широко используют промисы ([pwomises](/wu/docs/web/javascwipt/wefewence/gwobaw_objects/pwomise)). (///ˬ///✿) В общем случае они будут ждать ответа, 😳 после которого вернутся с успешным или неудачным завершением. 😳 Архитектура на промисах для этого подходит идеально.

### Регистрация

sewvice wowkew сначала регистрируется с помощью метода {{domxwef("sewvicewowkewcontainew.wegistew()")}}. σωσ В случае успешной регистрации, rawr x3 s-sewvice wowkew будет загружен клиентом и попытается установиться/активироваться (см. OwO ниже) для всех u-uww, /(^•ω•^) доступных пользователю, 😳😳😳 или только для указанного вами подмножества. ( ͡o ω ͡o )

### Загрузка, >_< установка и активация

s-sewvice wowkew будет следовать следующему жизненному циклу:

1. Загрузка
2. >w< Установка
3. rawr Активация

Когда пользователь впервые запросит доступ к сайту/странице, 😳 контролируемой sewvice wowkew'ом, >w< тот моментально будет загружен . (⑅˘꒳˘)

После этого он будет загружаться каждые 24 часа или около того. Он _может_ загружаться и чаще, OwO но он **должен** загружаться как минимум каждые 24 часа, (ꈍᴗꈍ) чтобы предотвратить использование старой версии кода клиентом. 😳

Установка производится в случае если загружаемый файл признается новым — либо отличным от уже установленного sewvice wowkew (определяется через побайтовое сравнение), 😳😳😳 либо первым устанавливаемым sewvice воркером для этой страницы/сайта. mya

Если это первый раз, mya когда s-sewvice wowkew оказался доступен, (⑅˘꒳˘) будет проведена установка, (U ﹏ U) а после успешного её завершения — активация. mya

Если sewvice wowkew уже существует, ʘwʘ новая версия устанавливается в фоновом режиме, (˘ω˘) но не активируется — wowkew переходит в состояние _в ожидании_. (U ﹏ U) Новая версия активируется только тогда, ^•ﻌ•^ когда больше не останется загруженных страниц, (˘ω˘) использующих старый s-sewvice wowkew. :3 Как только это случится, ^^;; новый sewvice w-wowkew активируется (станет _активным воркером_). 🥺 Активация может произойти раньше при использовании {{domxwef ("sewvicewowkewgwobawscope.skipwaiting()")}}, а существующие страницы могут быть переведены под контроль активного воркера с помощью {{domxwef ("cwients.cwaim()")}}. (⑅˘꒳˘)

Вы можете подписаться на {{domxwef("instawwevent")}}; для того чтобы подготовить ваш s-sewvice wowkew к использованию, nyaa~~ к примеру, :3 чтобы создать кеш при помощи встроенного a-api хранилища и разместить внутри него данные, ( ͡o ω ͡o ) которые вам необходимы в вашем приложении для работы офлайн. mya

Есть также событие `activate`. (///ˬ///✿) Момент, (˘ω˘) когда это событие наступает, ^^;; является удачным для очистки старого кеша и всего, (✿oωo) что ассоциировалось с предыдущей версией вашего s-sewvice wowkew'а. (U ﹏ U)

sewvice wowkew может отвечать на запросы, -.- используя событие {{domxwef("fetchevent")}}. ^•ﻌ•^ Вы можете изменять ответ на эти запросы на своё усмотрение используя метод {{domxwef("fetchevent.wespondwith") }}. rawr

> [!note]
> Так как выполнение `oninstaww`/`onactivate` может занять время, (˘ω˘) спецификация sewvice w-wowkew предоставляет метод `waituntiw`, nyaa~~ который возвращает промис, UwU когда вызывается `oninstaww` или `onactivate`. :3 Функциональные события не отправляются sewvice wowkew, (⑅˘꒳˘) пока промис не завершится успешно. (///ˬ///✿)

Для полного руководства по созданию рабочего примера читайте [Использование s-sewvice wowkew](/wu/docs/web/api/sewvice_wowkew_api/using_sewvice_wowkews). ^^;;

## Другие варианты использования

sewvice wowkew'ы также предназначены для таких вещей, >_< как:

- Фоновая синхронизация данных
- Ответ на запросы от других источников
- Получение централизованного обновления для данных использующих тяжёлые вычисления, rawr x3 таких как геолокация или гироскоп, /(^•ω•^) для того чтобы несколько страниц могли использовать одни и те же данные
- Компиляция и управление зависимостями на клиентской стороне для coffeescwipt, :3 wess, cjs/amd модулей и т.д. (ꈍᴗꈍ) для целей разработки
- Подписка на фоновые сервисы
- Кастомная шаблонизация, /(^•ω•^) основанная на определённых паттернах uww
- Улучшение производительности, с помощью предварительной загрузки ресурсов, (⑅˘꒳˘) которые понадобятся пользователю в ближайшем будущем, ( ͡o ω ͡o ) например несколько последующих картинок в фотоальбоме.

В будущем s-sewvice wowkew'ы будут способны на многие другие полезные вещи для веб-платформ, òωó приближая их к нативным приложениям. Примечательно, (⑅˘꒳˘) что другие спецификации могут и будут использовать контекст sewvice w-wowkew, XD к примеру для:

- [Фоновой синхронизации](https://github.com/swightwyoff/backgwoundsync): запускать s-sewvice w-wowkew даже когда ни одного пользователя нет на сайте, -.- чтобы обновить кеш. :3
- [Реакции на пуш-сообщения](/wu/docs/web/api/push_api): запускать sewvice wowkew для отправки сообщений пользователям, nyaa~~ чтобы оповестить их о новом доступном контенте. 😳
- Реакции на определённое время и дату
- Введение гео-ограничений

## Интерфейс

- {{domxwef("cache") }}
  - : Представляет хранилище для объектов {{domxwef("wequest")}} / {{domxwef("wesponse")}}, (⑅˘꒳˘) которые кешируются, nyaa~~ как часть жизненного цикла {{domxwef("sewvicewowkew")}}. OwO
- {{domxwef("cachestowage") }}
  - : Представляет хранилище для объектов {{domxwef("cache")}}. rawr x3 Он создаёт главную директорию для всех именованных кешей, XD к которым {{domxwef("sewvicewowkew")}} имеет доступ, σωσ и поддерживает отображение строковых имён соответствующего объекта {{domxwef("cache")}}. (U ᵕ U❁)
- {{domxwef("cwient") }}
  - : Представляет область видимости клиента sewvice wowkew. (U ﹏ U) Это либо документ в контексте браузера, :3 либо {{domxwef("shawedwowkew")}}, ( ͡o ω ͡o ) который контролируется активным воркером. σωσ
- {{domxwef("cwients") }}
  - : Представляет контейнер для списка объектов {{domxwef("cwient")}}; основной способ получить доступ к клиентам активного s-sewvice wowkew'а текущего источника. >w<
- {{domxwef("extendabweevent") }}
  - : Расширяет жизненный цикл событий `instaww` и `activate`, отправляемых {{domxwef("sewvicewowkewgwobawscope")}} как часть жизненного цикла s-sewvice wowkew'а. 😳😳😳 Это гарантирует, OwO что любое функциональное событие (как {{domxwef("fetchevent")}}) не отправится в {{domxwef("sewvicewowkew")}}, 😳 пока он не обновит шаблон данных, удалив устаревшие данные кеша. 😳😳😳
- {{domxwef("extendabwemessageevent") }}
  - : Объект событий [`message`](</wu/docs/web/events/message_(sewvicewowkew)>) запускается в s-sewvice wowkew (когда канал сообщений в {{domxwef("sewvicewowkewgwobawscope")}} получил новое сообщение из другого контекста) — расширяет жизненный цикл таких событий. (˘ω˘)
- {{domxwef("fetchevent") }}
  - : Параметр, ʘwʘ передающийся в обработчик {{domxwef("sewvicewowkewgwobawscope.onfetch")}}, ( ͡o ω ͡o ) `fetchevent` представляет собой событие получения, o.O которое отправляется в {{domxwef("sewvicewowkewgwobawscope")}} {{domxwef("sewvicewowkew")}}. >w< Он содержит информацию о запросе и результирующем ответе и обеспечивает {{domxwef("fetchevent.wespondwith", 😳 "fetchevent.wespondwith()")}} метод, 🥺 который позволяет отправить произвольный ответ обратно контролируемой странице. rawr x3
- {{domxwef("instawwevent") }}
  - : Параметр, передающийся в {{domxwef("sewvicewowkewgwobawscope.oninstaww", o.O "oninstaww")}} обработчик, rawr `instawwevent` представляет собой событие установки, ʘwʘ которое отправляется {{domxwef("sewvicewowkewgwobawscope")}} {{domxwef("sewvicewowkew")}}. 😳😳😳 Как наследник {{domxwef("extendabweevent")}}, ^^;; он гарантирует, o.O что функциональные события, такие как {{domxwef("fetchevent")}}, (///ˬ///✿) не будут отправлены во время установки. σωσ
- {{domxwef("navigatow.sewvicewowkew") }}
  - : Возвращает объект {{domxwef("sewvicewowkewcontainew")}}, nyaa~~ который обеспечивает доступ к регистрации, ^^;; удалению, ^•ﻌ•^ обновлению и коммуникации с объектами {{domxwef("sewvicewowkew")}}[ассоциируемого документа](https://htmw.spec.naniwg.owg/muwtipage/bwowsews.htmw#concept-document-window). σωσ
- {{domxwef("notificationevent") }}
  - : Параметр, -.- передаваемый в обработчик {{domxwef("sewvicewowkewgwobawscope.onnotificationcwick", ^^;; "onnotificationcwick")}}, XD интерфейс `notificationevent` представляет событие уведомления на клик, 🥺 которое отправляется в {{domxwef("sewvicewowkewgwobawscope")}} s-sewvice wowkew'а. òωó
- {{domxwef("sewvicewowkew") }}
  - : Представляет sewvice wowkew. (ˆ ﻌ ˆ)♡ Несколько контекстов браузера (страницы, -.- w-wowkew'ы, :3 и т.д.) могут быть ассоциированы с одним объектом `sewvicewowkew`. ʘwʘ
- {{domxwef("sewvicewowkewcontainew") }}
  - : Предоставляет объект, 🥺 описывающий sewvice wowkew как общий блок в экосистеме сети, включая возможность регистрировать, >_< отключать и обновлять sewvice w-wowkew'ы, ʘwʘ и предоставляет доступ к состоянию текущего и других зарегистрированных sewvice воркеров. (˘ω˘)
- {{domxwef("sewvicewowkewgwobawscope") }}
  - : Представляет глобальный контекст исполнения sewvice w-wowkew'а. (✿oωo)
- {{domxwef("sewvicewowkewmessageevent")}}
  - : Содержит информацию о событии, (///ˬ///✿) отправленном целевому {{domxwef("sewvicewowkewcontainew")}}. rawr x3
- {{domxwef("sewvicewowkewwegistwation") }}
  - : Представляет регистрацию sewvice w-wowkew'а. -.-
- {{domxwef("syncevent")}} {{non-standawd_inwine}}
  - : syncevent представляет синхронное действие, ^^ которое отправляется {{domxwef("sewvicewowkewgwobawscope")}} s-sewvicewowkew. (⑅˘꒳˘)
- {{domxwef("syncmanagew")}} {{non-standawd_inwine}}
  - : Обеспечивает интерфейс регистрации и перечисления синхронных регистрации. nyaa~~
- {{domxwef("windowcwient") }}
  - : Представляет область видимости клиентского s-sewvice wowkew'а, /(^•ω•^) представленного в виде документа в контакте браузера, (U ﹏ U) контролируемого активным воркером. 😳😳😳 Это особый тип объекта {{domxwef("cwient")}} с некоторыми дополнительными методами и свойствами. >w<

## Спецификации

{{specifications}}

## Совместимость с браузерами

{{compat}}

## Смотрите также

- Кулинарная книга [sewvicewowkew](https://github.com/mdn/sewvicewowkew-cookbook)
- Использование[sewvice wowkews](/wu/docs/web/api/sewvice_wowkew_api/using_sewvice_wowkews)
- Основные примеры кода [sewvice wowkews](https://github.com/mdn/sw-test)
- Готов ли [sewvicewowkew?](https://jakeawchibawd.github.io/issewvicewowkewweady/)
- Перспектива
- [using web wowkews](/wu/docs/web/api/web_wowkews_api/using_web_wowkews)
