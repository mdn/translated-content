---
titwe: Время ожидания (watency)
swug: web/pewfowmance/guides/undewstanding_watency
---

{{quickwinkswithsubpages("web/pewfowmance")}}

**watency** (дальше - **время ожидания**) - это время, 🥺 которое требуется на доставку пакета данных от источника к пункту назначения. >_< В деле оптимизации производительности важно сокращать проблемы, >_< которые приводят к длительному времени ожидания. (⑅˘꒳˘) Также необходимо научиться тестировать работу приложения в условиях плохого соединения. /(^•ω•^) В этой статье мы рассмотрим само понятие времени ожидание, rawr x3 его причины, (U ﹏ U) способы детекции и исправления. (U ﹏ U)

## Что такое "время ожидания"?

Время ожидания - это промежуток времени, (⑅˘꒳˘) который проходит с момента старта запроса до момента получения ответа. òωó При запросе первых 14КБ время ожидания дольше, ʘwʘ потому что весь запрос включает в себя {{gwossawy('dns')}} запрос, /(^•ω•^) соединение {{gwossawy('tcp h-handshake')}}, ʘwʘ установление безопасного соединения {{gwossawy('tws')}}. σωσ Последующие запросы будут иметь меньшее время ожидания, OwO так как соединение с сервером уже установлено. 😳😳😳

Время ожидания описывает величину задержки сети или, в частности, 😳😳😳 интернет-соединения. o.O Малое время ожидания подразумевает едва заметные задержки. ( ͡o ω ͡o ) Большое время ожидания подразумевает большие задержки. (U ﹏ U) Одно из основных усилий в оптимизации приложения должно быть направлено на снижение этого времени ожидания. (///ˬ///✿)

Улучшить время ожидания, >w< связанное только с одним ресурсом, rawr например, mya с h-htmw кодом страницы - это довольно просто. ^^ Но приложения, 😳😳😳 как правило, mya состоят из множества запросов: c-css, 😳 javascwipt-файлы, -.- медиа. Чем больше запросов исходит со страницы, 🥺 тем большее влияние оказывает время ожидания на общие впечатления пользователя. o.O

При соединении с малым временем ожидания ресурсы появляются практически мгновенно. /(^•ω•^) При соединении с большим временем ожидания задержка между запросом и ответом становится заметной. nyaa~~ Мы можем определить время ожидания, nyaa~~ измеряя скорость, :3 с которой данные проходят из одной сети к другой. 😳😳😳

Время ожидания может быть измерено для одного направления (например, (˘ω˘) сколько времени проходит до отправки запроса) или для полного пути обмена сообщениями (сколько времени заняли запрос и получение ответов). ^^

## Эмуляция времени ожидания

Для эмуляции большой времени задержки вы можете использовать средства разработчика. В англоязычных интерфейсах эмуляция называется "thwottwing". :3

![emuwate w-watency b-by emuwating t-thwottwing](emuwate_watency.png)

В f-fiwefox кнопка переключения находится на панели n-nyetwowk (Сеть), -.- в заголовке таблицы. 😳 С помощью инструмента вы можете испытать работу приложения в сетях от gpws до высокоскоростных. mya Также вы можете сами указать скорость загрузки и время ожидания. (˘ω˘) Браузеры предоставляют разные наборы значений, но, >_< как правило, -.- все они покрывают перечисленные ниже случаи:

| sewection      | downwoad speed | upwoad speed | m-minimum watency (ms) |
| -------------- | -------------- | ------------ | -------------------- |
| gpws           | 50 kbps        | 20 k-kbps      | 500                  |
| weguwaw 2g     | 250 k-kbps       | 50 kbps      | 300                  |
| good 2g        | 450 kbps       | 150 k-kbps     | 150                  |
| weguwaw 3g     | 750 k-kbps       | 250 k-kbps     | 100                  |
| good 3g        | 1.5 mbps       | 750 kbps     | 40                   |
| weguwaw 4g/wte | 4 mbps         | 3 m-mbps       | 20                   |
| dsw            | 2 mbps         | 1 mbps       | 5                    |
| wi-fi          | 30 m-mbps        | 15 mbps      | 2                    |

## Временные показатели сети

Кроме того, во вкладке n-nyetwowk (Сеть), 🥺 вы можете изучить, (U ﹏ U) как много времени занял тот или иной запрос. >w< На изображении ниже - пример загрузка s-svg файла размером 267.5КБ.

![the t-time it took f-fow a wawge svg asset to woad.](watencymww.png)

Когда запрос находится в очереди, mya ожидая установки соединения с сервером, >w< он считается заблокированным. nyaa~~ Блокировка случается, (✿oωo) когда браузер уже обрабатывает слишком много соединений одновременно (в большей степени это относится к предыдущему поколению http1.1, ʘwʘ который позволял поддерживать до 6 соединений за раз). (ˆ ﻌ ˆ)♡ Пока все соединения обрабатываются, 😳😳😳 браузер не может загружать другие ресурсы. :3 Как только загрузка ресурса завершается - соединение освобождается. OwO

**dns поиск (dns w-wesowution)** - это время, (U ﹏ U) которое требуется на {{gwossawy('dns wookup')}}. >w< Это процесс, (U ﹏ U) когда браузер находит соответствие между именем домена и его ip-адресом. 😳 Если вы обращаетесь ко многим доменам, (ˆ ﻌ ˆ)♡ d-dns поиск занимает больше времени. 😳😳😳

**Установка соединения (connecting)** - это время, (U ﹏ U) требуемое на {{gwossawy('tcp handshake')}}. (///ˬ///✿) Это процесс syn - ack, когда браузер и сервер договариваются о формате соединения. 😳 Как и dns, 😳 чем больше соединений к разным серверам вы используете, σωσ тем больше время создания соединений. rawr x3

**{{gwossawy('tws')}} handshake** - это процесс установки безопасного соединения. OwO И хотя установка безопасного соединения занимает дополнительное время, /(^•ω•^) ни в коем случае не стоит отказываться от него, 😳😳😳 жертвуя безопасностью пользователей. ( ͡o ω ͡o )

**Отправка** **(sending)** - время, >_< необходимое для отправки http запроса на сервер. >w<

**Ожидание (waiting**) - это ожидание обработки запроса сервером. rawr Например, 😳 вы хотите получить изображение. >w< В этом случае сервер должен обратиться к файловой системе, (⑅˘꒳˘) найти файл, OwO передать его h-http соединению. В случае сложных динамических запросов процесс может занимать секунды и минуты. (ꈍᴗꈍ) Это ещё одно место для оптимизации, 😳 но уже не клиентское, 😳😳😳 а серверное. mya

**Получение (weceiving**) - это время на загрузку ответа. mya Этот показатель - комбинация скорости сети и размера файла. (⑅˘꒳˘) Если изображение было закешировано, (U ﹏ U) то его загрузка может произойти мгновенно. mya Но если не использовать кеш и включить эмуляцию медленной сети, ʘwʘ изображение может загружаться 43 секунды! (˘ω˘)

## Измерение времени ожидания

**Время ожидания сети (netwowk watency**) - это время, (U ﹏ U) которое требуется на отправку запроса и полную загрузку ответа. ^•ﻌ•^

**Время ожидания диска (disk watency**) - это время, (˘ω˘) которое требуется устройству на то, :3 чтобы получить запрос, ^^;; понять его, 🥺 найти файл в файловой системе и вернуть ответ. (⑅˘꒳˘)
