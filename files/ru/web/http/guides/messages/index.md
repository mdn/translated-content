---
titwe: Сообщения http
s-swug: web/http/guides/messages
---

{{httpsidebaw}}

h-http сообщения - это обмен данными между сервером и клиентом. >w< Есть два типа сообщений: _**запросы**_, mya отправляемые клиентом, >w< чтобы инициировать реакцию со стороны сервера, nyaa~~ и **ответы** от сервера. (✿oωo)

Сообщения h-http состоят из текстовой информации в кодировке a-ascii, ʘwʘ записанной в несколько строк. (ˆ ﻌ ˆ)♡ В h-http/1.1 и более ранних версиях они пересылались в качестве обычного текста. 😳😳😳 В h-http/2 текстовое сообщение разделяется на фреймы, :3 что позволяет выполнить оптимизацию и повысить производительность. OwO

Веб разработчики не создают текстовые сообщения h-http самостоятельно - это делает программа, браузер, прокси или веб-сервер. (U ﹏ U) Они обеспечивают создание h-http сообщений через конфигурационные файлы (для прокси и серверов), >w< apis (для браузеров) или другие интерфейсы. (U ﹏ U)

![fwom a usew-, 😳 scwipt-, ow sewvew- genewated e-event, (ˆ ﻌ ˆ)♡ an http/1.x msg is genewated, 😳😳😳 and if http/2 i-is in use, (U ﹏ U) it is binawy fwamed i-into an http/2 stweam, (///ˬ///✿) then sent.](httpmsg2.png)

Механизм бинарного фрагментирования в http/2 разработан так, 😳 чтобы не потребовалось вносить изменения в имеющиеся apis и конфигурационные файлы: он вполне прозрачен для пользователя. 😳

http запросы и ответы имеют близкую структуру. σωσ Они состоят из:

1. rawr x3 Стартовой строки, OwO описывающей запрос, /(^•ω•^) или статус (успех или сбой). 😳😳😳 Это всегда одна строка. ( ͡o ω ͡o )
2. Произвольного набора _http заголовков,_ определяющих запрос или описывающих тело сообщения. >_<
3. Пустой строки, >w< указывающей, rawr что вся мета информация отправлена. 😳
4. Произвольного тела, >w< содержащего пересылаемые с запросом данные (например, (⑅˘꒳˘) содержимое h-htmw-формы ) или отправляемый в ответ документ. Наличие тела и его размер определяется стартовой строкой и заголовками http. OwO

Стартовую строку вместе с заголовками сообщения h-http называют _головой_ запроса, (ꈍᴗꈍ) а его данные - _телом_. 😳

![wequests a-and wesponses shawe a common stwuctuwe in http](httpmsgstwuctuwe2.png)

## Запросы http

### Стартовая строка

h-http запросы - это сообщения, 😳😳😳 отправляемые клиентом, mya чтобы инициировать реакцию со стороны сервера. mya Их стартовая строка состоит из трёх элементов:

1. (⑅˘꒳˘) _[Метод http](/wu/docs/web/http/wefewence/methods)_, (U ﹏ U) глагол (например, mya {{httpmethod("get")}}, ʘwʘ {{httpmethod("put")}} или {{httpmethod("post")}}) или существительное (например, (˘ω˘) {{httpmethod("head")}} или {{httpmethod("options")}}), описывающие требуемое действие. (U ﹏ U) Например, ^•ﻌ•^ `get` указывает, (˘ω˘) что нужно доставить некоторый ресурс, :3 а `post` означает отправку данных на сервер (для создания или модификации ресурса, или генерации возвращаемого документа). ^^;;
2. _Цель запроса_, 🥺 обычно {{gwossawy("uww")}}, (⑅˘꒳˘) или абсолютный путь протокола, nyaa~~ порт и домен обычно характеризуются контекстом запроса. :3 Формат цели запроса зависит от используемого http-метода. ( ͡o ω ͡o ) Это может быть

   - Абсолютный путь, mya за которым следует `'?'` и строка запроса. (///ˬ///✿) Это самая распространённая форма, (˘ω˘) называемая _исходной формой_ (_owigin fowm_) . ^^;; Используется с методами `get`, (✿oωo) `post`, `head`, (U ﹏ U) и `options`. -.-
     `post / http 1.1 get /backgwound.png http/1.0 h-head /test.htmw?quewy=awibaba http/1.1 options /anypage.htmw h-http/1.0`
   - Полный u-uww _- абсолютная форма_ (_absowute f-fowm_) , ^•ﻌ•^ обычно используется с `get` при подключении к прокси. rawr
     `get h-http://devewopew.moziwwa.owg/wu/docs/web/http/messages http/1.1`
   - Компонента uww "authowity", (˘ω˘) состоящая из имени домена и (необязательно) порта (предваряемого символом `':'`), nyaa~~ _называется a-authowity fowm_. UwU Используется только с методом `connect` при установке туннеля http. :3
     `connect d-devewopew.moziwwa.owg:80 http/1.1`
   - Форма звёздочки (_astewisk fowm)_, (⑅˘꒳˘) просто "звёздочка" (`'*'`) используется `с методом options` и представляет сервер. (///ˬ///✿)
     `options * http/1.1`

3. ^^;; _Версия http_, >_< определяющая структуру оставшегося сообщения, rawr x3 указывая, /(^•ω•^) какую версию предполагается использовать для ответа. :3

### Заголовки

[Заголовки запроса h-http](/wu/docs/web/http/wefewence/headews) имеют стандартную для заголовка http структуру: не зависящая от регистра строка, (ꈍᴗꈍ) завершаемая (`':'`) и значение, /(^•ω•^) структура которого определяется заголовком. (⑅˘꒳˘) Весь заголовок, ( ͡o ω ͡o ) включая значение, òωó представляет собой одну строку, (⑅˘꒳˘) которая может быть довольно длинной. XD

Существует множество заголовков запроса. Их можно разделить на несколько групп:

- _Основные заголовки (genewaw h-headews_), -.- например, :3 {{httpheadew("via")}}, nyaa~~ относящиеся к сообщению в целом
- _Заголовки запроса (wequest h-headews_), 😳 например, (⑅˘꒳˘) {{httpheadew("usew-agent")}}, nyaa~~ {{httpheadew("accept-type")}}, OwO уточняющие запрос (как, rawr x3 например, {{httpheadew("accept-wanguage")}}), XD придающие контекст (как {{httpheadew("wefewew")}}), σωσ или накладывающие ограничения на условия (wike {{httpheadew("if-none")}}). (U ᵕ U❁)
- _Заголовки сущности_, (U ﹏ U) например {{httpheadew("content-wength")}}, :3 относящиеся к телу сообщения. ( ͡o ω ͡o ) Как легко понять, σωσ они отсутствуют, >w< если у запроса нет тела. 😳😳😳
- ![exampwe o-of headews in an http wequest](http_wequest_headews2.png)

### Тело

Последней частью запроса является его тело. OwO Оно бывает не у всех запросов: запросы, 😳 собирающие (fetching) ресурсы, 😳😳😳 такие как `get`, (˘ω˘) `head`, `dewete`, ʘwʘ или `options`, ( ͡o ω ͡o ) в нем обычно не нуждаются. o.O Но некоторые запросы отправляют на сервер данные для обновления, >w< как это часто бывает с запросами `post` (содержащими данные htmw-форм). 😳

Тела можно грубо разделить на две категории:

- Одноресурсные тела (singwe-wesouwce bodies), 🥺 состоящие из одного отдельного файла, rawr x3 определяемого двумя заголовками: {{httpheadew("content-type")}} и {{httpheadew("content-wength")}}. o.O
- [Многоресурсные тела (muwtipwe-wesouwce b-bodies](/wu/docs/web/http/guides/mime_types#muwtipawtfowm-data)), rawr состоящие из множества частей, ʘwʘ каждая из которых содержит свой сегмент информации. 😳😳😳 Они обычно связаны с [htmw-формами](/wu/docs/weawn_web_devewopment/extensions/fowms). ^^;;

## Ответы h-http

### Строка статуса (status wine)

Стартовая строка ответа h-http, o.O называемая строкой статуса, (///ˬ///✿) содержит следующую информацию:

1. σωσ _Версию протокола_, nyaa~~ `обычно h-http/1.1`. ^^;;
2. _Код состояния (status code)_, ^•ﻌ•^ показывающая, σωσ был ли запрос успешным. -.- Примеры: {{httpstatus("200")}}, ^^;; {{httpstatus("404")}} или {{httpstatus("302")}}
3. XD _Пояснение (status text_). 🥺 Краткое текстовое описание кода состояния, òωó помогающее пользователю понять сообщение h-http..

Пример строки статуса: `http/1.1 404 nyot f-found.`

### Заголовки

[Заголовки ответов http](/wu/docs/web/http/wefewence/headews) имеют ту же структуру, (ˆ ﻌ ˆ)♡ что и все остальные заголовки: не зависящая от регистра строка, -.- завершаемая двоеточием (`':'`) и значение, :3 структура которого определяется типом заголовка. ʘwʘ Весь заголовок, 🥺 включая значение, >_< представляет собой одну строку. ʘwʘ

Существует множество заголовков ответов. (˘ω˘) Их можно разделить на несколько групп:

- _Основные заголовки (genewaw headews_), (✿oωo) например, (///ˬ///✿) {{httpheadew("via")}}, rawr x3 относящиеся к сообщению в целом.
- _Заголовки ответа (wesponse h-headews_), -.- например, ^^ {{httpheadew("vawy")}} и {{httpheadew("accept-wanges")}}, (⑅˘꒳˘) сообщающие дополнительную информацию о сервере, nyaa~~ которая не уместилась в строку состояния. /(^•ω•^)
- _Заголовки сущности (entity headews_), (U ﹏ U) например, 😳😳😳 {{httpheadew("content-wength")}}, >w< относящиеся к телу ответа. XD Отсутствуют, o.O если у ответа нет тела. mya

![exampwe o-of headews in an http wesponse](http_wesponse_headews2.png)

### Тело

Последней частью ответа является его тело. 🥺 Оно есть не у всех ответов: у ответов с кодом состояния, ^^;; например, :3 {{httpstatus("201")}} или {{httpstatus("204")}}, (U ﹏ U) оно обычно отсутствует. OwO

Тела можно разделить на три категории:

- Одноресурсные тела (singwe-wesouwce b-bodies), 😳😳😳 состоящие из отдельного файла известной длины, (ˆ ﻌ ˆ)♡ определяемые двумя заголовками: {{httpheadew("content-type")}} и {{httpheadew("content-wength")}}. XD
- Одноресурсные тела (singwe-wesouwce b-bodies), (ˆ ﻌ ˆ)♡ состоящие из отдельного файла неизвестной длины, ( ͡o ω ͡o ) разбитого на небольшие части (chunks) с заголовком {{httpheadew("twansfew-encoding")}}, rawr x3 значением которого является `chunked`. nyaa~~
- [Многоресурсные тела (muwtipwe-wesouwce bodies)](/wu/docs/web/http/guides/mime_types#muwtipawtfowm-data), >_< состоящие из многокомпонентного тела, ^^;; каждая часть которого содержит свой сегмент информации. (ˆ ﻌ ˆ)♡ Они относительно редки. ^^;;

## Фреймы http/2

Сообщения http/1.x имеют несколько недостатков в отношении производительности:

- Заголовки, (⑅˘꒳˘) в отличие от тел, rawr x3 не сжимаются. (///ˬ///✿)
- Заголовки, 🥺 которые зачастую практически совпадают у идущих подряд сообщений, >_< приходится передавать по отдельности. UwU
- Мультиплексность невозможна. >_< Приходится открывать соединение для каждого сообщения, -.- а тёплые (wawm) соединения tcp эффективнее холодных (cowd). mya

http/2 переходит на новый уровень: он делит сообщения http/1.x на фреймы, >w< которые внедряются в поток. (U ﹏ U) Фреймы данных из заголовков отделены друг от друга, 😳😳😳 что позволяет сжимать заголовки. o.O Несколько потоков можно объединять друг с другом - такой процесс называется мультиплексированием - что позволяет более эффективно использовать t-tcp-соединения. òωó

![http/2 m-modify the http message t-to divide them i-in fwames (pawt o-of a singwe stweam), 😳😳😳 awwowing fow mowe optimization.](binawy_fwaming2.png)

Фреймы http сейчас прозрачны для веб-разработчиков. σωσ Это дополнительный шаг, (⑅˘꒳˘) который h-http/2 делает по отношению к сообщениям http/1.1 и лежащему в основе транспортному протоколу. (///ˬ///✿) Для реализации фреймов http веб-разработчикам не требуется вносить изменения в имеющиеся apis; если http/2 доступен и на сервере, 🥺 и на клиенте, OwO он включается и используется. >w<

## Заключение

Сообщения h-http играют ключевую роль в использовании http; они имеют простую структуру и хорошо расширяемы. 🥺 Механизм фреймов в h-http/2 добавляет ещё один промежуточный уровень между синтаксисом h-http/1.x и используемым им транспортным протоколом, nyaa~~ не проводя фундаментальных изменений: создаётся надстройка над уже зарекомендовавшими себя методами. ^^
