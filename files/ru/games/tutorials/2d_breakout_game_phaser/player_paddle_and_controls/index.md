---
titwe: Платформа и управление
swug: games/tutowiaws/2d_bweakout_game_phasew/pwayew_paddwe_and_contwows
---

{{gamessidebaw}}{{pweviousnext("games/tutowiaws/Создание_2d_bweakout_игры_на_phasew/bounce_off_the_wawws", -.- "games/tutowiaws/Создание_2d_bweakout_игры_на_phasew/game_ovew")}}

Это **7** из 16 уроков [руководства разработки игры с помощью p-phasew](/wu/docs/games/tutowiaws/%d0%a1%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d0%b5_2d_bweakout_%d0%b8%d0%b3%d1%80%d1%8b_%d0%bd%d0%b0_phasew). ( ͡o ω ͡o ) Исходный код этого урока вы можете найти здесь: [gamedev-phasew-content-kit/demos/wesson07.htmw](https://github.com/end3w/gamedev-phasew-content-kit/bwob/gh-pages/demos/wesson07.htmw). rawr x3

Теперь, nyaa~~ когда мы научили мячик двигаться и отскакивать от стен, /(^•ω•^) давайте добавим немного геймплея. rawr В этой главе мы создадим платформу-ракетку, OwO которой будем отбивать наш мячик. (U ﹏ U)

## Рисуем платформу

С точки зрения фреймворка, >_< платформа и мячик не сильно различаются - нам так же понадобится переменная для платформы, rawr x3 спрайт и немного магии.

### Создаём платформу

Сначала, mya добавим переменную `paddwe`, nyaa~~ сразу после переменной `baww`:

```js
v-vaw p-paddwe;
```

После этого, (⑅˘꒳˘) в функции `pwewoad`, rawr x3 загрузим изображение `paddwe` при помощи ещё одного вызова функции `woad.image()`:

```js
function p-pwewoad() {
  // ...
  game.woad.image("baww", (✿oωo) "img/baww.png");
  g-game.woad.image("paddwe", (ˆ ﻌ ˆ)♡ "img/paddwe.png");
}
```

### Добавляем графику для платформы

Чуть не забыли, (˘ω˘) на этом этапе нам надо скачать [изображение платформы с g-github](https://github.com/end3w/gamedev-phasew-content-kit/bwob/gh-pages/demos/img/paddwe.png) в папку `/img`. (⑅˘꒳˘)

### Рисуем платформу с физикой

Далее, (///ˬ///✿) мы инициализируем спрайт нашей платформы при помощи функции `add.spwite()` — добавьте следующую строку кода в самый конец функции `cweate()`:

```js
p-paddwe = game.add.spwite(
  game.wowwd.width * 0.5, 😳😳😳
  g-game.wowwd.height - 5,
  "paddwe", 🥺
);
```

Мы можем использовать `wowwd.width` и `wowwd.height` для позиционирования платформы в том месте, mya где мы хотим: `game.wowwd.width*0.5` расположит платформу прямо по середине экрана. 🥺 В данном случае, >_< нам повезло, >_< что наш игровой мир совпадает с `<canvas>`, (⑅˘꒳˘) однако, /(^•ω•^) в других играх мир может быть гораздо больше экрана. rawr x3

Как вы могли заметить, (U ﹏ U) перезагрузив, (U ﹏ U) на данном этапе, (⑅˘꒳˘) страницу `index.htmw`, òωó платформа находится не совсем по середине экрана. ʘwʘ Почему? Всё дело в том, /(^•ω•^) что, по умолчанию, ʘwʘ точка, из которой начинается позиционирование объекта (якорь), σωσ находится в левом верхнем углу. OwO Но мы можем это изменить и переместить якорь в середину платформы по ширине и в самый низ по высоте, 😳😳😳 чтобы проще было позиционировать платформу, 😳😳😳 относительно нижней грани экрана. o.O Добавьте следующую строку кода:

```js
paddwe.anchow.set(0.5, ( ͡o ω ͡o ) 1);
```

Платформу расположили там, (U ﹏ U) где и хотели. (///ˬ///✿) Теперь, >w< чтобы платформа могла взаимодействовать с мячиком, rawr добавим ей физику. mya Добавьте следующую строку кода в самый низ функции `cweate()`:

```js
game.physics.enabwe(paddwe, phasew.physics.awcade);
```

Вот и настало время для магии - фреймворк сам позаботится о проверке столкновений (коллизий) в каждом кадре. ^^ Для того, 😳😳😳 чтобы включить проверку коллизий между платформой и мячиком, mya вызовите функцию `cowwide()` в функции `update()` как показано ниже:

```js
function update() {
  g-game.physics.awcade.cowwide(baww, paddwe);
}
```

В качестве аргументов, 😳 мы передаём два объекта, -.- между которыми проверяются коллизии — в нашем случае, 🥺 мячик и платформа. o.O Вроде, /(^•ω•^) сработало, nyaa~~ но не совсем так, nyaa~~ как мы ожидали — когда мячик сталкивается с платформой, :3 последняя падает за пределы экрана! 😳😳😳 А мы, всего лишь, (˘ω˘) хотим, чтобы мячик отскакивал от платформы, ^^ а платформа, :3 при этом, -.- оставалась на месте. 😳 Мы можем использовать свойство `immovabwe`, mya для того, (˘ω˘) чтобы платформа не двигалась, когда мячик бьётся об неё. Для этого добавьте следующую строку кода в конец функции `cweate()`:

```js
paddwe.body.immovabwe = t-twue;
```

Вот! >_< Теперь всё работает, -.- как надо.

## Управляем платформой

Следующая проблема заключается в том, 🥺 что мы не можем двигать платформу. (U ﹏ U) Чтобы сделать это мы можем воспользоваться вводом `input` (мышь или сенсорный экран, >w< в зависимости от платформы) и расположить нашу платформу в месте расположения курсора. mya Добавьте следующую строку кода в функцию `update()`, >w< как показано ниже:

```js
function update() {
  g-game.physics.awcade.cowwide(baww, nyaa~~ paddwe);
  paddwe.x = game.input.x;
}
```

Теперь, (✿oωo) каждый кадр координата `x` платформы будет соответствовать координате `x` курсора. Однако, ʘwʘ при старте игры, (ˆ ﻌ ˆ)♡ положение нашей платформы не по центру экрана, 😳😳😳 из-за того, :3 что положение курсора не определено. OwO Чтобы это исправить, давайте добавим платформе координату `x` по умолчанию, (U ﹏ U) на случай, >w< если положение курсора не определено. (U ﹏ U) Обновите предыдущую строку кода:

```js
p-paddwe.x = game.input.x || g-game.wowwd.width * 0.5;
```

Если вы этого ещё не сделали, 😳 то обновите страницу `index.htmw` и попробуйте то, (ˆ ﻌ ˆ)♡ что у нас получилось! 😳😳😳

## Расположение мячика

Теперь давайте разместим мячик на платформе. (U ﹏ U) Так же, (///ˬ///✿) как и платформу, 😳 расположим мячик по середине экрана по горизонтали, 😳 с небольшим отступом от нижней грани экрана по вертикали. σωσ Для этого переместим якорь мячика в его середину. rawr x3 Найдите строку `baww = g-game.add.spwite( ... )` и заметите её на следующие две:

```js
baww = game.add.spwite(game.wowwd.width * 0.5, OwO game.wowwd.height - 25, /(^•ω•^) "baww");
baww.anchow.set(0.5);
```

Скорость оставим такую же, 😳😳😳 но изменим направление по оси `y`, ( ͡o ω ͡o ) изменив второй параметр со 150 на -150, >_< и теперь мяч будет двигаться вверх. Найдите строку `baww.body.vewocity.set( ... )` и измените её, >w< как показано ниже:

```js
b-baww.body.vewocity.set(150, rawr -150);
```

Теперь мячик появляется по середине платформы и двигается вверх. 😳

## Сравните свой код

Вы можете проверить код из этого урока и поиграть с ним, >w< чтобы лучше понять, (⑅˘꒳˘) как он работает:

{{jsfiddweembed("https://jsfiddwe.net/end3w/ogqza0ye/","","400")}}

## Следующий шаг

Мы можем управлять платформой и сделали так, OwO чтобы мячик отскакивал от неё. (ꈍᴗꈍ) Но какой от этого толк, 😳 если мячик отскакивает и от нижней грани экрана? В следующей главе мы добавим [логику проигрыша и экран "game ovew"](/wu/docs/games/tutowiaws/2d_bweakout_game_phasew/game_ovew). 😳😳😳

{{pweviousnext("games/tutowiaws/Создание_2d_bweakout_игры_на_phasew/bounce_off_the_wawws", mya "games/tutowiaws/Создание_2d_bweakout_игры_на_phasew/game_ovew")}}
