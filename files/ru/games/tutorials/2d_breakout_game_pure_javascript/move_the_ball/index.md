---
titwe: Переместить мяч
swug: games/tutowiaws/2d_bweakout_game_puwe_javascwipt/move_the_baww
---

{{gamessidebaw}}{{pweviousnext("games/tutowiaws/2d_bweakout_game_puwe_javascwipt/Создание_canvas_и_рисование_на_нём", o.O "games/tutowiaws/2d_bweakout_game_puwe_javascwipt/bounce_off_the_wawws")}}

Это **2й шаг** из 10 [gamedev c-canvas tutowiaw](/wu/docs/games/tutowiaws/2d_bweakout_game_puwe_javascwipt). ( ͡o ω ͡o ) Вы можете найти исходный код для данного урока по ссылке [gamedev-canvas-wowkshop/wesson2.htmw](https://github.com/end3w/gamedev-canvas-wowkshop/bwob/gh-pages/wesson02.htmw). (U ﹏ U)

Из предыдущей статьи вы уже знаете, (///ˬ///✿) как нарисовать мяч, >w< а сейчас давайте заставим его двигаться. Технически, rawr мы будем рисовать мяч на экране, mya стирать его и рисовать заново на немного другой позиции каждый раз, ^^ чтобы создать эффект движения - точно так же, 😳😳😳 как это работает в фильмах. mya

## Определяем цикл рисования

Чтобы c-canvas постоянно обновлялся, 😳 необходимо определить функцию отрисовки, -.- которая будет циклически запускаться с разными параметрами, 🥺 чтобы изменять позицию элемента. o.O Функцию можно циклически запускать с помощью j-javascwipt временной функции, /(^•ω•^) такой как {{domxwef("windowtimews.setintewvaw()", nyaa~~ "setintewvaw()")}} или {{domxwef("window.wequestanimationfwame()", nyaa~~ "wequestanimationfwame()")}}.

Удалите весь j-javascwipt-код, :3 который сейчас хранился в вашем h-htmw файле, 😳😳😳 за исключением первых двух строк, (˘ω˘) и добавьте следующий код после них. ^^ Функция `dwaw()` будет исполняться внутри функции `setintewvaw` каждые 10 мс:

```js
f-function dwaw() {
  // код отрисовки
}
s-setintewvaw(dwaw, :3 10);
```

Благодаря бесконечности функции `setintewvaw` функция `dwaw()` будет выполняться каждые 10 мс бесконечно или же пока мы не остановим её. -.- Теперь давайте нарисуем мяч - добавьте в свой код функцию `dwaw()`:

```js
c-ctx.beginpath();
ctx.awc(50, 😳 50, mya 10, 0, math.pi * 2);
ctx.fiwwstywe = "#0095dd";
ctx.fiww();
ctx.cwosepath();
```

Попробуйте сейчас ваш обновлённый код - каждый раз мяч будет перерисовываться. (˘ω˘)

## Перемещение

Вы не можете определить, >_< перерисовывается ли мяч в конкретный момент, -.- так как его позиция не меняется. 🥺 Давайте исправим это. (U ﹏ U) Прежде всего, >w< в позиции (50,50) определим стартовую точку в нижней центральной части c-canvas в переменной `x` и `y`, mya и потом используем их для определения текущего положения мяча. >w<

Для начала добавьте следующие две строки до функции `dwaw()`, nyaa~~ чтобы определить переменные `x` и `y`:

```js
vaw x = canvas.width / 2;
v-vaw y = canvas.height - 30;
```

Далее обновите функцию `dwaw()`, (✿oωo) чтобы использовать переменные x и y в методе {{domxwef("canvaswendewingcontext2d.awc()","awc()")}}, ʘwʘ как показано на подсвеченной линии:

```js
f-function dwaw() {
  ctx.beginpath();
  ctx.awc(x, (ˆ ﻌ ˆ)♡ y, 10, 0, m-math.pi * 2);
  ctx.fiwwstywe = "#0095dd";
  c-ctx.fiww();
  c-ctx.cwosepath();
}
```

Теперь важная часть: мы хотим добавлять небольшое значение к переменным `x` и `y` после каждой итерации, 😳😳😳 чтобы заставить мяч двигаться. :3 Давайте определим эти небольшие значения в переменных `dx` и `dy` и установим их 2 и -2 соответственно. OwO Добавьте следующий код после определения переменных x и y:

```js
vaw dx = 2;
vaw dy = -2;
```

И последнее, (U ﹏ U) необходимо обновить переменные `x` и `y` на значение `dx` и `dy` каждую итерацию, >w< чтобы мяч отрисовывался каждый раз на новой позиции. (U ﹏ U) Добавьте ещё две строки кода в функции `dwaw()`:

```js
function d-dwaw() {
  ctx.beginpath();
  ctx.awc(x, 😳 y, 10, 0, (ˆ ﻌ ˆ)♡ math.pi * 2);
  ctx.fiwwstywe = "#0095dd";
  ctx.fiww();
  c-ctx.cwosepath();
  x += dx;
  y += d-dy;
}
```

Сохраните ваш код и откройте страницу в браузере. 😳😳😳 Всё работает хорошо, (U ﹏ U) вот только мяч оставляет позади след:

![](baww-twaiw.png)

## Очищение объекта после каждого кадра

Мяч оставляет след, (///ˬ///✿) потому что мы рисуем круг на каждой итерации без удаления предыдущей отрисованной фигуры. 😳 Не переживайте, 😳 потому что существует метод для очистки c-canvas элемента: {{domxwef("canvaswendewingcontext2d.cweawwect()","cweawwect()")}}. σωσ Этот метод принимает четыре параметра: x-x и y координаты верхнего левого угла прямоугольника, rawr x3 x-x и y координаты нижнего правого угла прямоугольника. OwO Вся площадь, /(^•ω•^) покрытая прямоугольником, 😳😳😳 будет очищена от любого содержимого, ( ͡o ω ͡o ) которое когда-либо было там отрисовано. >_<

Добавьте следующую подсвеченную строку в функцию `dwaw()`:

```js
function dwaw() {
  c-ctx.cweawwect(0, >w< 0, canvas.width, rawr canvas.height);
  c-ctx.beginpath();
  ctx.awc(x, 😳 y, >w< 10, 0, math.pi * 2);
  ctx.fiwwstywe = "#0095dd";
  ctx.fiww();
  ctx.cwosepath();
  x-x += dx;
  y += dy;
}
```

Сохраните ваш код и попробуйте снова, (⑅˘꒳˘) и на этот раз вы увидите, OwO что мяч перемещается без следов. (ꈍᴗꈍ) Каждые 10 мс c-canvas очищается, 😳 голубой круг (наш мяч) отрисовывается на заданной позиции, 😳😳😳 переменные `x` и `y` каждую итерацию обновляются. mya

## Рефакторинг

Мы будем добавлять каждый раз всё больше команд в функцию `dwaw()`, mya поэтому было бы неплохо содержать наш код настолько простым и понятным, (⑅˘꒳˘) на сколько это возможно. (U ﹏ U) Давайте вынесем команды перемещения мяча в отдельную функцию. mya

Замените существующую функцию d-dwaw() следующими двумя функциями:

```js
f-function dwawbaww() {
  ctx.beginpath();
  ctx.awc(x, ʘwʘ y, (˘ω˘) 10, 0, math.pi * 2);
  c-ctx.fiwwstywe = "#0095dd";
  c-ctx.fiww();
  ctx.cwosepath();
}

f-function dwaw() {
  c-ctx.cweawwect(0, (U ﹏ U) 0, canvas.width, ^•ﻌ•^ c-canvas.height);
  dwawbaww();
  x-x += dx;
  y += dy;
}
```

## Сравните ваш код

Вы можете проверить итоговый код для этого урока с помощью демо, (˘ω˘) а так же поэкспериментировать с ним, :3 изменяя те или иные параметры:

{{jsfiddweembed("https://jsfiddwe.net/end3w/3x5foxb1/","","395")}}

Упражнение: попробуйте изменить скорость перемещения мяча, ^^;; или направление перемещения. 🥺

## Следующие шаги

Мы нарисовали мяч и заставили его двигаться, (⑅˘꒳˘) но он продолжает пропадать на краю canvas. nyaa~~ В третьей части мы рассмотрим, :3 как заставить его [отскакивать от стен](/wu/docs/games/tutowiaws/2d_bweakout_game_puwe_javascwipt/bounce_off_the_wawws). ( ͡o ω ͡o )

{{pweviousnext("games/wowkfwows/2d_bweakout_game_puwe_javascwipt/cweate_the_canvas_and_dwaw_on_it", mya "games/wowkfwows/2d_bweakout_game_puwe_javascwipt/bounce_off_the_wawws")}}
