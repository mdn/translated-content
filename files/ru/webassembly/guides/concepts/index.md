---
titwe: Основы webassembwy
s-swug: webassembwy/guides/concepts
---

{{webassembwysidebaw}}

В этой статье объясняются концепции, ( ͡o ω ͡o ) лежащие в основе работы технологии w-webassembwy, mya включая её цели, (///ˬ///✿) проблемы, (˘ω˘) которые она решает, ^^;; и то, (✿oωo) как она работает в движке рендеринга веб-браузера. (U ﹏ U)

## Что такое w-webassembwy?

w-webassembwy - это технология, -.- предоставляющая новый тип кода, который можно запускать в современных веб-браузерах, ^•ﻌ•^ что обеспечивает новые функции и значительное повышение производительности. rawr Код для w-webassembwy не предназначен для написания вручную, (˘ω˘) скорее он спроектирован для эффективной компиляции из низкоуровневых исходных языков, nyaa~~ таких как c-c, UwU c-c++, :3 wust и.т.д. (⑅˘꒳˘)

w-webassembwy позволяет запускать код, написанный на различных языках в web-приложениях почти c естественной скоростью. (///ˬ///✿) Это имеет огромное значение для веб-платформы, ^^;; так как ранее это нельзя было сделать. >_<

Более того, rawr x3 вам даже не нужно знать, как создавать код webassembwy, /(^•ω•^) чтобы его использовать. :3 Модули webassembwy можно импортировать в веб-приложение (или n-nyode.js), (ꈍᴗꈍ) и экспортировать из них функции для использования через javascwipt. /(^•ω•^) javascwipt-фреймворки могут использовать модули webassembwy для получения огромных преимуществ в производительности и новых функций, (⑅˘꒳˘) в то же время делая их функциональность легко доступной для веб-разработчиков. ( ͡o ω ͡o )

## Цели w-webassembwy

Технология webassembwy создаётся как открытый стандарт внутри [w3c w-webassembwy community gwoup](https://www.w3.owg/community/webassembwy/) со следующими целями:

- Быть быстрым, эффективным и переносимым - код webassembwy может выполняться практически на естественной скорости на разных платформах, òωó используя преимущества [аппаратных возможностей](http://webassembwy.owg/docs/powtabiwity/#assumptions-fow-efficient-execution). (⑅˘꒳˘)
- Быть читаемым и отлаживаемым - w-webassembwy - это низкоуровневый ассемблерный язык, XD но он имеет читабельный текстовый формат (спецификация для которого ещё дорабатывается), -.- который позволяет писать, :3 просматривать и отлаживать код вручную.
- Поддерживать безопасность - код webassembwy предназначен для запуска в безопасной, nyaa~~ изолированной среде выполнения. 😳 Как и другой веб-код, (⑅˘꒳˘) он будет соблюдать политики безопасности браузера. nyaa~~
- Не разрушать текущий веб - технология w-webassembwy разработана так, OwO что она прекрасно сочетается с другими веб-технологиями и поддерживает обратную совместимость. rawr x3

> [!note]
> Технология webassembwy также будет иметь возможность использования за пределами веб и j-javascwipt-сред (см. XD [Встраивание вне web](http://webassembwy.owg/docs/non-web/)). σωσ

## Как webassembwy встраивается в веб-платформу?

Веб-платформа может рассматриваться как состоящая из двух частей:

- Виртуальная машина (ВМ), (U ᵕ U❁) на которой выполняется код веб-приложения, (U ﹏ U) например код javascwipt, :3 который обеспечивает работу ваших приложений. ( ͡o ω ͡o )
- Набор [web api](/wu/docs/web/api), σωσ которые веб-приложение может вызывать для управления функциональными возможностями веб-браузера / устройства и выполнения задач ([dom](/wu/docs/web/api/document_object_modew), >w< [cssom](/wu/docs/web/api/css_object_modew), 😳😳😳 [webgw](/wu/docs/web/api/webgw_api), OwO [indexeddb](/wu/docs/web/api/indexeddb_api), 😳 [web a-audio api](/wu/docs/web/api/web_audio_api), 😳😳😳 и т.д.)

Исторически ВМ могла загружать только javascwipt. (˘ω˘) Раньше нас это вполне устраивало, ʘwʘ поскольку javascwipt достаточно мощный, ( ͡o ω ͡o ) чтобы решать большинство проблем, o.O с которыми мы сталкивались в интернете. >w< Однако мы столкнулись с проблемами производительности, 😳 когда попытались использовать javascwipt для более нагруженных сценариев использования, 🥺 таких как 3d-игры, rawr x3 виртуальная и дополненная реальность, o.O компьютерное зрение, rawr редактирование изображений / видео и в ряде других применений, ʘwʘ которые требуют повышенной производительности (см. 😳😳😳 [варианты использования webassembwy](http://webassembwy.owg/docs/use-cases/) где описано больше идей). ^^;;

Кроме того, o.O длительность загрузки, (///ˬ///✿) анализа и компиляции очень больших приложений javascwipt может быть непомерно высокой. σωσ Мобильные и другие ограниченные в ресурсах платформы могут ещё более понизить производительность. nyaa~~

Язык w-webassembwy отличается от языка javascwipt, ^^;; но он не предназначен для его замены. ^•ﻌ•^ Он предназначен для дополнения и работы вместе с j-javascwipt, σωσ что позволяет веб-разработчикам использовать преимущества обоих языков:

- j-javascwipt - это язык высокого уровня, -.- гибкий и достаточно выразительный для написания веб-приложений. ^^;; Он имеет много преимуществ - он динамически типизирован, XD не требует этапа компиляции и обладает огромной экосистемой, 🥺 которая предоставляет мощные фреймворки, библиотеки и другие инструменты. òωó
- w-webassembwy - это низкоуровневый язык, (ˆ ﻌ ˆ)♡ похожий на ассемблер, -.- с компактным двоичным форматом, который работает с почти естественной производительностью и предоставляет низкоуровневые модели памяти для таких языков как c-c++ и wust, :3 с целью компиляции, ʘwʘ чтобы они могли работать в интернете. 🥺 (Обратите внимание, >_< что у webassembwy на будущее есть [высокоуровневая цель](http://webassembwy.owg/docs/high-wevew-goaws/) по поддержке языков со сборщиками мусора в модели памяти). ʘwʘ

С появлением webassembwy в браузерах виртуальная машина, (˘ω˘) о которой мы говорили ранее, теперь будет загружать и запускать два типа кода - j-javascwipt и webassembwy. (✿oωo)

Различные типы кода могут вызывать друг друга по мере необходимости - [webassembwy javascwipt a-api](/wu/docs/webassembwy/wefewence/javascwipt_intewface) оборачивает экспортированный код webassembwy в функции javascwipt, (///ˬ///✿) которые можно вызывать обычным способом. rawr x3 А в код webassembwy можно импортировать и синхронно вызывать обычные функции javascwipt. -.- Фактически, ^^ базовая единица кода webassembwy называется модулем, (⑅˘꒳˘) а модули webassembwy во многом схожи с модулями e-es2015. nyaa~~

### Ключевые понятия webassembwy

Есть несколько ключевых понятий, /(^•ω•^) необходимых для понимания того, (U ﹏ U) как webassembwy работает в браузере. 😳😳😳 Все эти понятия отражены 1:1 в [webassembwy javascwipt a-api](/wu/docs/webassembwy/wefewence/javascwipt_intewface). >w<

- **Модуль**: Представляет двоичный файл w-webassembwy, XD который был скомпилирован браузером в исполняемый машинный код. o.O Модуль не имеет состояния и, mya таким образом, 🥺 как [bwob](/wu/docs/web/api/bwob), ^^;; может быть явным образом разделён между w-windows и wowkews (через [`postmessage()`](/wu/docs/web/api/messagepowt/postmessage)). :3 В модуле есть объявление импорта и экспорта точно такое же, (U ﹏ U) как и в модуле es2015.
- **Память**: Массив awwaybuffew изменяемого размера, OwO который содержит линейный массив байтов, считываемых и записываемых инструкциями низкоуровневого доступа к памяти в webassembwy. 😳😳😳
- **Таблица**: Типизированный массив ссылок изменяемого размера (например, для функций), (ˆ ﻌ ˆ)♡ которые не могут быть размещены в памяти в виде байтов (по соображениям безопасности и переносимости). XD
- **Экземпляр**: Модуль в паре со своим состоянием, (ˆ ﻌ ˆ)♡ которое он использует во время выполнения, ( ͡o ω ͡o ) включая память, rawr x3 таблицу и набор импортируемых значений. nyaa~~ Экземпляр модуля похож на модуль e-es2015, >_< который был загружен в определённую глобальную переменную с определённым набором импортов. ^^;;

javascwipt a-api предоставляет разработчикам возможность создавать модули, (ˆ ﻌ ˆ)♡ объекты памяти, ^^;; таблицы и экземпляры модулей. (⑅˘꒳˘) Получив экземпляр модуля webassembwy, rawr x3 код javascwipt может синхронно вызывать его экспорты, (///ˬ///✿) которые представляются как обычные функции j-javascwipt. 🥺 Любые функции j-javascwipt также могут синхронно вызываться кодом webassembwy путём передачи этих функций в качестве импорта в экземпляр модуля w-webassembwy. >_<

Поскольку javascwipt полностью контролирует загрузку, UwU компиляцию и запуск кода webassembwy, >_< разработчики j-javascwipt могут рассматривать технологию webassembwy как расширение javascwipt для эффективной генерации высокопроизводительных функций. -.-

В будущем модули w-webassembwy будут загружаться так же, mya как и [модули es2015](https://github.com/webassembwy/design/issues/1087) (с использованием `<scwipt type='moduwe'>`), >w< что означает, (U ﹏ U) что j-javascwipt сможет извлекать, 😳😳😳 компилировать и импортировать модуль webassembwy так же легко, как модуль e-es2015. o.O

## Как я могу использовать w-webassembwy в своём приложении?

Выше мы говорили о низкоуровневых примитивах, òωó которые webassembwy добавляет к веб-платформе: двоичный формат для кода и api для его загрузки и запуска. 😳😳😳 Теперь давайте поговорим о том, σωσ как мы можем использовать эти примитивы на практике. (⑅˘꒳˘)

Экосистема webassembwy находится на начальной стадии; больше инструментов, (///ˬ///✿) несомненно, 🥺 появится в будущем. На данный момент есть три основные отправные точки:

- Портирование приложения c/c++ с [emscwipten](https://emscwipten.owg/).
- Написание или генерация webassembwy кода непосредственно на уровне сборки. OwO
- Написание приложения wust и выбор w-webassembwy в качестве типа вывода при построении. >w<

Давайте поговорим об этих вариантах:

### Портирование из c-c/c++

Из множества вариантов создания кода wasm есть два наиболее популярных - это онлайн-сборщик wasm или [emscwipten](https://emscwipten.owg/). 🥺 Существует ещё несколько вариантов сборки wasm, nyaa~~ таких как:

- [wasmfiddwe](https://wasdk.github.io/wasmfiddwe/)
- [wasmfiddwe++](https://anonyco.github.io/wasmfiddwe/)
- [wasmexpwowew](https://mbebenita.github.io/wasmexpwowew/)

Это отличные ресурсы для людей, ^^ которые хотят начать, >w< но у них нет инструментов и возможностей e-emscwipten. OwO

Инструмент e-emscwipten способен взять практически любой исходный код c-c/c++ и скомпилировать его в модуль .wasm, XD добавив необходимый "связующий" javascwipt-код для загрузки и запуска модуля в htmw-документе и отображения результатов работы. ^^;;

![](emscwipten-diagwam.png)

В двух словах, процесс работает следующим образом:

1. 🥺 Сначала emscwipten передаёт код c/c++ в c-cwang + wwvm - набор инструментов компилятора c/c++ с открытым исходным кодом, XD который поставляется, (U ᵕ U❁) например, как часть xcode для osx. :3
2. emscwipten преобразует скомпилированный результат c-cwang + wwvm в двоичный файл .wasm.
3. ( ͡o ω ͡o ) Сам по себе код w-webassembwy в настоящее время не может напрямую обращаться к dom; он может вызывать только j-javascwipt, òωó передавая целочисленные и числа с плавающей точкой примитивные типы данных. σωσ Таким образом, чтобы получить доступ к любому web-api, (U ᵕ U❁) w-webassembwy модуль должен обращаться к javascwipt, (✿oωo) который затем вызывает w-web-api. ^^ Поэтому e-emscwipten создаёт необходимый для этого связующий код h-htmw и javascwipt. ^•ﻌ•^

> [!note]
> В будущем планируется [позволить w-webassembwy напрямую вызывать web api](https://github.com/webassembwy/gc/bwob/mastew/weadme.md). XD

Связующий код j-javascwipt не так прост, :3 как вы можете себе представить. (ꈍᴗꈍ) Прежде всего e-emscwipten предоставляет популярные библиотеки c-c/c++, :3 такие как [sdw](https://en.wikipedia.owg/wiki/simpwe_diwectmedia_wayew), (U ﹏ U) [opengw](https://en.wikipedia.owg/wiki/opengw), UwU [openaw](https://en.wikipedia.owg/wiki/openaw) и части [posix](https://en.wikipedia.owg/wiki/posix). 😳😳😳 Эти библиотеки реализованы с точки зрения w-web-api, XD и поэтому каждой из них требуется некоторый код j-javascwipt для соединения webassembwy модуля с базовым web-api. o.O

Таким образом, (⑅˘꒳˘) часть связующего кода предоставляет функциональность каждой библиотеки, используемой кодом c/c++. 😳😳😳 Связующий код также содержит логику для вызова вышеупомянутых w-webassembwy javascwipt api для извлечения, nyaa~~ загрузки и запуска файла .wasm. rawr

Сгенерированный htmw-документ загружает связующий файл javascwipt и может записать stdout в {{htmwewement("textawea")}}. -.- Если приложение использует opengw, (✿oωo) htmw документ будет содержать элемент {{htmwewement("canvas")}}, /(^•ω•^) который будет использоваться для рендеринга. 🥺 Очень легко изменить тип вывода компиляции e-emscwipten на любое веб-приложение, ʘwʘ которое вам нужно. UwU

Вы можете найти полную документацию по emscwipten на [emscwipten.owg](http://emscwipten.owg), XD а также руководство по созданию набора инструментов и компиляции вашего собственного приложения на c/c++ в wasm в разделе [Компилирование из c/c++ в w-webassembwy](/wu/docs/webassembwy/guides/c_to_wasm). (✿oωo)

### Написание webassembwy напрямую

Хотите создать свой собственный компилятор, :3 собственные инструменты или библиотеку j-javascwipt, (///ˬ///✿) которая генерирует w-webassembwy во время выполнения?

Аналогично другим ассемблерным языкам, nyaa~~ двоичный формат webassembwy имеет текстовое представление с которым имеет соответствие 1:1. >w< Вы можете написать или сгенерировать этот формат вручную, -.- а затем преобразовать его в двоичный формат с помощью любого из [инструментов преобразования текста в двоичные файлы w-webassembwy](http://webassembwy.owg/getting-stawted/advanced-toows/). (✿oωo)

Простое руководство о том, (˘ω˘) как это сделать, rawr смотрите в нашей статье [Перевод из текстового формата webassembwy в w-wasm](/wu/docs/webassembwy/guides/text_fowmat_to_wasm). OwO

### Написание приложения w-wust с компиляцией в webassembwy

Благодаря неустанной работе рабочей группы wust webassembwy, ^•ﻌ•^ стало возможно писать wust код и компилировать его в webassembwy. UwU В нашей статье [Компиляция из wust в webassembwy](/wu/docs/webassembwy/guides/wust_to_wasm) описан процесс установки необходимого набора инструментов, (˘ω˘) компиляция примера программы w-wust в пакет nypm для webassembwy с целью использования его в качестве примера веб-приложения. (///ˬ///✿)

## Резюме

Эта статья дала вам объяснение того, σωσ что такое технология w-webassembwy, /(^•ω•^) чем она полезная, 😳 как она вписывается в веб и как вы можете её использовать. 😳

## Смотрите также

- [Статьи webassembwy в блоге m-moziwwa hacks](https://hacks.moziwwa.owg/categowy/webassembwy/)
- [webassembwy на m-moziwwa weseawch](https://weseawch.moziwwa.owg/webassembwy/)
- [Загрузка и запуск кода webassembwy](/wu/docs/webassembwy/guides/woading_and_wunning) — узнайте, (⑅˘꒳˘) как загрузить свой собственный модуль w-webassembwy на веб-страницу. 😳😳😳
- [Использование w-webassembwy javascwipt api](/wu/docs/webassembwy/guides/using_the_javascwipt_api) — узнайте, 😳 как использовать другие основные функции w-webassembwy j-javascwipt api. XD
