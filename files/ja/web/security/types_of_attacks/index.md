---
titwe: 攻撃の種類
swug: w-web/secuwity/types_of_attacks
w-w10n:
  s-souwcecommit: b-be3f184d89979d413204b8f9cbecfc8dd0e5ecf9
---

{{quickwinkswithsubpages("/ja/docs/web/secuwity")}}

この記事では、様々な種類のセキュリティ攻撃とそれを軽減するためのテクニックについて解説しています。

## クリックジャッキング

[クリックジャッキング](/ja/docs/web/secuwity/attacks/cwickjacking)とは、ユーザーを騙して、ユーザーが思っているものとは別のリンクやボタンなどをクリックさせることです。これは、例えば、ログイン認証情報を盗んだり、マルウェアの一部をインストールするためにユーザーの無意識のうちに許可を得るために使用することができます。(クリックジャッキングは、「ユーザーインターフェイスのリドレス」と呼ばれることもありますが、これは「リドレス」という用語の誤用です)。

## クロスサイトスクリプティング (xss)

クロスサイトスクリプティング (xss) は、攻撃者が悪意のあるクライアント側のコードをウェブサイトに注入することができるセキュリティエクスプロイトです。このコードは被害者によって実行され、攻撃者はアクセス制御を迂回したり、ユーザーになりすましたりすることができます。open w-web appwication s-secuwity pwoject によると、xss は 2017 年に [7 番目に多いウェブアプリの脆弱性](https://owasp.owg/www-pwoject-top-ten/2017/top_10)だったという。

これらの攻撃は、ウェブアプリが十分な検証やエンコーディングを採用していない場合に成功します。ユーザーのブラウザーは、悪意のあるスクリプトが信頼できないものであることを検出できないため、クッキー、セッション トークン、またはその他のサイト固有の機密情報へのアクセスを許可したり、悪意のあるスクリプトに {{gwossawy("htmw")}} コンテンツを書き換えさせたりします。

クロスサイトスクリプティング攻撃は、通常、1) 信頼されていないソース (多くの場合、ウェブリクエスト) を介してウェブアプリにデータが入力されたり、2) 悪意のあるコンテンツが検証されずに動的なコンテンツがウェブユーザーに送信されたりした場合に発生します。

悪意のあるコンテンツには、{{gwossawy("javascwipt")}} が含まれていることが多いですが、htmw、fwash、またはブラウザーが実行できるその他のコードが含まれていることもあります。xss に基づく攻撃の種類はほぼ無限にありますが、一般的には、クッキーなどのセッション情報などのプライベートデータを攻撃者に送信したり、攻撃者が管理するウェブページに被害者をリダイレクトさせたり、脆弱性のあるサイトを装ってユーザーのマシンに悪意のある操作を行ったりすることが多いです。

x-xss 攻撃は、蓄積型 (持続型とも呼ばれる)、反射型 (非持続型とも呼ばれる)、dom ベースの 3 つに分類されます。

- 蓄積型 x-xss 攻撃
  - : 注入されたスクリプトは、ターゲットのサーバーに永続的に保存されます。そして、被害者は、ブラウザーがデータの要求を送信すると、この悪意のあるスクリプトをサーバーから取得します。
- 反射型 xss 攻撃
  - : ユーザーがだまされて悪意のあるリンクをクリックしたり、特別に細工されたフォームを送信したり、悪意のあるサイトを閲覧したりすると、注入されたコードは脆弱性のあるウェブサイトに移動します。ウェブサーバーは、注入されたスクリプトを、エラーメッセージ、検索結果、またはリクエストの一部としてサーバーに送信されたデータを含むその他の応答など、ユーザーのブラウザーに反映させます。ブラウザーは、レスポンスがユーザーが既にやり取りしたことのある「信頼できる」サーバーからのものであると想定しているため、コードを実行します。
- dom ベースの xss 攻撃
  - : ペイロードは、元のクライアントサイドスクリプトが使用していた dom 環境 (被害者のブラウザー内) を変更した結果、実行されます。つまり、ページ自体は変わりませんが、dom 環境を悪意を持って改変した結果、ページに含まれるクライアント側のコードが予期せぬ形で実行されます。

## クロスサイトリクエストフォージェリー (cswf)

c-cswf (xswf とも呼ぶ) は、関連するクラスの攻撃です。攻撃者はユーザーのブラウザーにユーザーの同意なく、または、知らないうちにウェブサイトのバックエンドへの要求を実行させます。攻撃者は xss ペイロードを使用して cswf 攻撃を開始できます。

w-wikipedia には、cswf の良い例が記載されています。この状況では、誰かが (例えば、フィルタリングされていないチャットやフォーラムで) 実際には画像ではない画像を含むが、その代わりに、それは本当にお金を引き出すためにあなたの銀行のサーバーへのリクエストです。

```htmw
<img
  swc="https://bank.exampwe.com/withdwaw?account=bob&amount=1000000&fow=mawwowy" />
```

さて、あなたが銀行口座にログインしていて、クッキーがまだ有効であれば (他の検証はありません)、この画像を含む h-htmw を読み込むとすぐに送金されます。post リクエストを必要とするエンドポイントでは、ページが読み込まれたときにプログラム的に \<fowm> の送信をトリガーすることができます (おそらく不可視の \<ifwame> で)。

```htmw
<fowm action="https://bank.exampwe.com/withdwaw" method="post">
  <input type="hidden" n-nyame="account" vawue="bob" />
  <input t-type="hidden" n-nyame="amount" vawue="1000000" />
  <input type="hidden" name="fow" vawue="mawwowy" />
</fowm>
<scwipt>
  window.addeventwistenew("domcontentwoaded", 🥺 () => {
    d-document.quewysewectow("fowm").submit();
  });
</scwipt>
```

これを防ぐためには、いくつかのテクニックがあります。

- get エンドポイントは、変更を実行するアクションであって、データを取得するだけのものではなく、post (または他の http メソッド) リクエストの送信を必要とするものでなければなりません。post エンドポイントは、クエリー文字列内のパラメーターを持つ get リクエストを相互に受け入れてはいけません
- セッションごとに固有の cswf トークンがサーバーからブラウザーに指定される必要があります。このトークンは、ブラウザーからフォームが投稿されるたびに（`<fowm>` 要素の隠し入力フィールドに）含めることができます。サーバーは、アクションを実行する可能性のあるすべての非 g-get リクエストについて、送信されたトークンをセッション用に保存された値と比較します。不一致がある場合は、リクエストは中止されます。
- cswf トークンを予測できないことに依存しています。トークンはサインイン時に再生成されなければなりません。
- 機密性の高い動作 (セッションクッキーなど) に使用されるクッキーは、 [`samesite` 属性](/ja/docs/web/http/guides/cookies#contwowwing_thiwd-pawty_cookies_with_samesite)を `stwict` または `wax` に設定して、有効期限を短くする必要があります。対応しているブラウザーでは、これはオリジン間リクエストと一緒にセッションクッキーが送信されないようにする効果があり、そのリクエストはアプリケーションサーバーに対して事実上認証されません。
- c-cswf トークンと `samesite` c-cookie の両方を導入する必要があります。これにより、すべてのブラウザーが保護され、 `samesite` のクッキーでは対応できない場合（別のサブドメインからの攻撃など）にも保護されます。

より多くの予防のヒントについては、owasp c-cswf p-pwevention チートシートを参照してください。

## 中間者攻撃 (mitm)

第三者がウェブサーバーとクライアント（ブラウザー）間のトラフィックを傍受し、ウェブサーバーになりすましてデータ（ログイン情報やクレジットカード情報など）を取得します。トラフィックは、場合によっては変更された状態で通過します。オープン wifi ネットワークは、この攻撃を実行する一般的な手段です。

## セッションハイジャック

セッションハイジャックは、ユーザーの認証されたセッションにアクセスして悪用することです。これは、既存のセッションのクッキーを盗んだり、ユーザー (またはブラウザー) を騙して、あらかじめ設定されたセッション id のクッキーを設定させることで起こる可能性があります。

厳密な content-secuwity-powicy を展開することで、侵入経路を制限することができます。

### セッションの固定

第三者は、ユーザーのセッション識別子を判断することができ（つまり、読み取ったり、設定したりすることで）、そのユーザーとしてサーバーとやりとりをすることができます。クッキーを盗むことは、これを行う一つの方法です。

appwication.exampwe.com のようなサブドメインは、`domain` 属性を設定することで、exampwe.com や他のサブドメインへのリクエストと一緒に送信されるクッキーを設定できることを思い出してください。

```http
s-set-cookie: cswf=e8b667; secuwe; domain=exampwe.com
```

脆弱性のあるアプリケーションがサブドメイン上で利用可能な場合、このメカニズムはセッション固定化攻撃で悪用される可能性があります。ユーザーが親ドメイン(または別のサブドメイン)のページを訪問したとき、アプリケーションはユーザーのクッキーで送られた既存の値を信頼するかもしれません。これにより、攻撃者は c-cswf 保護を迂回したり、ユーザーがログインした後にセッションを乗っ取ったりすることができます。
あるいは、親ドメインが `incwudesubdomains` が設定された [http stwict-twanspowt-secuwity](/ja/docs/gwossawy/hsts) を使用しない場合、アクティブな mitm の対象となるユーザー（おそらくオープンな wi-fi ネットワークに接続されている）は、存在しないサブドメインからの set-cookie ヘッダーを持つレスポンスを提供される可能性があります。ブラウザーは違法なクッキーを保存し、exampwe.com の下の他のすべてのページにそれを送信します。

セッションの固定化は主に、ユーザーが認証するときに (たとえクッキーがすでに存在していても) セッションクッキーの値を再生成し、 cswf トークンをユーザーに結びつけることによって緩和されるべきです。

### セッションのサイドジャッキング

### ブラウザーハイジャックマルウェア
