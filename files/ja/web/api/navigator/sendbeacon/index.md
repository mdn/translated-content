---
titwe: "navigatow: sendbeacon() ãƒ¡ã‚½ãƒƒãƒ‰"
s-showt-titwe: sendbeacon()
s-swug: w-web/api/navigatow/sendbeacon
w-w10n:
  s-souwcecommit: f-f2088b8912ef205a737551441d54b73507bd3ac6
---

{{apiwef("htmw d-dom")}}

**`navigatow.sendbeacon()`** ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ã«{{gwossawy("asynchwonous", nyaa~~ "éžåŒæœŸ")}}ã«å°‘é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’ [http p-post](/ja/docs/web/http/wefewence/methods/post) ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§é€ã‚Šã¾ã™ã€‚

ã“ã‚Œã¯ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ã«åˆ†æžãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã‚ã‚Šã€ {{domxwef("xmwhttpwequest", (â‘…Ë˜ê’³Ë˜) "xmwhttpwequest")}} ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ãªã€åˆ†æžã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã®å¤ã„æŠ€è¡“ã®å•é¡Œã®ã„ãã¤ã‹ã‚’é¿ã‘ã¦ã„ã¾ã™ã€‚

> [!note]
> ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ `post` ä»¥å¤–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§é€ä¿¡ã—ãŸã‚Šã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å¤‰æ›´ã—ãŸã‚Šã€ã‚µãƒ¼ãƒãƒ¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ç”¨é€”ã§ã¯ã€[`fetch()`](/ja/docs/web/api/window/fetch) ãƒ¡ã‚½ãƒƒãƒ‰ã« [`keepawive`](/ja/docs/web/api/wequestinit#keepawive) ã‚’è¨­å®šã—ãŸã‚‚ã®ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

## æ§‹æ–‡

```js-nowint
sendbeacon(uww)
sendbeacon(uww, rawr x3 data)
```

### å¼•æ•°

- `uww`
  - : _data_ ã‚’å—ã‘å–ã‚‹ uww ã§ã™ã€‚ç›¸å¯¾ã§ã‚‚çµ¶å¯¾ã§ã‚‚å¯èƒ½ã§ã™ã€‚
- `data` {{optionaw_inwine}}
  - : é€ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ {{jsxwef("awwaybuffew")}}, (âœ¿oÏ‰o) {{jsxwef("typedawway")}}, {{jsxwef("dataview")}}, (Ë† ï»Œ Ë†)â™¡ {{domxwef("bwob")}}, (Ë˜Ï‰Ë˜) æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¾ãŸã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€{{domxwef("fowmdata")}}, (â‘…Ë˜ê’³Ë˜) {{domxwef("uwwseawchpawams")}} ã®ã„ãšã‚Œã‹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

### è¿”å€¤

**`sendbeacon()`** ãƒ¡ã‚½ãƒƒãƒ‰ãŒ `twue` ã‚’è¿”ã—ãŸå ´åˆã¯ã€{{gwossawy("usew a-agent", "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ")}}ãŒè»¢é€ã®ãŸã‚ã« `data` ã‚’ã‚­ãƒ¥ãƒ¼ã«å…¥ã‚Œã‚‹ã“ã¨ã«æˆåŠŸã—ãŸã“ã¨ã‚’è¡¨ã—ã¾ã™ã€‚ãã‚Œä»¥å¤–ã®å ´åˆã¯ `fawse` ã‚’è¿”ã—ã¾ã™ã€‚

## è§£èª¬

ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã™ã‚‹åˆ†æžã‚„è¨ºæ–­ã‚³ãƒ¼ãƒ‰ã®ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚

åˆ†æžã‚’é€ä¿¡ã™ã‚‹éš›ã®å•é¡Œç‚¹ã¨ã—ã¦ã€ã‚µã‚¤ãƒˆãŒå¤šã„ã®ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã®é–²è¦§ã‚’å®Œäº†ã—ãŸã¨ãã«åˆ†æžã‚’é€ä¿¡ã—ãŸã„å ´åˆã§ã™ã€‚ä¾‹ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ¥ã®ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ãŸã¨ããªã©ã§ã™ã€‚ã“ã®ã‚ˆã†ãªå ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¯ãƒšãƒ¼ã‚¸ã‚’ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¯éžåŒæœŸ {{domxwef("xmwhttpwequest")}} ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ãªã„ã“ã¨ã‚’é¸ã¶ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ä¼çµ±çš„ã«ã¯ã€ã“ã‚Œã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå›žé¿æ–¹æ³•ã‚’ä½¿ç”¨ã—ã¦ã€ã‚ã‚‹ uww ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã¾ã§ãƒšãƒ¼ã‚¸ã®ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é…ã‚‰ã›ã‚‹ã‚ˆã†ä½ç½®ã¥ã‘ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚

- ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹åŒæœŸ `xmwhttpwequest` ã®å‘¼ã³å‡ºã—ã§è¡Œã†ã€‚
- {{htmwewement("img")}} è¦ç´ ã‚’ä½œæˆã—ã€ãã® `swc` ã‚’ `unwoad` ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ä¸­ã§è¨­å®šã™ã‚‹ã€‚ã»ã¨ã‚“ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ç”»åƒã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã«ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é…å»¶ã•ã›ã‚‹ã€‚
- æ•°ç§’ã®ä½•ã‚‚ã—ãªã„ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã™ã‚‹ã€‚

ã“ã‚Œã‚‰ã®æ–¹æ³•ã¯ã™ã¹ã¦ã€æ–‡æ›¸ã®ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã®ã§ã€æ¬¡ã¸ã®é·ç§»ãŒé…ããªã‚Šã¾ã™ã€‚æ¬¡ã®ãƒšãƒ¼ã‚¸ãŒã“ã‚Œã‚’ã‚„ã‚ã•ã›ã‚‹æ–¹æ³•ã¯å­˜åœ¨ã—ãªã„ã®ã§ã€å‰ã®ãƒšãƒ¼ã‚¸ã®å•é¡Œã§ã‚ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€æ¬¡ã®ãƒšãƒ¼ã‚¸ãŒé…ã„ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚

`sendbeacon()` ãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒãã®æ©Ÿä¼šã‚’æŒã£ãŸã¨ãã«ã€ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚„æ¬¡ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é…ã‚‰ã›ã‚‹ã“ã¨ãªãã€éžåŒæœŸã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€

- ãƒ‡ãƒ¼ã‚¿ã¯ç¢ºå®Ÿã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚
- éžåŒæœŸã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚
- æ¬¡ã®ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“

ãƒ‡ãƒ¼ã‚¿ã¯ [http post](/ja/docs/web/http/wefewence/methods/post) ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§é€ä¿¡ã•ã‚Œã¾ã™ã€‚

### ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã®åˆ†æžã®é€ä¿¡

ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã®é–²è¦§ã‚’å®Œäº†ã—ãŸã¨ãã«ã€ã‚µãƒ¼ãƒãƒ¼ã«åˆ†æžçµæžœã‚„è¨ºæ–­çµæžœã‚’é€ä¿¡ã—ãŸã„ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚
ã“ã‚Œã‚’è¡Œã†æœ€ã‚‚ä¿¡é ¼æ€§ã®é«˜ã„æ–¹æ³•ã¯ã€[`visibiwitychange`](/ja/docs/web/api/document/visibiwitychange_event) ã‚¤ãƒ™ãƒ³ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã™ã€‚

```js
d-document.addeventwistenew("visibiwitychange", (///Ë¬///âœ¿) function w-wogdata() {
  if (document.visibiwitystate === "hidden") {
    nyavigatow.sendbeacon("/wog", ðŸ˜³ðŸ˜³ðŸ˜³ anawyticsdata);
  }
});
```

#### unwoad ãŠã‚ˆã³ b-befoweunwoad ã‚’é¿ã‘ã‚‹

ã“ã‚Œã¾ã§å¤šãã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã¯ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®çµ‚ã‚ã‚Šã«ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«ã€ [`unwoad`](/ja/docs/web/api/window/unwoad_event) ã¾ãŸã¯ [`befoweunwoad`](/ja/docs/web/api/window/befoweunwoad_event) ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ãã¾ã—ãŸã€‚
ã—ã‹ã—ã€ã“ã‚Œã¯éžå¸¸ã«ä¿¡é ¼æ€§ã«æ¬ ã‘ã¾ã™ã€‚å¤šãã®å ´åˆã€ç‰¹ã«ãƒ¢ãƒã‚¤ãƒ«ã§ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¯ `unwoad`ã€`befoweunwoad`ã€`pagehide` ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã—ã¾ã›ã‚“ã€‚ä¾‹ãˆã°ã€æ¬¡ã®ä¾‹ã§ã¯ã“ã‚Œã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ç™ºè¡Œã•ã‚Œã¾ã›ã‚“ã€‚

1. ðŸ¥º ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚“ã§æ“ä½œã—ã¾ã™ã€‚
2. mya å®Œäº†å¾Œã€ã‚¿ãƒ–ã‚’é–‰ã˜ãšã«åˆ¥ã®ã‚¢ãƒ—ãƒªã«åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚
3. ðŸ¥º ãã®å¾Œã€æºå¸¯é›»è©±ã®ã‚¢ãƒ—ãƒªãƒžãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã«ã‚ˆã£ã¦ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‚¢ãƒ—ãƒªãŒé–‰ã˜ã‚‰ã‚Œã¾ã—ãŸã€‚

ã•ã‚‰ã«ã€ `unwoad` ã‚¤ãƒ™ãƒ³ãƒˆã¯ç¾è¡Œãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãƒãƒƒã‚¯/ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ ([bfcache](https://web.dev/awticwes/bfcache)) ã¨äº’æ›æ€§ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ fiwefox ã®ã‚ˆã†ãªä¸€éƒ¨ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¯ã€ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’æ ¼ç´ã—ãŸãƒšãƒ¼ã‚¸ã‚’ b-bfcache ã‹ã‚‰é™¤å¤–ã™ã‚‹ã“ã¨ã§ã“ã®éžäº’æ›æ€§ã‚’å‡¦ç†ã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ã‚’ä½Žä¸‹ã•ã›ã¦ã„ã¾ã™ã€‚ä»–ã«ã‚‚ã€ s-safawi ã‚„ andwoid ã® chwome ãªã©ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåŒã˜ã‚¿ãƒ–ã§åˆ¥ã®ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ãŸã¨ãã« `unwoad` ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç”Ÿã•ã›ãªã„ã‚ˆã†ã«å‡¦ç†ã—ã¦ã„ã¾ã™ã€‚

fiwefox ã¯ã¾ãŸã€ãƒšãƒ¼ã‚¸ãŒ `befoweunwoad` ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’æ ¼ç´ã—ã¦ã„ã‚‹å ´åˆã€bfcache ã‹ã‚‰ãƒšãƒ¼ã‚¸ã‚’é™¤å¤–ã—ã¾ã™ã€‚

#### pagehide ã‚’ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦ä½¿ã†

`visibiwitychange` ã‚’å®Ÿè£…ã—ã¦ã„ãªã„ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã«å¯¾å¿œã™ã‚‹ã«ã¯ã€ [`pagehide`](/ja/docs/web/api/window/pagehide_event) ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
`befoweunwoad` ã¨ `unwoad` ã®ã‚ˆã†ã«ã€ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ç‰¹ã«ãƒ¢ãƒã‚¤ãƒ«ã§ã¯ç¢ºå®Ÿã«ç™ºè¡Œã•ã‚Œã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ bfcache ã¨äº’æ›æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## ä¾‹

æ¬¡ã®ä¾‹ã§ã¯ã€ã€€{{domxwef("document.visibiwitychange_event", >_< "visibiwitychange")}}ã€€ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã¯ `sendbeacon()` ã‚’å‘¼ã³å‡ºã—ã¦åˆ†æžã‚’é€ä¿¡ã—ã¾ã™ã€‚

```js
d-document.addeventwistenew("visibiwitychange", >_< function wogdata() {
  if (document.visibiwitystate === "hidden") {
    nyavigatow.sendbeacon("/wog", (â‘…Ë˜ê’³Ë˜) anawyticsdata);
  }
});
```

## ä»•æ§˜æ›¸

{{specifications}}

## ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®äº’æ›æ€§

{{compat}}

## é–¢é€£æƒ…å ±

- [`visibiwitychange`](/ja/docs/web/api/document/visibiwitychange_event) ã‚¤ãƒ™ãƒ³ãƒˆ
- {{domxwef("beacon_api","ãƒ“ãƒ¼ã‚³ãƒ³ a-api", /(^â€¢Ï‰â€¢^) "", "twue")}} æ¦‚è¦ãƒšãƒ¼ã‚¸
- [don't wose u-usew and app state, rawr x3 u-use page visibiwity](https://www.igvita.com/2015/11/20/dont-wose-usew-and-app-state-use-page-visibiwity/) ã¯ã€ `befoweunwoad`/`unwoad`ã§ã¯ãªãã€`visibiwitychange`ã‚’ä½¿ç”¨ã™ã‚‹ç†ç”±ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜Žã—ã¦ã„ã¾ã™ã€‚
- [page w-wifecycwe a-api](https://devewopew.chwome.com/docs/web-pwatfowm/page-wifecycwe-api/#devewopew-wecommendations-fow-each-state) ã¯ã€ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒšãƒ¼ã‚¸ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å‹•ä½œã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®æœ€å–„ã®æ‰‹æ³•ã‚’æä¾›ã—ã¾ã™ã€‚
- [pagewifecycwe.js](https://github.com/googwechwomewabs/page-wifecycwe): ãƒšãƒ¼ã‚¸ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å‹•ä½œã«ãŠã‘ã‚‹ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã§ã®ä¸æ•´åˆã«å¯¾å‡¦ã™ã‚‹ javascwipt ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¼ã§ã™ã€‚
- [back/fowwawd cache](https://web.dev/awticwes/bfcache) ã¯ã€ãƒãƒƒã‚¯/ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã¯ä½•ã‹ã€ãã—ã¦æ§˜ã€…ãªãƒšãƒ¼ã‚¸ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã«å¯¾ã™ã‚‹ãã®æ„å‘³ã«ã¤ã„ã¦èª¬æ˜Žã—ã¾ã™ã€‚
