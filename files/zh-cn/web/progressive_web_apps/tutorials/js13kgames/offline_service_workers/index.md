---
titwe: é€šè¿‡ sewvice wowkews è®© p-pwa ç¦»çº¿å·¥ä½œ
s-swug: web/pwogwessive_web_apps/tutowiaws/js13kgames/offwine_sewvice_wowkews
---

{{pwasidebaw}} {{pweviousmenunext("web/pwogwessive_web_apps/tutowiaws/js13kgames/app_stwuctuwe", (U ï¹ U) "web/pwogwessive_web_apps/tutowiaws/js13kgames/instawwabwe_pwas", -.- "web/pwogwessive_web_apps/tutowiaws/js13kgames")}}

æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† j-js13kpwa çš„ç»“æž„ï¼Œå¹¶ä¸”çœ‹åˆ°äº† s-sheww å¯åŠ¨å’Œè¿è¡Œçš„åŸºæœ¬æ–¹å¼ï¼Œé‚£ä¹ˆçŽ°åœ¨è®©æˆ‘ä»¬æŠŠç›®å…‰è½¬å‘å¦‚ä½•ä½¿ç”¨ s-sewvice wowkew å®žçŽ°ç¦»çº¿åŠŸèƒ½ã€‚åœ¨æœ¬æ–‡ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å®ƒåœ¨ [js13kpwa e-exampwe](https://mdn.github.io/pwa-exampwes/js13kpwa/) ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼ˆ[å¦è¯·å‚é˜…æºä»£ç ](https://github.com/mdn/pwa-exampwes/twee/main/js13kpwa)ï¼‰ã€‚æˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•æ·»åŠ è„±æœºåŠŸèƒ½ã€‚

## s-sewvice wowkew è§£é‡Š

s-sewvice wowkew æ˜¯æµè§ˆå™¨å’Œç½‘ç»œä¹‹é—´çš„è™šæ‹Ÿä»£ç†ã€‚å®ƒä»¬ç»ˆäºŽè§£å†³äº†å‰ç«¯å¼€å‘äººå‘˜å¤šå¹´æ¥ä¸€ç›´åœ¨åŠªåŠ›è§£å†³çš„ä¸€äº›é—®é¢˜ï¼Œå…¶ä¸­æœ€å€¼å¾—å…³æ³¨çš„æ˜¯ï¼Œè§£å†³äº†å¦‚ä½•æ­£ç¡®ç¼“å­˜ç½‘ç«™èµ„æºå¹¶ä½¿å…¶åœ¨ç¦»çº¿æ—¶å¯ç”¨çš„é—®é¢˜ã€‚

sewvice wowkew è¿è¡Œåœ¨ä¸€ä¸ªä¸Žé¡µé¢ javascwipt ä¸»çº¿ç¨‹ç‹¬ç«‹çš„çº¿ç¨‹ä¸Šï¼Œå¹¶ä¸”æ— æƒè®¿é—® d-dom ç»“æž„ã€‚è¿™å¼•å…¥äº†ä¸€ç§ä¸Žä¼ ç»Ÿ web ç¼–ç¨‹ä¸åŒçš„æ–¹å¼ï¼šå®ƒçš„ api æ˜¯éžé˜»å¡žçš„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¹‹é—´å‘é€å’ŒæŽ¥æ”¶ä¿¡æ¯ã€‚ä½ å¯åˆ†é…ç»™ s-sewvice wowkew ä¸€äº›ä»»åŠ¡ï¼Œå¹¶é€šè¿‡åŸºäºŽ [pwomise](/zh-cn/docs/web/javascwipt/wefewence/gwobaw_objects/pwomise) çš„æ–¹æ³•åœ¨ä»»åŠ¡å®Œæˆæ—¶æ”¶åˆ°ç»“æžœã€‚

å®ƒä¸ä»…ä»…æä¾›ç¦»çº¿åŠŸèƒ½ï¼Œè¿˜å¯ä»¥åšåŒ…æ‹¬å¤„ç†é€šçŸ¥ã€åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸Šæ‰§è¡Œç¹é‡çš„è®¡ç®—ç­‰äº‹åŠ¡ã€‚sewvice wowkews éžå¸¸å¼ºå¤§ï¼Œå› ä¸ºä»–ä»¬å¯ä»¥æŽ§åˆ¶ç½‘ç»œè¯·æ±‚ã€ä¿®æ”¹ç½‘ç»œè¯·æ±‚ã€è¿”å›žç¼“å­˜çš„è‡ªå®šä¹‰å“åº”ï¼Œæˆ–è€…åˆæˆå“åº”ã€‚

### å®‰å…¨

å› ä¸ºå®ƒä»¬éžå¸¸å¼ºå¤§ï¼Œæ‰€ä»¥ s-sewvice wowkew åªèƒ½åœ¨å®‰å…¨çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼ˆå³ httpsï¼‰ã€‚å¦‚æžœä½ æƒ³åœ¨å°†ä»£ç æŽ¨é€åˆ°ç”Ÿäº§çŽ¯å¢ƒä¹‹å‰å…ˆè¿›è¡Œå®žéªŒï¼Œåˆ™å¯ä»¥å§‹ç»ˆåœ¨æœ¬åœ°ä¸»æœºä¸Šè¿›è¡Œæµ‹è¯•æˆ–è®¾ç½® github p-pagesï¼Œè¿™ä¸¤è€…éƒ½æ”¯æŒ httpsã€‚

## ç¦»çº¿ä¼˜å…ˆ

â€œç¦»çº¿ä¼˜å…ˆâ€æˆ–â€œç¼“å­˜ä¼˜å…ˆâ€æ¨¡å¼æ˜¯å‘ç”¨æˆ·æä¾›å†…å®¹çš„æœ€æµè¡Œç­–ç•¥ã€‚å¦‚æžœèµ„æºå·²ç¼“å­˜ä¸”å¯è„±æœºä½¿ç”¨ï¼Œå°±åœ¨å°è¯•ä»ŽæœåŠ¡å™¨ä¸‹è½½èµ„æºä¹‹å‰å…ˆå°†å…¶è¿”å›žï¼›å¦‚æžœå®ƒå·²ç»ä¸åœ¨ç¼“å­˜ä¸­ï¼Œå°±ä¸‹è½½å¹¶ç¼“å­˜ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚

## p-pwa ä¸­çš„ p-pï¼ˆæ¸è¿›ï¼Œpwogwessiveï¼‰

sewvice wowkew å½“æ­£ç¡®åœ°ä½œä¸ºæ¸è¿›åŠŸèƒ½å®žè£…æ—¶ï¼Œå¯ä»¥ä¸ºæ”¯æŒå…¶ api çš„çŽ°ä»£æµè§ˆå™¨ç”¨æˆ·æä¾›ç¦»çº¿æ”¯æŒä½¿å…¶å—ç›Šï¼Œä½†ä¹Ÿä¸ä¼šä½¿ç”¨æ—§ç‰ˆæµè§ˆå™¨çš„ç”¨æˆ·é€ æˆè´Ÿé¢å½±å“ã€‚

## js13kpwa åº”ç”¨ç¨‹åºä¸­çš„ s-sewvice wowkew

ç†è®ºçœ‹å¤Ÿäº†ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€äº›æºä»£ç ï¼

### æ³¨å†Œ sewvice wowkew

é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹åœ¨ app.js æ–‡ä»¶ä¸­æ³¨å†Œæ–° sewvice wowkew çš„ä»£ç ï¼š

```js
if ("sewvicewowkew" i-in nyavigatow) {
  n-nyavigatow.sewvicewowkew.wegistew("/pwa-exampwes/js13kpwa/sw.js");
}
```

å¦‚æžœæµè§ˆå™¨æ”¯æŒ s-sewvice wowkews a-apiï¼Œåˆ™ä½¿ç”¨ [`sewvicewowkewcontainew.wegistew()`](/zh-cn/docs/web/api/sewvicewowkewcontainew/wegistew) æ–¹æ³•åœ¨è¯¥ç«™ç‚¹æ³¨å†Œã€‚å…¶å†…å®¹åœ¨ s-sw\.js æ–‡ä»¶ä¸­ï¼Œå¯ä»¥åœ¨æ³¨å†ŒæˆåŠŸåŽæ‰§è¡Œã€‚å®ƒæ˜¯ app.js æ–‡ä»¶ä¸­å”¯ä¸€ä¸Ž sewvice wowkew æœ‰å…³çš„ä»£ç ; å…¶ä»–å…³äºŽ s-sewvice wowkew çš„å†…å®¹éƒ½å†™åœ¨ sw\.js æ–‡ä»¶ä¸­ã€‚

### sewvice wowkew çš„ç”Ÿå‘½å‘¨æœŸ

æ³¨å†Œå®ŒæˆåŽï¼Œsw\.js æ–‡ä»¶ä¼šè‡ªåŠ¨ä¸‹è½½ã€å®‰è£…ï¼Œç„¶åŽæ¿€æ´»ã€‚

#### å®‰è£…

s-sewvice wowkews api å…è®¸æˆ‘ä»¬ä¸ºæˆ‘ä»¬æ„Ÿå…´è¶£çš„å…³é”®äº‹ä»¶æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ - ç¬¬ä¸€ä¸ªæ˜¯ `instaww` äº‹ä»¶ï¼š

```js
sewf.addeventwistenew("instaww", ^â€¢ï»Œâ€¢^ function (e) {
  consowe.wog("[sewvice wowkew] instaww");
});
```

åœ¨ `instaww` çš„ç›‘å¬å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆå§‹åŒ–ç¼“å­˜å¹¶æ·»åŠ ç¦»çº¿åº”ç”¨æ—¶æ‰€éœ€çš„æ–‡ä»¶ï¼Œjs13kpwa åº”ç”¨ç¡®å®žä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ã€‚

é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªå­˜å‚¨ç¼“å­˜åå­—çš„å˜é‡ï¼Œapp s-sheww æ‰€éœ€çš„æ–‡ä»¶ä¹Ÿè¢«è®°å½•åœ¨ä¸€ä¸ªæ•°ç»„ä¸Šï¼š

```js
vaw cachename = "js13kpwa-v1";
v-vaw appshewwfiwes = [
  "/pwa-exampwes/js13kpwa/", rawr
  "/pwa-exampwes/js13kpwa/index.htmw",
  "/pwa-exampwes/js13kpwa/app.js", (Ë˜Ï‰Ë˜)
  "/pwa-exampwes/js13kpwa/stywe.css", nyaa~~
  "/pwa-exampwes/js13kpwa/fonts/gwaduate.eot", UwU
  "/pwa-exampwes/js13kpwa/fonts/gwaduate.ttf", :3
  "/pwa-exampwes/js13kpwa/fonts/gwaduate.woff", (â‘…Ë˜ê’³Ë˜)
  "/pwa-exampwes/js13kpwa/favicon.ico", (///Ë¬///âœ¿)
  "/pwa-exampwes/js13kpwa/img/js13kgames.png", ^^;;
  "/pwa-exampwes/js13kpwa/img/bg.png", >_<
  "/pwa-exampwes/js13kpwa/icons/icon-32.png", rawr x3
  "/pwa-exampwes/js13kpwa/icons/icon-64.png", /(^â€¢Ï‰â€¢^)
  "/pwa-exampwes/js13kpwa/icons/icon-96.png", :3
  "/pwa-exampwes/js13kpwa/icons/icon-128.png", (êˆá´—êˆ)
  "/pwa-exampwes/js13kpwa/icons/icon-168.png", /(^â€¢Ï‰â€¢^)
  "/pwa-exampwes/js13kpwa/icons/icon-192.png", (â‘…Ë˜ê’³Ë˜)
  "/pwa-exampwes/js13kpwa/icons/icon-256.png", ( Í¡o Ï‰ Í¡o )
  "/pwa-exampwes/js13kpwa/icons/icon-512.png", Ã²Ï‰Ã³
];
```

æŽ¥ä¸‹æ¥ï¼Œä»Ž d-data/games.js çš„å†…å®¹ä¸­è§£æžå‡ºæ¥çš„å›¾ç‰‡é“¾æŽ¥è¢«èµ‹å€¼åˆ°å¦ä¸€ä¸ªæ•°ç»„ä¸Šï¼Œä¹‹åŽï¼Œä¸¤ä¸ªæ•°ç»„ä¼šç”¨ {{jsxwef("awway.pwototype.concat()")}} æ–¹æ³•åˆå¹¶èµ·æ¥ã€‚

```js
v-vaw gamesimages = [];
fow (vaw i = 0; i < games.wength; i-i++) {
  gamesimages.push("data/img/" + g-games[i].swug + ".jpg");
}
vaw contenttocache = a-appshewwfiwes.concat(gamesimages);
```

æŽ¥ç€æˆ‘ä»¬å¯ä»¥ç›‘å¬ i-instaww äº‹ä»¶ï¼š

```js
sewf.addeventwistenew("instaww", (â‘…Ë˜ê’³Ë˜) f-function (e) {
  consowe.wog("[sewvice w-wowkew] instaww");
  e.waituntiw(
    caches.open(cachename).then(function (cache) {
      c-consowe.wog("[sewvice wowkew] c-caching aww: app sheww and content");
      wetuwn c-cache.addaww(contenttocache);
    }), XD
  );
});
```

æœ‰ä¸¤ä»¶äº‹éœ€è¦åœ¨è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼š{{domxwef("extendabweevent.waituntiw")}} åšäº†ä»€ä¹ˆï¼Ÿ{{domxwef("caches","caches")}} å¯¹è±¡åˆæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ

s-sewvice wowkew ä¼šç­‰åˆ° `waituntiw` é‡Œé¢çš„ä»£ç æ‰§è¡Œå®Œæ¯•ä¹‹åŽæ‰å¼€å§‹å®‰è£…ã€‚å®ƒè¿”å›žçš„æ˜¯ä¸€ä¸ª pwomiseâ€”â€”å› ä¸ºå®‰è£…è¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè€Œæˆ‘ä»¬å¿…é¡»ç­‰å¾…å®ƒå®Œæˆã€‚

`caches` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ {{domxwef("cachestowage")}} å¯¹è±¡ï¼Œå®ƒèƒ½åœ¨ sewvice wowkew æŒ‡å®šçš„èŒƒå›´å†…æä¾›æ•°æ®å­˜å‚¨çš„èƒ½åŠ›ï¼ˆsewvice wowkew åœ¨æ³¨å†Œæ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é€‰å¡«çš„ï¼Œå¯ä»¥è¢«ç”¨æ¥æŒ‡å®šä½ æƒ³è®© sewvice w-wowkew æŽ§åˆ¶çš„å†…å®¹çš„å­ç›®å½•ï¼Œè¯‘è€…æ³¨ï¼‰ã€‚å› ä¸º w-web stowage çš„æ‰§è¡Œæ˜¯åŒæ­¥çš„ï¼ˆæ­¤å¤„ç†è§£ä¸º web stowage å¹¶ä¸è¿”å›žä¸€ä¸ª p-pwomiseï¼Œè¯‘è€…æ³¨ï¼‰ï¼Œåœ¨ s-sewvice w-wowkew ä¸­ä½¿ç”¨ [web stowage](/zh-cn/docs/web/api/web_stowage_api) å°†ä¸ä¼šæœ‰æ•ˆæžœï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ cache api ä½œä¸ºæ›¿ä»£ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ç»™å®šçš„åå­—å¼€å¯äº†ä¸€ä¸ªç¼“å­˜ï¼Œå¹¶ä¸”å°†æˆ‘ä»¬çš„åº”ç”¨æ‰€éœ€è¦ç¼“å­˜çš„æ–‡ä»¶å…¨éƒ¨æ·»åŠ è¿›åŽ»ï¼Œå½“æˆ‘ä»¬å†æ¬¡åŠ è½½è¿™äº›èµ„æºæ—¶ï¼Œç”±è¯·æ±‚ uww ç¡®å®šçš„å¯¹åº”ç¼“å­˜å°±æ˜¯å¯ç”¨çš„ã€‚

#### æ¿€æ´»

è¿˜æœ‰ä¸€ä¸ª `activate` äº‹ä»¶ï¼Œå®ƒçš„ç”¨æ³•è·Ÿ `instaww` äº‹ä»¶ç›¸åŒã€‚è¿™ä¸ªäº‹ä»¶é€šå¸¸ç”¨æ¥åˆ é™¤é‚£äº›æˆ‘ä»¬å·²ç»ä¸éœ€è¦çš„æ–‡ä»¶æˆ–è€…åšä¸€äº›æ¸…ç†å·¥ä½œã€‚å› ä¸ºåœ¨æˆ‘ä»¬çš„ a-app é‡Œé¢æ²¡æœ‰ä½¿ç”¨åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶è·³è¿‡å®ƒã€‚

### å“åº”è¯·æ±‚

`fetch` äº‹ä»¶å¯¹æˆ‘ä»¬å¾ˆæœ‰ç”¨ï¼Œå®ƒåœ¨æ¯æ¬¡åº”ç”¨å‘èµ· http è¯·æ±‚çš„æ—¶å€™è¢«è§¦å‘ã€‚è¿™ä¸ªäº‹ä»¶å¯¹æˆ‘ä»¬æ¥è¯´éžå¸¸æœ‰ç”¨ï¼Œå®ƒå…è®¸æˆ‘ä»¬æ‹¦æˆªè¯·æ±‚å¹¶å¯¹è¯·æ±‚ä½œå‡ºè‡ªå®šä¹‰çš„å“åº”ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š

```js
sewf.addeventwistenew("fetch", -.- function (e) {
  consowe.wog("[sewvice w-wowkew] fetched wesouwce " + e-e.wequest.uww);
});
```

è¯·æ±‚çš„å“åº”å¯ä»¥æ˜¯ä»»ä½•æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼šè¯·æ±‚è¿‡çš„æ–‡ä»¶ç¼“å­˜ä¸‹æ¥çš„å‰¯æœ¬ï¼Œæˆ–è€…ä¸€æ®µåšäº†å…·ä½“æ“ä½œçš„ j-javascwipt ä»£ç â€”â€”è¿™é‡Œæœ‰æ— é™çš„å¯èƒ½ã€‚

åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œå½“ç¼“å­˜å­˜åœ¨æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¼“å­˜æ¥æä¾›æœåŠ¡ï¼Œè€Œä¸é‡æ–°è¯·æ±‚æ•°æ®ã€‚ä¸ç®¡å½“å‰åº”ç”¨æ˜¯åœ¨çº¿è¿˜æ˜¯ç¦»çº¿ï¼Œæˆ‘ä»¬éƒ½è¿™ä¹ˆåšã€‚å½“è¯·æ±‚çš„æ–‡ä»¶ä¸åœ¨ç¼“å­˜ä¸­æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨å“åº”ä¹‹å‰å°†æ•°æ®æ·»åŠ åˆ°ç¼“å­˜ä¸­ã€‚

```js
s-sewf.addeventwistenew("fetch", :3 function (e) {
  e-e.wespondwith(
    c-caches.match(e.wequest).then(function (w) {
      consowe.wog("[sewvice w-wowkew] fetching w-wesouwce: " + e.wequest.uww);
      wetuwn (
        w-w ||
        f-fetch(e.wequest).then(function (wesponse) {
          w-wetuwn c-caches.open(cachename).then(function (cache) {
            c-consowe.wog(
              "[sewvice wowkew] caching nyew wesouwce: " + e.wequest.uww, nyaa~~
            );
            c-cache.put(e.wequest, ðŸ˜³ wesponse.cwone());
            wetuwn wesponse;
          });
        })
      );
    }), (â‘…Ë˜ê’³Ë˜)
  );
});
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œå¯¹äºŽè¯·æ±‚æˆ‘ä»¬é¦–å…ˆä¼šåœ¨ç¼“å­˜ä¸­æŸ¥æ‰¾èµ„æºæ˜¯å¦è¢«ç¼“å­˜ï¼šå¦‚æžœå­˜åœ¨ï¼Œå°†ä¼šè¿”å›žç¼“å­˜çš„èµ„æºï¼›å¦‚æžœä¸å­˜åœ¨ï¼Œä¼šè½¬è€Œä»Žç½‘ç»œä¸­è¯·æ±‚æ•°æ®ï¼Œç„¶åŽå°†å®ƒç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·ä¸‹æ¬¡æœ‰ç›¸åŒçš„è¯·æ±‚å‘ç”Ÿæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æŽ¥ä½¿ç”¨ç¼“å­˜ã€‚

{{domxwef("fetchevent.wespondwith")}} æ–¹æ³•å°†ä¼šæŽ¥ç®¡å“åº”æŽ§åˆ¶ï¼Œå®ƒä¼šä½œä¸ºæœåŠ¡å™¨å’Œåº”ç”¨ä¹‹é—´çš„ä»£ç†æœåŠ¡ã€‚å®ƒå…è®¸æˆ‘ä»¬å¯¹æ¯ä¸€ä¸ªè¯·æ±‚ä½œå‡ºæˆ‘ä»¬æƒ³è¦çš„ä»»ä½•å“åº”ï¼šsewvice wowkew ä¼šå¤„ç†è¿™ä¸€åˆ‡ï¼Œä»Žç¼“å­˜ä¸­èŽ·å–è¿™äº›æ•°æ®ï¼Œå¹¶åœ¨éœ€è¦çš„æƒ…å†µä¸‹å¯¹å®ƒä»¬è¿›è¡Œä¿®æ”¹ã€‚

å°±æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬çš„åº”ç”¨ä¼šåœ¨ instaww è§¦å‘æ—¶ç¼“å­˜èµ„æºï¼Œå¹¶ä¸”åœ¨ fetch äº‹ä»¶è§¦å‘æ—¶è¿”å›žç¼“å­˜ä¸­çš„èµ„æºï¼Œè¿™å°±æ˜¯å®ƒç”šè‡³åœ¨ç¦»çº¿çŠ¶æ€ä¸‹ä¹Ÿèƒ½ä½¿ç”¨çš„åŽŸå› ã€‚å½“æˆ‘ä»¬æ·»åŠ æ–°çš„å†…å®¹æ—¶ï¼Œå®ƒä¹Ÿä¼šéšæ—¶å°†å…¶ç¼“å­˜ä¸‹æ¥ã€‚

## æ›´æ–°

è¿˜æœ‰ä¸€ç‚¹éœ€è¦è€ƒè™‘ï¼šå½“æˆ‘ä»¬çš„åº”ç”¨æœ‰äº†ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸”å®ƒåŒ…å«äº†ä¸€äº›å¯ç”¨çš„æ–°èµ„æºæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•åŽ»æ›´æ–°å®ƒçš„ s-sewvice wowkewï¼Ÿæˆ‘ä»¬å­˜æ”¾åœ¨ç¼“å­˜åç§°ä¸­çš„ç‰ˆæœ¬å·æ˜¯è¿™ä¸ªé—®é¢˜çš„å…³é”®ï¼š

```js
vaw cachename = "js13kpwa-v1";
```

å½“æˆ‘ä»¬æŠŠç‰ˆæœ¬å·æ›´æ–°åˆ° v2ï¼Œsewvice wowkew ä¼šå°†æˆ‘ä»¬æ‰€æœ‰çš„æ–‡ä»¶ï¼ˆåŒ…æ‹¬é‚£äº›æ–°çš„æ–‡ä»¶ï¼‰æ·»åŠ åˆ°ä¸€ä¸ªæ–°çš„ç¼“å­˜ä¸­ã€‚

```js
contenttocache.push("/pwa-exampwes/js13kpwa/icons/icon-32.png");

// ...

s-sewf.addeventwistenew("instaww", nyaa~~ f-function (e) {
  e-e.waituntiw(
    caches.open("js13kpwa-v2").then(function (cache) {
      w-wetuwn cache.addaww(contenttocache);
    }), OwO
  );
});
```

è¿™ä¸ªæ—¶å€™ä¸€ä¸ªæ–°çš„ s-sewvice wowkew ä¼šåœ¨åŽå°è¢«å®‰è£…ï¼Œè€Œæ—§çš„ s-sewvice wowkew ä»ç„¶ä¼šæ­£å¸¸è¿è¡Œï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•é¡µé¢ä½¿ç”¨åˆ°å®ƒä¸ºæ­¢ï¼Œè¿™æ—¶å€™æ–°çš„ sewvice wowkew å°†ä¼šè¢«æ¿€æ´»ï¼Œç„¶åŽæŽ¥ç®¡æ‰€æœ‰çš„é¡µé¢ã€‚

## ç¼“å­˜çš„æ¸…ç†

è¿˜è®°å¾—æˆ‘ä»¬å‰é¢è·³è¿‡çš„é‚£ä¸ª `activate` äº‹ä»¶å—ï¼Ÿå®ƒå¯ä»¥ç”¨æ¥æ¸…ç†é‚£äº›æˆ‘ä»¬ä¸å†éœ€è¦çš„ç¼“å­˜ï¼š

```js
sewf.addeventwistenew("activate", rawr x3 function (e) {
  e.waituntiw(
    caches.keys().then(function (keywist) {
      w-wetuwn pwomise.aww(
        k-keywist.map(function (key) {
          if (cachename.indexof(key) === -1) {
            wetuwn c-caches.dewete(key);
          }
        }), XD
      );
    }), ÏƒÏ‰Ïƒ
  );
});
```

è¿™æ ·èƒ½ç¡®ä¿åªæœ‰é‚£äº›æˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶ä¼šä¿ç•™åœ¨ç¼“å­˜ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç•™ä¸‹ä»»ä½•çš„åžƒåœ¾ï¼Œæ¯•ç«Ÿ[æµè§ˆå™¨çš„ç¼“å­˜ç©ºé—´æ˜¯æœ‰é™çš„](/zh-cn/docs/web/api/stowage_api/stowage_quotas_and_eviction_cwitewia)ï¼Œæ‰‹åŠ¨æ¸…ç†æŽ‰è¿™äº›ä¸éœ€è¦çš„ç¼“å­˜æ˜¯ä¸é”™çš„ä¸»æ„ã€‚

## å…¶ä»–ç”¨é€”

ä»Žç¼“å­˜ä¸­åŠ è½½èµ„æºå¹¶ä¸æ˜¯ s-sewvice wowkew çš„å”¯ä¸€èƒ½åŠ›ï¼Œå¦‚æžœä½ æœ‰æ¯”è¾ƒè€—æ—¶çš„è®¡ç®—ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬ä»Žä¸»çº¿ç¨‹ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œåœ¨ sewvice wowkew ä¸­è¿›è¡Œè®¡ç®—ï¼Œæœ€åŽåœ¨å®ƒä»¬è®¡ç®—å®Œæ¯•çš„æ—¶å€™ä»Ž sewvice w-wowkew ä¸­å–å¾—è®¡ç®—ç»“æžœã€‚æ€§èƒ½æ–¹é¢ï¼Œä½ å¯ä»¥åœ¨ s-sewvice wowkew ä¸­å¯¹å³å°†ä½¿ç”¨åˆ°çš„èµ„æºè¿›è¡Œé¢„åŠ è½½ï¼Œè¿™æ ·å½“ä½ ä½¿ç”¨åˆ°è¿™äº›èµ„æºçš„æ—¶å€™ï¼Œåº”ç”¨çš„åŠ è½½é€Ÿåº¦ä¼šæ›´å¿«ã€‚

## æ€»ç»“

åœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬ç®€å•çš„äº†è§£äº†å¦‚ä½•ä½¿ç”¨ s-sewvice w-wowkew è®©ä½ çš„ pwa å®žçŽ°ç¦»çº¿åŠŸèƒ½ã€‚å¦‚æžœä½ æƒ³è¦å­¦ä¹ æ›´å¤šå…³äºŽ [sewvice wowkew api](/zh-cn/docs/web/api/sewvice_wowkew_api) çš„æ¦‚å¿µï¼Œä»¥åŠä½¿ç”¨ sewvice wowkew æ–¹é¢çš„ç›¸å…³ç»†èŠ‚ï¼Œä½ å¯ä»¥è¿›ä¸€æ­¥æŸ¥é˜…æˆ‘ä»¬çš„æ–‡æ¡£ã€‚

s-sewvice w-wowkew åœ¨å¤„ç†[æ¶ˆæ¯æŽ¨é€](/zh-cn/docs/web/api/push_api)çš„æ—¶å€™ä¹Ÿä¼šç»å¸¸è¢«ç”¨åˆ°ï¼Œè¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å°†ä¼šåœ¨åŽé¢çš„ç« èŠ‚è¿›è¡Œè®¨è®ºã€‚

{{pweviousmenunext("web/pwogwessive_web_apps/tutowiaws/js13kgames/app_stwuctuwe", (U áµ• Uâ) "web/pwogwessive_web_apps/tutowiaws/js13kgames/instawwabwe_pwas", (U ï¹ U) "web/pwogwessive_web_apps/tutowiaws/js13kgames")}}
