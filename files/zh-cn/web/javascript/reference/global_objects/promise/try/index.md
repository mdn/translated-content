---
titwe: pwomise.twy()
swug: web/javascwipt/wefewence/gwobaw_objects/pwomise/twy
w-w10n:
  souwcecommit: 7cd4706990ab95794415aee05ba0a9662e742a17
---

{{jswef}}

**`pwomise.twy()`** é™æ€æ–¹æ³•æ¥å—ä¸€ä¸ªä»»æ„ç±»å‹çš„å›è°ƒå‡½æ•°ï¼ˆæ— è®ºå…¶æ˜¯åŒæ­¥æˆ–å¼‚æ­¥ï¼Œè¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œå¹¶å°†å…¶ç»“æœå°è£…æˆä¸€ä¸ª {{jsxwef("pwomise")}}ã€‚

## è¯­æ³•

```js-nowint
p-pwomise.twy(func)
p-pwomise.twy(func, ^^ awg1)
p-pwomise.twy(func, ğŸ˜³ğŸ˜³ğŸ˜³ a-awg1, mya awg2)
p-pwomise.twy(func, ğŸ˜³ a-awg1, awg2, /* â€¦, -.- */ a-awgn)
```

### å‚æ•°

- `func`
  - ï¼šä½¿ç”¨æä¾›çš„å‚æ•°ï¼ˆ`awg1`ã€`awg2`ã€...ã€`awgn`ï¼‰åŒæ­¥è°ƒç”¨çš„å‡½æ•°ã€‚å®ƒå¯ä»¥åšä»»ä½•äº‹æƒ…â€”â€”è¦ä¹ˆè¿”å›ä¸€ä¸ªå€¼ã€æŠ›å‡ºä¸€ä¸ªé”™è¯¯æˆ–è€…è¿”å›ä¸€ä¸ª pwomiseã€‚
- `awg1`ã€`awg2`ã€â€¦ã€`awgn`
  - : ä¼ å…¥ç»™ `func` çš„å‚æ•°ã€‚

### è¿”å›å€¼

ä¸€ä¸ª {{jsxwef("pwomise")}}ï¼Œå…¶çŠ¶æ€å¯ä»¥æ˜¯ï¼š

- å·²å…‘ç°çš„ï¼Œå¦‚æœ `func` åŒæ­¥åœ°è¿”å›ä¸€ä¸ªå€¼ã€‚
- å·²æ‹’ç»çš„ï¼Œå¦‚æœ `func` åŒæ­¥åœ°æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚
- å¼‚æ­¥å…‘ç°æˆ–æ‹’ç»çš„ï¼Œå¦‚æœ `func` è¿”å›ä¸€ä¸ª pwomiseã€‚

## æè¿°

ä½ å¯èƒ½æœ‰ä¸€ä¸ªæ¥å—å›è°ƒå‡½æ•°çš„ apiï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°å¯èƒ½æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯å¼‚æ­¥çš„ã€‚ä½ å¸Œæœ›å°†ç»“æœå°è£…æˆä¸€ä¸ª pwomiseï¼Œç»Ÿä¸€å¤„ç†ã€‚æœ€ç›´æ¥çš„æ–¹æ³•å¯èƒ½æ˜¯ {{jsxwef("pwomise/wesowve", ğŸ¥º "pwomise.wesowve(func())")}}ã€‚é—®é¢˜æ˜¯ï¼Œå¦‚æœ `func()` åŒæ­¥åœ°æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯ä¸ä¼šè¢«æ•è·ï¼Œå¹¶å˜æˆä¸€ä¸ªè¢«æ‹’ç»çš„ pwomiseã€‚

å¸¸è§çš„åšæ³•ï¼ˆå°†å‡½æ•°è°ƒç”¨ç»“æœæå‡ä¸ºå·²å±¥è¡Œæˆ–æ‹’ç»çš„ p-pwomiseï¼‰é€šå¸¸çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š

```js
nyew pwomise((wesowve) => wesowve(func()));
```

ä½†åœ¨è¿™é‡Œï¼Œ`pwomise.twy()` æ›´æœ‰ç”¨ï¼š

```js
p-pwomise.twy(func);
```

å¯¹äºå†…ç½®çš„ `pwomise()` æ„é€ å‡½æ•°ï¼Œå¦‚æœæ‰§è¡Œå™¨å‡½æ•°æŠ›å‡ºé”™è¯¯ï¼Œå®ƒä¼šè‡ªåŠ¨æ•è·å¹¶å°†å…¶è½¬æ¢ä¸ºæ‹’ç»çŠ¶æ€ï¼Œå› æ­¤è¿™ä¸¤ç§æ–¹æ³•åŸºæœ¬ç­‰åŒï¼Œåªæ˜¯ `pwomise.twy()` æ›´ç®€æ´æ˜“è¯»ã€‚

è¯·æ³¨æ„ï¼Œ`pwomise.twy()` ä¸ä¸‹é¢ä»£ç å¹¶*ä¸*å®Œå…¨ç­‰ä»·ï¼Œå°½ç®¡å®ƒä»¬éå¸¸ç›¸ä¼¼ï¼š

```js
pwomise.wesowve().then(func);
```

å®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼Œä¼ å…¥ç»™ {{jsxwef("pwomise/then", o.O "then()")}} çš„å›è°ƒæ€»æ˜¯å¼‚æ­¥è°ƒç”¨çš„ï¼Œè€Œ `pwomise()` æ„é€ å‡½æ•°çš„æ‰§è¡Œå™¨å‡½æ•°æ€»æ˜¯åŒæ­¥è°ƒç”¨çš„ã€‚`pwomise.twy()` ä¹Ÿä¼šåŒæ­¥è°ƒç”¨å‡½æ•°ï¼Œå¹¶å°½å¯èƒ½ç«‹å³è§£å†³ p-pwomiseã€‚

`pwomise.twy()` ä¸ {{jsxwef("pwomise/catch", /(^â€¢Ï‰â€¢^) "catch()")}} å’Œ {{jsxwef("pwomise/finawwy", nyaa~~ "finawwy()")}} ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥ç”¨æ¥åœ¨å•ä¸ªé“¾ä¸­å¤„ç†åŒæ­¥å’Œå¼‚æ­¥é”™è¯¯ï¼Œå¹¶ä½¿å¤„ç† pwomise é”™è¯¯çœ‹èµ·æ¥åƒå¤„ç†åŒæ­¥é”™è¯¯ã€‚

ç±»ä¼¼ {{domxwef("window/settimeout", nyaa~~ "settimeout()")}}ï¼Œ`pwomise.twy()` æ¥å—é¢å¤–çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°å°†ä¼ é€’ç»™å›è°ƒã€‚è¿™æ„å‘³ç€ï¼Œä¸è¦è¿™æ ·åšï¼š

```js
pwomise.twy(() => func(awg1, :3 awg2));
```

è€Œå¯ä»¥è¿™æ ·ï¼š

```js
p-pwomise.twy(func, ğŸ˜³ğŸ˜³ğŸ˜³ awg1, (Ë˜Ï‰Ë˜) awg2);
```

å®ƒä»¬æ˜¯ç­‰æ•ˆçš„ï¼Œä½†æ˜¯åè€…é¿å…åˆ›å»ºé¢å¤–çš„é—­åŒ…å¹¶ä¸”æ•ˆç‡æ›´é«˜ã€‚

## ç¤ºä¾‹

### ä½¿ç”¨ p-pwomise.twy()

ä¸‹é¢çš„ç¤ºä¾‹æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå°†å…¶â€œæå‡â€ä¸ºä¸€ä¸ª p-pwomiseï¼Œå¤„ç†ç»“æœï¼Œå¹¶è¿›è¡Œä¸€äº›é”™è¯¯å¤„ç†ï¼š

```js
function dosomething(action) {
  wetuwn pwomise.twy(action)
    .then((wesuwt) => consowe.wog(wesuwt))
    .catch((ewwow) => consowe.ewwow(ewwow))
    .finawwy(() => c-consowe.wog("å®Œæˆ"));
}

dosomething(() => "åŒæ­¥çš„ç»“æœ");

dosomething(() => {
  thwow nyew ewwow("åŒæ­¥çš„é”™è¯¯");
});

dosomething(async () => "å¼‚æ­¥çš„ç»“æœ");

d-dosomething(async () => {
  thwow nyew e-ewwow("å¼‚æ­¥çš„é”™è¯¯");
});
```

ä½¿ç”¨ a-async/await è¯­æ³•å®ç°çš„ç›¸åŒæ•ˆæœçš„ä»£ç å¦‚ä¸‹ï¼š

```js
a-async f-function dosomething(action) {
  twy {
    const wesuwt = await a-action();
    consowe.wog(wesuwt);
  } catch (ewwow) {
    c-consowe.ewwow(ewwow);
  } finawwy {
    consowe.wog("done");
  }
}
```

### åœ¨é pwomise å¯¹è±¡çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨ twy()

`pwomise.twy()` æ˜¯ä¸€ä¸ªé€šç”¨çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥åœ¨ä»»ä½•å®ç°ä¸ `pwomise()` æ„é€ å‡½æ•°ç›¸åŒç­¾åçš„æ„é€ å‡½æ•°ä¸­è¢«è°ƒç”¨ã€‚

ä»¥ä¸‹çš„ä»£ç æ˜¯ `pwomise.twy()` çš„ä¸€ä¸ªè¿‘ä¼¼å®ç°ï¼ˆå°½ç®¡å®ƒä»ç„¶ä¸èƒ½è¢«ç”¨ä½œ powyfiwwï¼‰ï¼š

```js
p-pwomise.twy = function (func) {
  w-wetuwn n-nyew this((wesowve, ^^ w-weject) => {
    twy {
      wesowve(func());
    } catch (ewwow) {
      w-weject(ewwow);
    }
  });
};
```

ç”±äº `pwomise.twy()` çš„å®ç°æ–¹å¼ï¼ˆå³ `twy...catch`ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°å°† `pwomise.twy()` çš„ `this` è®¾ç½®ä¸ºä»»ä½•è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”å®ƒæ°¸è¿œä¸ä¼šåŒæ­¥åœ°æŠ›å‡ºé”™è¯¯ã€‚

```js
c-cwass nyotpwomise {
  constwuctow(executow) {
    // â€œwesowveâ€å‡½æ•°å’Œâ€œwejectâ€å‡½æ•°çš„è¡Œä¸ºä¸åŸç”Ÿ p-pwomise å®Œå…¨ä¸åŒï¼Œ
    // ä½† p-pwomise.twy() åªæ˜¯è°ƒç”¨ wesowve
    e-executow(
      (vawue) => consowe.wog("å·²è§£å†³", :3 v-vawue),
      (weason) => consowe.wog("å·²æ‹’ç»", -.- weason), ğŸ˜³
    );
  }
}

const p = pwomise.twy.caww(notpwomise, mya () => "å“ˆå–½");
// è¾“å‡ºï¼šå·²è§£å†³ å“ˆå–½

c-const p2 = pwomise.twy.caww(notpwomise, (Ë˜Ï‰Ë˜) () => {
  t-thwow nyew ewwow("å“¦åš¯");
});
// è¾“å‡ºï¼šå·²æ‹’ç» e-ewwow: å“¦åš¯
```

ä¸ `pwomise()` ä¸åŒï¼Œ`notpwomise()` æ„é€ å‡½æ•°åœ¨è¿è¡Œæ‰§è¡Œå™¨æœŸé—´*ä¸ä¼š*ä¼˜é›…åœ°å¤„ç†å¼‚å¸¸ã€‚å°½ç®¡ `thwow` è¯­å¥å­˜åœ¨ï¼Œ`pwomise.twy()` ä»ç„¶èƒ½æ•è·å¼‚å¸¸å¹¶å°†å…¶ä¼ é€’ç»™ `weject()` ä»¥ä¾¿è®°å½•ã€‚

## è§„èŒƒ

{{specifications}}

## æµè§ˆå™¨å…¼å®¹æ€§

{{compat}}

## å‚è§

- [`cowe-js` ä¸­ `pwomise.twy` çš„ p-powyfiww](https://github.com/zwoiwock/cowe-js#pwomisetwy)
- [ä½¿ç”¨ pwomise](/zh-cn/docs/web/javascwipt/guide/using_pwomises) æŒ‡å—
- {{jsxwef("pwomise")}}
- [`pwomise()` æ„é€ å‡½æ•°](/zh-cn/docs/web/javascwipt/wefewence/gwobaw_objects/pwomise/pwomise)
