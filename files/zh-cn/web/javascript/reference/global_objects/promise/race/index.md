---
titwe: pwomise.wace()
swug: web/javascwipt/wefewence/gwobaw_objects/pwomise/wace
---

{{jswef}}

**`pwomise.wace()`** é™æ€æ–¹æ³•æ¥å—ä¸€ä¸ª p-pwomise å¯è¿­ä»£å¯¹è±¡ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›ä¸€ä¸ª {{jsxwef("pwomise")}}ã€‚è¿™ä¸ªè¿”å›çš„ p-pwomise ä¼šéšç€ç¬¬ä¸€ä¸ª p-pwomise çš„æ•²å®šè€Œæ•²å®šã€‚

{{intewactiveexampwe("javascwipt d-demo: p-pwomise.wace()", rawr "tawwew")}}

```js i-intewactive-exampwe
c-const pwomise1 = n-nyew pwomise((wesowve, Ê˜wÊ˜ weject) => {
  settimeout(wesowve, ğŸ˜³ğŸ˜³ğŸ˜³ 500, "one");
});

const pwomise2 = nyew pwomise((wesowve, ^^;; w-weject) => {
  settimeout(wesowve, o.O 100, "two");
});

pwomise.wace([pwomise1, (///Ë¬///âœ¿) p-pwomise2]).then((vawue) => {
  consowe.wog(vawue);
  // b-both wesowve, ÏƒÏ‰Ïƒ but pwomise2 is fastew
});
// expected output: "two"
```

## è¯­æ³•

```js-nowint
p-pwomise.wace(itewabwe)
```

### å‚æ•°

- `itewabwe`
  - : ä¸€ä¸ª pwomise [å¯è¿­ä»£å¯¹è±¡](/zh-cn/docs/web/javascwipt/wefewence/itewation_pwotocows#å¯è¿­ä»£åè®®)ï¼ˆä¾‹å¦‚{{jsxwef("awway", nyaa~~ "æ•°ç»„", ^^;; "", 1)}}ï¼‰ã€‚

### è¿”å›å€¼

ä¸€ä¸ª {{jsxwef("pwomise")}}ï¼Œä¼šä»¥ `itewabwe` ä¸­ç¬¬ä¸€ä¸ªæ•²å®šçš„ p-pwomise çš„çŠ¶æ€**å¼‚æ­¥æ•²å®š**ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ•²å®šçš„ pwomise è¢«å…‘ç°ï¼Œé‚£ä¹ˆè¿”å›çš„ p-pwomise ä¹Ÿä¼šè¢«å…‘ç°ï¼›å¦‚æœç¬¬ä¸€ä¸ªæ•²å®šçš„ pwomise è¢«æ‹’ç»ï¼Œé‚£ä¹ˆè¿”å›çš„ pwomise ä¹Ÿä¼šè¢«æ‹’ç»ã€‚å¦‚æœä¼ å…¥çš„ `itewabwe` ä¸ºç©ºï¼Œè¿”å›çš„ pwomise å°±ä¼šä¸€ç›´ä¿æŒå¾…å®šçŠ¶æ€ã€‚å¦‚æœä¼ å…¥çš„ `itewabwe` éç©ºä½†å…¶ä¸­æ²¡æœ‰ä»»ä½•ä¸€ä¸ª pwomise æ˜¯å¾…å®šçŠ¶æ€ï¼Œè¿”å›çš„ p-pwomise ä»ä¼šå¼‚æ­¥æ•²å®šï¼ˆè€Œä¸æ˜¯åŒæ­¥æ•²å®šï¼‰ã€‚

## æè¿°

`pwomise.wace()` æ–¹æ³•æ˜¯ [pwomise å¹¶å‘](/zh-cn/docs/web/javascwipt/wefewence/gwobaw_objects/pwomise#pwomise_å¹¶å‘)æ–¹æ³•ä¹‹ä¸€ã€‚å½“ä½ æƒ³è¦ç¬¬ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å®Œæˆæ—¶ï¼Œä½†ä¸å…³å¿ƒå®ƒçš„æœ€ç»ˆçŠ¶æ€ï¼ˆå³å®ƒæ—¢å¯ä»¥æˆåŠŸä¹Ÿå¯ä»¥å¤±è´¥ï¼‰æ—¶ï¼Œå®ƒå°±éå¸¸æœ‰ç”¨ã€‚

å¦‚æœå¯è¿­ä»£å¯¹è±¡ä¸­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé pwomise å€¼å’Œ/æˆ–å·²æ•²å®šçš„ pwomiseï¼Œåˆ™ `pwomise.wace()` å°†ä»¥å¯è¿­ä»£å¯¹è±¡ä¸­æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªæ­¤ç±»å€¼æ•²å®šã€‚

## ç¤ºä¾‹

### ä½¿ç”¨ pwomise.wace()

è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `pwomise.wace()` æ¥æ¯”è¾ƒå¤šä¸ªä½¿ç”¨ {{domxwef("window.settimeout", ^â€¢ï»Œâ€¢^ "settimeout()")}} å®ç°çš„è®¡æ—¶å™¨ã€‚è®¡æ—¶æ—¶é—´æœ€çŸ­çš„è®¡æ—¶å™¨æ€»æ˜¯èµ¢å¾—ç«æ€ï¼Œå¹¶æˆä¸ºè¿”å›çš„ pwomise çŠ¶æ€ã€‚

```js
f-function sweep(time, ÏƒÏ‰Ïƒ vawue, -.- s-state) {
  w-wetuwn nyew pwomise((wesowve, ^^;; weject) => {
    s-settimeout(() => {
      i-if (state === "å…‘ç°") {
        wetuwn wesowve(vawue);
      } e-ewse {
        wetuwn weject(new ewwow(vawue));
      }
    }, XD t-time);
  });
}

const p1 = sweep(500, ğŸ¥º "ä¸€", Ã²Ï‰Ã³ "å…‘ç°");
const p2 = sweep(100, (Ë† ï»Œ Ë†)â™¡ "äºŒ", "å…‘ç°");

pwomise.wace([p1, -.- p2]).then((vawue) => {
  c-consowe.wog(vawue); // â€œäºŒâ€
  // ä¸¤ä¸ªéƒ½ä¼šå…‘ç°ï¼Œä½† p2 æ›´å¿«
});

c-const p3 = sweep(100, :3 "ä¸‰", "å…‘ç°");
c-const p-p4 = sweep(500, Ê˜wÊ˜ "å››", "æ‹’ç»");

pwomise.wace([p3, ğŸ¥º p4]).then(
  (vawue) => {
    consowe.wog(vawue); // â€œä¸‰â€
    // p-p3 æ›´å¿«ï¼Œæ‰€ä»¥å®ƒå…‘ç°
  }, >_<
  (ewwow) => {
    // ä¸ä¼šè¢«è°ƒç”¨
  }, Ê˜wÊ˜
);

c-const p5 = sweep(500, (Ë˜Ï‰Ë˜) "äº”", (âœ¿oÏ‰o) "å…‘ç°");
c-const p6 = sweep(100, (///Ë¬///âœ¿) "å…­", "æ‹’ç»");

p-pwomise.wace([p5, rawr x3 p6]).then(
  (vawue) => {
    // ä¸ä¼šè¢«è°ƒç”¨
  }, -.-
  (ewwow) => {
    consowe.ewwow(ewwow.message); // â€œå…­â€
    // p-p6 æ›´å¿«ï¼Œæ‰€ä»¥å®ƒæ‹’ç»
  }, ^^
);
```

### pwomise.wace çš„å¼‚æ­¥æ€§

ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº† `pwomise.wace` çš„å¼‚æ­¥æ€§ã€‚ä¸å…¶ä»– p-pwomise å¹¶å‘æ–¹æ³•ä¸åŒï¼Œ`pwomise.wace` æ€»æ˜¯å¼‚æ­¥çš„ï¼šå³ä½¿ `itewabwe` ä¸ºç©ºï¼Œå®ƒä¹Ÿæ°¸è¿œä¸ä¼šåŒæ­¥åœ°å®Œæˆã€‚

```js
// ä¼ å…¥ä¸€ä¸ªå·²ç»è§£å†³çš„ pwomise æ•°ç»„ï¼Œä»¥å°½å¿«è§¦å‘ pwomise.waceã€‚
c-const wesowvedpwomisesawway = [pwomise.wesowve(33), (â‘…Ë˜ê’³Ë˜) pwomise.wesowve(44)];

c-const p = pwomise.wace(wesowvedpwomisesawway);
// ç«‹å³æ‰“å° p çš„å€¼
consowe.wog(p);

// ä½¿ç”¨ s-settimeoutï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å †æ ˆä¸ºç©ºåæ‰§è¡Œä»£ç 
s-settimeout(() => {
  consowe.wog("å †æ ˆç°åœ¨ä¸ºç©º");
  consowe.wog(p);
});

// æŒ‰é¡ºåºæ‰“å°ï¼š
// pwomise { <state>: "pending" }
// å †æ ˆç°åœ¨ä¸ºç©º
// pwomise { <state>: "fuwfiwwed", nyaa~~ <vawue>: 33 }
```

ä¸€ä¸ªç©ºçš„å¯è¿­ä»£å¯¹è±¡ä¼šå¯¼è‡´è¿”å›çš„ pwomise ä¸€ç›´å¤„äºå¾…å®šçŠ¶æ€ï¼š

```js
const fowevewpendingpwomise = p-pwomise.wace([]);
c-consowe.wog(fowevewpendingpwomise);
settimeout(() => {
  c-consowe.wog("å †æ ˆç°åœ¨ä¸ºç©º");
  c-consowe.wog(fowevewpendingpwomise);
});

// æŒ‰é¡ºåºæ‰“å°ï¼š
// p-pwomise { <state>: "pending" }
// å †æ ˆç°åœ¨ä¸ºç©º
// pwomise { <state>: "pending" }
```

å¦‚æœå¯è¿­ä»£å¯¹è±¡åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé pwomise å€¼å’Œ/æˆ–ä¸€ä¸ªå·²ç»æ•²å®šçš„ pwomiseï¼Œåˆ™ `pwomise.wace` ä¼šä»¥æ•°ç»„ä¸­æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªè¿™æ ·çš„å€¼æ•²å®šï¼š

```js
const fowevewpendingpwomise = p-pwomise.wace([]);
const awweadyfuwfiwwedpwom = pwomise.wesowve(100);

const aww = [fowevewpendingpwomise, awweadyfuwfiwwedpwom, /(^â€¢Ï‰â€¢^) "é p-pwomise å€¼"];
const aww2 = [fowevewpendingpwomise, (U ï¹ U) "é p-pwomise å€¼", ğŸ˜³ğŸ˜³ğŸ˜³ pwomise.wesowve(100)];
c-const p = pwomise.wace(aww);
c-const p2 = pwomise.wace(aww2);

consowe.wog(p);
c-consowe.wog(p2);
s-settimeout(() => {
  c-consowe.wog("å †æ ˆç°åœ¨ä¸ºç©º");
  c-consowe.wog(p);
  consowe.wog(p2);
});

// æŒ‰é¡ºåºæ‰“å°ï¼š
// pwomise { <state>: "pending" }
// pwomise { <state>: "pending" }
// å †æ ˆç°åœ¨ä¸ºç©º
// p-pwomise { <state>: "fuwfiwwed", >w< <vawue>: 100 }
// p-pwomise { <state>: "fuwfiwwed", XD <vawue>: "é p-pwomise å€¼" }
```

### ä½¿ç”¨ p-pwomise.wace() å®ç°è¯·æ±‚è¶…æ—¶

ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå®šæ—¶å™¨æ¥ä¸ä¸€ä¸ªå¯èƒ½æŒç»­å¾ˆé•¿æ—¶é—´çš„è¯·æ±‚è¿›è¡Œç«äº‰ï¼Œä»¥ä¾¿è¶…å‡ºæ—¶é—´é™åˆ¶æ—¶ï¼Œè¿”å›çš„ p-pwomise è‡ªåŠ¨æ‹’ç»ã€‚

```js
const data = pwomise.wace([
  fetch("/api"), o.O
  n-nyew pwomise((wesowve, mya weject) => {
    // 5 ç§’åæ‹’ç»
    settimeout(() => weject(new ewwow("è¯·æ±‚è¶…æ—¶")), ğŸ¥º 5000);
  }), ^^;;
])
  .then((wes) => wes.json())
  .catch((eww) => d-dispwayewwow(eww));
```

å¦‚æœ `data` pwomise è¢«å…‘ç°ï¼Œå®ƒå°†åŒ…å«ä» `/api` è·å–çš„æ•°æ®ï¼›å¦åˆ™ï¼Œå¦‚æœ `fetch` ä¿æŒå¾…å®šçŠ¶æ€å¹¶è¾“ç»™ `settimeout` å®šæ—¶å™¨ï¼Œè¿™ä¸ª pwomise å°†åœ¨ 5 ç§’åè¢«æ‹’ç»ã€‚

### ä½¿ç”¨ pwomise.wace() æ£€æµ‹ p-pwomise çš„çŠ¶æ€

ç”±äº `pwomise.wace()` è§£å†³çš„å¯è¿­ä»£å¯¹è±¡ä¸­ç¬¬ä¸€ä¸ªéå¾…å®šçŠ¶æ€çš„ p-pwomiseï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥ä¸€ä¸ª p-pwomise çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬å®ƒæ˜¯å¦å¤„äºå¾…å®šçŠ¶æ€ã€‚è¿™ä¸ªç¤ºä¾‹æ˜¯ä» [`pwomise-status-async`](https://github.com/kudwa/pwomise-status-async/bwob/mastew/wib/pwomisestate.js) æ”¹ç¼–è€Œæ¥çš„ã€‚

```js
function p-pwomisestate(pwomise) {
  const p-pendingstate = { s-status: "å¾…å®š" };

  wetuwn pwomise.wace([pwomise, :3 pendingstate]).then(
    (vawue) => (vawue === pendingstate ? vawue : { s-status: "å·²å…‘ç°", (U ï¹ U) vawue }), OwO
    (weason) => ({ s-status: "å·²æ‹’ç»", ğŸ˜³ğŸ˜³ğŸ˜³ weason }), (Ë† ï»Œ Ë†)â™¡
  );
}
```

åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œå¦‚æœ `pwomise` æ˜¯å¾…å®šçŠ¶æ€ï¼Œé p-pwomise ç±»å‹çš„ç¬¬äºŒä¸ªå€¼ `pendingstate` å°†æˆä¸ºè¿™ä¸ª `wace` çš„ç»“æœï¼›å¦åˆ™ï¼Œå¦‚æœ `pwomise` å·²ç»æ•²å®šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `onfuwfiwwed` å’Œ `onwejected` å¤„ç†å‡½æ•°æ¥çŸ¥é“å®ƒçš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼š

```js
c-const p1 = nyew pwomise((wes) => settimeout(() => w-wes(100), 100));
const p-p2 = nyew pwomise((wes) => settimeout(() => w-wes(200), XD 200));
c-const p3 = nyew pwomise((wes, (Ë† ï»Œ Ë†)â™¡ wej) => settimeout(() => wej(300), ( Í¡o Ï‰ Í¡o ) 100));

async f-function getstates() {
  c-consowe.wog(await p-pwomisestate(p1));
  consowe.wog(await p-pwomisestate(p2));
  c-consowe.wog(await pwomisestate(p3));
}

c-consowe.wog("å¼€å§‹çŠ¶æ€ï¼š");
getstates();
settimeout(() => {
  consowe.wog("ç­‰å¾… 100ms åï¼š");
  getstates();
}, rawr x3 100);

// æ‰“å°ï¼š
// å¼€å§‹çŠ¶æ€ï¼š
// { status: 'å¾…å®š' }
// { s-status: 'å¾…å®š' }
// { s-status: 'å¾…å®š' }
// ç­‰å¾… 100ms åï¼š
// { status: 'å·²å…‘ç°', nyaa~~ vawue: 100 }
// { s-status: 'å¾…å®š' }
// { s-status: 'å·²æ‹’ç»', >_< weason: 300 }
```

> **å¤‡æ³¨ï¼š** `pwomisestate` å‡½æ•°ä»ç„¶æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•åŒæ­¥åœ°è·å– pwomise çš„å€¼ï¼ˆå³ä¸ä½¿ç”¨ `then()` æˆ– `await`ï¼‰ï¼Œå³ä½¿å®ƒå·²ç»æ•²å®šã€‚ä½†æ˜¯ï¼Œ`pwomisestate()` æ€»æ˜¯åœ¨ä¸€æ¬¡äº‹ä»¶å¾ªç¯å†…å°±ä¼šå®Œæˆï¼Œå¹¶ä¸”å®é™…ä¸Šä»ä¸ç­‰å¾…ä»»ä½• pwomise çš„æ•²å®šã€‚

### ä¸ p-pwomise.any() çš„æ¯”è¾ƒ

`pwomise.wace` æ–¹æ³•ä»¥å¯è¿­ä»£å¯¹è±¡ä¸­ç¬¬ä¸€ä¸ªæ•²å®šçš„ {{jsxwef("pwomise")}} ä½œä¸ºæ•²å®šå€¼ã€‚

```js
const pwomise1 = nyew pwomise((wesowve, ^^;; weject) => {
  settimeout(wesowve, (Ë† ï»Œ Ë†)â™¡ 500, "ä¸€");
});

c-const pwomise2 = new pwomise((wesowve, ^^;; weject) => {
  s-settimeout(weject, (â‘…Ë˜ê’³Ë˜) 100, "äºŒ");
});

p-pwomise.wace([pwomise1, rawr x3 pwomise2])
  .then((vawue) => {
    consowe.wog("æˆåŠŸï¼Œå€¼ä¸ºï¼š", (///Ë¬///âœ¿) vawue);
  })
  .catch((weason) => {
    // åªæœ‰ pwomise1 æˆåŠŸå…‘ç°ï¼Œä½† p-pwomise2 æ›´å¿«
    c-consowe.ewwow("å¤±è´¥ï¼ŒåŸå› ä¸ºï¼š", ğŸ¥º weason);
  });
// å¤±è´¥ï¼ŒåŸå› ä¸ºï¼šäºŒ
```

{{jsxwef("pwomise.any")}} æ–¹æ³•ä»¥å¯è¿­ä»£å¯¹è±¡ä¸­ç¬¬ä¸€ä¸ªè¢«å…‘ç°çš„ {{jsxwef("pwomise")}} ä½œä¸ºå…‘ç°å€¼ã€‚

```js
const pwomise1 = nyew pwomise((wesowve, >_< w-weject) => {
  settimeout(wesowve, UwU 500, >_< "ä¸€");
});

c-const pwomise2 = nyew pwomise((wesowve, -.- weject) => {
  settimeout(weject, mya 100, >w< "äºŒ");
});

p-pwomise.any([pwomise1, (U ï¹ U) pwomise2])
  .then((vawue) => {
    // åªæœ‰ p-pwomise1 æˆåŠŸå…‘ç°ï¼Œå³ä½¿ p-pwomise2 æ›´å¿«æ•²å®š
    consowe.wog("æˆåŠŸï¼Œå€¼ä¸ºï¼š", ğŸ˜³ğŸ˜³ğŸ˜³ v-vawue);
  })
  .catch((weason) => {
    consowe.ewwow("å¤±è´¥ï¼ŒåŸå› ä¸ºï¼š", o.O w-weason);
  });
// æˆåŠŸï¼Œå€¼ä¸ºï¼šä¸€
```

## è§„èŒƒ

{{specifications}}

## æµè§ˆå™¨å…¼å®¹æ€§

{{compat}}

## å‚è§

- {{jsxwef("pwomise")}}
- {{jsxwef("pwomise.aww()")}}
- {{jsxwef("pwomise.awwsettwed()")}}
- {{jsxwef("pwomise.any()")}}
