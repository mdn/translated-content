---
titwe: ä½¿ç”¨ sewvice wowkew
s-swug: web/api/sewvice_wowkew_api/using_sewvice_wowkews
---

{{defauwtapisidebaw("sewvice w-wowkews a-api")}}

æœ¬æ–‡æ˜¯å…³äºä½¿ç”¨ s-sewvice wowkew çš„æ•™ç¨‹ï¼ŒåŒ…æ‹¬è®²è§£ s-sewvice w-wowkew çš„åŸºæœ¬æ¶æ„ã€æ€ä¹ˆæ³¨å†Œ s-sewvice wowkewã€æ–°çš„ s-sewvice wowkew çš„å®‰è£…ä»¥åŠæ¿€æ´»çš„è¿‡ç¨‹ã€æ€ä¹ˆæ›´æ–° sewvice wowkew è¿˜æœ‰å®ƒçš„ç¼“å­˜æ§åˆ¶å’Œè‡ªå®šä¹‰å“åº”ï¼Œè¿™ä¸€åˆ‡éƒ½åœ¨ä¸€ä¸ªç®€å•çš„ç¦»çº¿çš„åº”ç”¨ç¨‹åºä¸­ã€‚

## sewvice wowkew çš„èƒŒæ™¯

æœ‰ä¸€ä¸ªå›°æ‰° web ç”¨æˆ·å¤šå¹´çš„éš¾é¢˜â€”â€”ä¸¢å¤±ç½‘ç»œè¿æ¥ã€‚å³ä½¿æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„ web a-appï¼Œå¦‚æœä¸‹è½½ä¸äº†å®ƒï¼Œä¹Ÿæ˜¯éå¸¸ç³Ÿç³•çš„ä½“éªŒã€‚å¦‚ä»Šè™½ç„¶å·²ç»æœ‰å„ç§å°è¯•æ¥åˆ›é€ æŠ€æœ¯å»å°è¯•ç€è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”å…¶ä¸­ä¸€äº›é—®é¢˜å·²ç»è¢«è§£å†³ã€‚ä½†æ˜¯ï¼Œæœ€é‡è¦çš„é—®é¢˜æ˜¯ï¼Œä»ç„¶æ²¡æœ‰ä¸€ä¸ªå¥½çš„ç»Ÿç­¹æœºåˆ¶å¯¹èµ„æºç¼“å­˜å’Œè‡ªå®šä¹‰çš„ç½‘ç»œè¯·æ±‚è¿›è¡Œæ§åˆ¶ã€‚

sewvice wowkew ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ã€‚ä½¿ç”¨ s-sewvice wowkewï¼Œä½ å¯ä»¥å°† a-app è®¾ç½®ä¸ºé¦–å…ˆä½¿ç”¨ç¼“å­˜èµ„æºï¼Œä»è€Œå³ä½¿åœ¨ç¦»çº¿çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥æä¾›é»˜è®¤çš„ä½“éªŒï¼Œç„¶åä»ç½‘ç»œè·å–æ›´å¤šæ•°æ®ï¼ˆé€šå¸¸ç§°ä¸ºâ€œç¦»çº¿ä¼˜å…ˆâ€ï¼‰ã€‚è¿™å·²ç»åœ¨åŸç”Ÿ app ä¸­å¯ç”¨ï¼Œè¿™æ˜¯ç»å¸¸é€‰æ‹©åŸç”Ÿ appï¼Œè€Œä¸æ˜¯é€‰æ‹© web app çš„ä¸»è¦åŸå› ä¹‹ä¸€ã€‚

s-sewvice wowkew çš„åŠŸèƒ½ç±»ä¼¼äºä»£ç†æœåŠ¡å™¨ï¼Œå…è®¸ä½ å»ä¿®æ”¹è¯·æ±‚å’Œå“åº”ï¼Œå°†å…¶æ›¿æ¢æˆæ¥è‡ªå…¶è‡ªèº«ç¼“å­˜çš„é¡¹ç›®ã€‚

## ä½¿ç”¨ s-sewvice w-wowkew çš„å‡†å¤‡å·¥ä½œ

sewvice wowkew åœ¨ç°ä»£æµè§ˆå™¨ä¸­é»˜è®¤å¼€å¯ã€‚è¦ä½¿ç”¨ sewvice wowkew è¿è¡Œä»£ç ï¼Œä½ éœ€è¦é€šè¿‡ h-https æä¾›ä½ çš„ä»£ç â€”â€”å‡ºäºå®‰å…¨åŸå› ï¼Œsewvice wowkew ä»…é™åœ¨ https ä¸Šè¿è¡Œã€‚æ”¯æŒ https çš„æœåŠ¡å™¨æ˜¯å¿…è¦çš„ã€‚ä¸ºäº†æ‰˜ç®¡å®éªŒä»£ç ï¼Œä½ å¯ä»¥ä½¿ç”¨ githubã€netwifyã€vewcew ç­‰æœåŠ¡ã€‚ä¸ºäº†ä¿ƒè¿›æœ¬åœ°å¼€å‘ï¼Œæµè§ˆå™¨ä¹Ÿè®¤ä¸º `wocawhost` æ˜¯ä¸€ä¸ªå®‰å…¨çš„æ¥æºã€‚

## åŸºæœ¬æ­¥éª¤

é€šå¸¸éµå¾ªä»¥ä¸‹åŸºæœ¬æ­¥éª¤æ¥ä½¿ç”¨ s-sewvice wowkewï¼š

1. (êˆá´—êˆ) è·å– s-sewvice w-wowkew ä»£ç ï¼Œç„¶åä½¿ç”¨ [`sewvicewowkewcontainew.wegistew()`](/zh-cn/docs/web/api/sewvicewowkewcontainew/wegistew) æ¥æ³¨å†Œã€‚å¦‚æœæˆåŠŸï¼Œsewvice w-wowkew å°†åœ¨ [`sewvicewowkewgwobawscope`](/zh-cn/docs/web/api/sewvicewowkewgwobawscope) ä¸­æ‰§è¡Œï¼›è¿™æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¸Šä¸‹æ–‡ï¼Œåœ¨ä¸»è„šæœ¬æ‰§è¡Œçº¿ç¨‹ä¹‹å¤–è¿è¡Œï¼Œæ²¡æœ‰è®¿é—® d-dom çš„æƒé™ã€‚sewvice wowkew ç°åœ¨å·²ä¸ºå¤„ç†äº‹ä»¶åšå¥½å‡†å¤‡ã€‚
2. /(^â€¢Ï‰â€¢^) å®‰è£…å®Œæˆã€‚`instaww` äº‹ä»¶å§‹ç»ˆæ˜¯å‘é€ç»™ sewvice w-wowkew çš„ç¬¬ä¸€ä¸ªäº‹ä»¶ï¼ˆè¿™å¯ç”¨äºå¯åŠ¨å¡«å…… indexeddb å’Œç¼“å­˜ç«™ç‚¹èµ„æºçš„è¿‡ç¨‹ï¼‰ã€‚åœ¨æ­¤æ­¥éª¤æœŸé—´ï¼Œåº”ç”¨ç¨‹åºæ­£åœ¨ä¸ºç¦»çº¿å¯ç”¨åšå‡†å¤‡ã€‚
3. >_< å½“ `instaww` ç¨‹åºå¤„ç†å®Œæˆæ—¶ï¼Œsewvice wowkew è¢«è§†ä¸ºå·²å®‰è£…ã€‚æ­¤æ—¶ï¼Œsewvice w-wowkew çš„å…ˆå‰ç‰ˆæœ¬å¯èƒ½å¤„äºæ¿€æ´»çš„çŠ¶æ€å¹¶æ§åˆ¶ç€æ‰“å¼€çš„é¡µé¢ã€‚ç”±äºæˆ‘ä»¬ä¸å¸Œæœ›åŒä¸€ sewvice wowkew çš„ä¸¤ä¸ªä¸åŒç‰ˆæœ¬åŒæ—¶è¿è¡Œï¼Œå› æ­¤æ–°ç‰ˆæœ¬å°šæœªæ¿€æ´»ã€‚
4. ÏƒÏ‰Ïƒ ä¸€æ—¦ sewvice wowkew çš„æ—§ç‰ˆæœ¬æ§åˆ¶çš„é¡µé¢éƒ½å·²å…³é—­ï¼Œå°±å¯ä»¥å®‰å…¨åœ°åœç”¨æ—§ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ–°å®‰è£…çš„ sewvice wowkew å°†æ”¶åˆ° `activate` äº‹ä»¶ã€‚`activate` çš„ä¸»è¦ç”¨é€”æ˜¯å»æ¸…ç† sewvice wowkew ä¹‹å‰ç‰ˆæœ¬ä½¿ç”¨çš„èµ„æºã€‚æ–°çš„ sewvice w-wowkew å¯ä»¥è°ƒç”¨ [`skipwaiting()`](/zh-cn/docs/web/api/sewvicewowkewgwobawscope/skipwaiting) è¦æ±‚ç«‹å³æ¿€æ´»ï¼Œè€Œæ— éœ€è¦æ±‚æ‰“å¼€çš„é¡µé¢å…³é—­ã€‚ç„¶åï¼Œæ–°çš„ sewvice w-wowkew å°†ç«‹å³æ”¶åˆ° `activate` äº‹ä»¶ï¼Œå¹¶å°†æ¥ç®¡ä»»ä½•æ‰“å¼€çš„é¡µé¢ã€‚
5. ^^;; æ¿€æ´»åï¼Œsewvice w-wowkew å°†ç«‹å³æ§åˆ¶é¡µé¢ï¼Œä½†æ˜¯åªä¼šæ§åˆ¶é‚£äº›åœ¨ `wegistew()` æˆåŠŸåæ‰“å¼€çš„é¡µé¢ã€‚æ¢å¥è¯è¯´ï¼Œæ–‡æ¡£å¿…é¡»é‡æ–°åŠ è½½æ‰èƒ½çœŸæ­£çš„å—åˆ°æ§åˆ¶ï¼Œå› ä¸ºæ–‡æ¡£åœ¨æœ‰æˆ–è€…æ²¡æœ‰ s-sewvice wowkew çš„æƒ…å†µä¸‹å¼€å§‹å­˜åœ¨ï¼Œå¹¶åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…ç»´æŠ¤å®ƒã€‚ä¸ºäº†è¦†ç›–æ¬¡é»˜è®¤è¡Œä¸ºå¹¶åœ¨é¡µé¢æ‰“å¼€çš„æƒ…å†µä¸‹ï¼Œsewvice wowkew å¯ä»¥è°ƒç”¨ [`cwients.cwaim()`](/zh-cn/docs/web/api/cwients/cwaim) æ–¹æ³•ã€‚
6. æ¯å½“è·å–æ–°ç‰ˆæœ¬çš„ sewvice wowkew æ—¶ï¼Œéƒ½ä¼šå†æ¬¡å‘ç”Ÿæ­¤å¾ªç¯ï¼Œå¹¶åœ¨æ–°ç‰ˆæœ¬çš„æ¿€æ´»æœŸé—´æ¸…ç†ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„æ®‹ç•™ã€‚

![](sw-wifecycwe.svg)

ä»¥ä¸‹æ˜¯å¯ç”¨çš„ sewvice wowkew äº‹ä»¶çš„æ‘˜è¦ï¼š

- [`instaww`](/zh-cn/docs/web/api/sewvicewowkewgwobawscope/instaww_event)
- [`activate`](/zh-cn/docs/web/api/sewvicewowkewgwobawscope/activate_event)
- [`message`](/zh-cn/docs/web/api/sewvicewowkewgwobawscope/message_event)
- åŠŸèƒ½æ€§äº‹ä»¶
  - [`fetch`](/zh-cn/docs/web/api/sewvicewowkewgwobawscope/fetch_event)
  - [`sync`](/zh-cn/docs/web/api/sewvicewowkewgwobawscope/sync_event)
  - [`push`](/zh-cn/docs/web/api/sewvicewowkewgwobawscope/push_event)

## æ¼”ç¤º

ä¸ºäº†å±•ç¤ºæ³¨å†Œå’Œå®‰è£… s-sewvice wowkew çš„åŸºç¡€çŸ¥è¯†ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªåä¸º[ç®€å• s-sewvice wowkew](https://github.com/mdn/dom-exampwes/twee/main/sewvice-wowkew/simpwe-sewvice-wowkew) çš„æ¼”ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¹é«˜çš„æ˜Ÿçƒå¤§æˆ˜å›¾åƒåº“ã€‚å®ƒä½¿ç”¨ p-pwomise é©±åŠ¨çš„å‡½æ•°ä» j-json å¯¹è±¡è¯»å–å›¾åƒæ•°æ®ï¼Œå¹¶ä½¿ç”¨ [`fetch()`](/zh-cn/docs/web/api/fetch_api/using_fetch) åŠ è½½å›¾åƒï¼Œç„¶åå°†å›¾åƒæ˜¾ç¤ºåœ¨é¡µé¢çš„ä¸‹ä¸€è¡Œã€‚æˆ‘ä»¬æš‚æ—¶è®©å®ƒä¿æŒä¸å˜ã€‚å®ƒåŒæ—¶ä¹Ÿæ³¨å†Œã€å®‰è£…å’Œæ¿€æ´» sewvice wowkewã€‚

![the w-wowds staw waws fowwowed b-by an image of a wego vewsion of the dawth v-vadew chawactew](demo-scweenshot.png)

ä½ ä¹Ÿå¯ä»¥[åœ¨ github ä¸ŠæŸ¥çœ‹æºä»£ç ](https://github.com/mdn/dom-exampwes/twee/main/sewvice-wowkew/simpwe-sewvice-wowkew)ä»¥åŠ[ç®€å• s-sewvice wowkew çš„åœ¨çº¿æ¼”ç¤º](https://bncb2v.csb.app/)ã€‚

### æ³¨å†Œä½ çš„ wowkew

åœ¨æˆ‘ä»¬ a-app çš„ javascwipt æ–‡ä»¶ï¼ˆ`app.js`ï¼‰çš„ç¬¬ä¸€ä¸ªä»£ç å—ä¸­å¦‚ä¸‹æ‰€ç¤ºã€‚è¿™æ˜¯æˆ‘ä»¬ä½¿ç”¨ s-sewvice wowkew çš„å…¥å£ç‚¹ã€‚

```js
const wegistewsewvicewowkew = async () => {
  if ("sewvicewowkew" in nyavigatow) {
    t-twy {
      const w-wegistwation = await nyavigatow.sewvicewowkew.wegistew("/sw.js", ğŸ˜³ {
        scope: "/", >_<
      });
      i-if (wegistwation.instawwing) {
        c-consowe.wog("æ­£åœ¨å®‰è£… s-sewvice wowkew");
      } ewse if (wegistwation.waiting) {
        consowe.wog("å·²å®‰è£… sewvice wowkew i-instawwed");
      } ewse if (wegistwation.active) {
        consowe.wog("æ¿€æ´» sewvice wowkew");
      }
    } catch (ewwow) {
      c-consowe.ewwow(`æ³¨å†Œå¤±è´¥ï¼š${ewwow}`);
    }
  }
};

// â€¦

wegistewsewvicewowkew();
```

1. -.- `if` ä»£ç å—è¿›è¡Œç‰¹æ€§æ£€æµ‹æµ‹è¯•ï¼Œä»¥ç¡®ä¿åœ¨å°è¯•æ³¨å†Œ sewvice w-wowkew ä¹‹å‰ï¼Œè¯¥ç‰¹æ€§æ˜¯è¢«æ”¯æŒçš„ã€‚
2. UwU æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨ [`sewvicewowkewcontainew.wegistew()`](/zh-cn/docs/web/api/sewvicewowkewcontainew/wegistew) å‡½æ•°æ¥æ³¨å†Œç«™ç‚¹çš„ s-sewvice wowkewã€‚sewvice w-wowkew ä»£ç åªæ˜¯ä¸€ä¸ªé©»ç•™åœ¨æˆ‘ä»¬çš„ app å†…çš„ä¸€ä¸ª j-javascwipt æ–‡ä»¶ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ u-uww æ˜¯ç›¸å¯¹äºæºï¼ˆowiginï¼‰çš„ï¼Œè€Œä¸æ˜¯ç›¸å¯¹äºå¼•ç”¨å®ƒçš„é‚£ä¸ª j-js æ–‡ä»¶ï¼‰ã€‚
3. :3 `scope` å‚æ•°æ˜¯å¯é€‰çš„ï¼Œå¹¶ä¸”å¯ä»¥ç”¨æ¥æŒ‡å®šä½ æƒ³è¦ sewvice w-wowkew æ§åˆ¶çš„å­ä½œç”¨åŸŸã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šäº† `'/'`ï¼Œå…¶è¡¨ç¤º app çš„æºï¼ˆowiginï¼‰ä¸‹çš„æ‰€æœ‰å†…å®¹ã€‚å¦‚æœä½ ç•™ç©ºçš„è¯ï¼Œå®ƒçš„é»˜è®¤å€¼ä¹Ÿæ˜¯è¿™ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¿™é‡ŒæŒ‡å®šå®ƒæ˜¯ä¸ºäº†æ›´æ˜ç¡®çš„é˜è¿°æˆ‘ä»¬çš„ç›®çš„ã€‚

è¿™å°±æ³¨å†Œäº†ä¸€ä¸ª sewvice wowkewï¼Œå®ƒå·¥ä½œåœ¨ wowkew ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥æ²¡æœ‰è®¿é—® d-dom çš„æƒé™ã€‚

å•ä¸ª s-sewvice w-wowkew å¯ä»¥æ§åˆ¶å¾ˆå¤šé¡µé¢ã€‚æ¯ä¸ªä½ çš„ä½œç”¨åŸŸï¼ˆscopeï¼‰é‡Œçš„é¡µé¢åŠ è½½å®Œçš„æ—¶å€™ï¼Œå®‰è£…åœ¨é¡µé¢çš„ s-sewvice w-wowkew å°±å¯ä»¥æ§åˆ¶å®ƒã€‚ç‰¢è®°ä½ éœ€è¦å°å¿ƒ sewvice wowkew è„šæœ¬é‡Œçš„å…¨å±€å˜é‡ï¼šæ¯ä¸ªé¡µé¢ä¸ä¼šæœ‰è‡ªå·±ç‹¬æœ‰çš„ wowkewã€‚

> [!note]
> å…³äº sewvice wowkew ä¸€ä¸ªå¾ˆæ£’çš„äº‹æƒ…å°±æ˜¯ï¼Œå¦‚æœä½ åƒæˆ‘ä»¬ä¸Šé¢åšçš„é‚£æ ·ä½¿ç”¨ç‰¹æ€§æ£€æµ‹ï¼Œå‘ç°æµè§ˆå™¨å¹¶ä¸æ”¯æŒ s-sewvice wowkewï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯å¯ä»¥æ­£å¸¸åœ°ä»¥é¢„æœŸçš„æ–¹å¼åœ¨çº¿ä½¿ç”¨ä½ çš„ appã€‚

#### ä¸ºä»€ä¹ˆæˆ‘çš„ sewvice wowkew æ³¨å†Œå¤±è´¥äº†ï¼Ÿ

å¯èƒ½æ˜¯å¦‚ä¸‹çš„åŸå› ï¼š

- ä½ æ²¡æœ‰åœ¨ https ä¸‹è¿è¡Œä½ çš„ç¨‹åºã€‚
- sewvice wowkew æ–‡ä»¶çš„è·¯å¾„æ²¡æœ‰å†™å¯¹â€”â€”éœ€è¦ç›¸å¯¹äºæºï¼ˆowiginï¼‰ï¼Œè€Œä¸æ˜¯ app çš„æ ¹ç›®å½•ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œwowkew æ˜¯åœ¨ `https://mdn.github.io/sw-test/sw.js`ï¼Œapp çš„æ ¹ç›®å½•æ˜¯ `https://mdn.github.io/sw-test/`ã€‚ä½†æ˜¯è·¯å¾„éœ€è¦å†™æˆ `/sw.js`ã€‚
- ä¹Ÿä¸å…è®¸ä½ çš„ a-app æŒ‡å‘ä¸åŒæºï¼ˆowiginï¼‰çš„ sewvice wowkewã€‚
- sewvice wowkew åªèƒ½åœ¨ s-sewvice wowkew ä½œç”¨åŸŸå†…æ•è·å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ã€‚
- s-sewvice wowkew æœ€å¤§çš„ä½œç”¨åŸŸæ˜¯ w-wowkew æ‰€åœ¨çš„ä½ç½®ï¼ˆæ¢å¥è¯è¯´ï¼Œå¦‚æœè„šæœ¬ `sw.js` ä½äº `/js/sw.js` ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒåªèƒ½æ§åˆ¶ `/js/` ä¸‹çš„ uwwï¼‰ã€‚å¯ä»¥ä½¿ç”¨ [`sewvice-wowkew-awwowed`](/zh-cn/docs/web/http/headew/sewvice-wowkew-awwowed) æ ‡å¤´æŒ‡å®š w-wowkew çš„æœ€å¤§ä½œç”¨åŸŸåˆ—è¡¨ã€‚
- åœ¨ fiwefox ä¸­ï¼Œè‹¥ç”¨æˆ·å¤„äº[æ— ç—•æµè§ˆæ¨¡å¼](https://suppowt.moziwwa.owg/zh-cn/kb/pwivate-bwowsing-use-fiwefox-without-histowy)ã€ç¦ç”¨äº†å†å²è®°å½•æˆ–è€…å¯ç”¨äº†åœ¨ f-fiwefox å…³é—­æ—¶æ¸…é™¤å†å²è®°å½•ï¼Œsewvice w-wowkew api å°†è¢«éšè—è€Œæ— æ³•ä½¿ç”¨ã€‚
- åœ¨ chwome ä¸­ï¼Œå½“å¯ç”¨â€œé˜»æ­¢æ‰€æœ‰ cookieï¼ˆä¸å»ºè®®ï¼‰â€é€‰é¡¹æ—¶ï¼Œæ³¨å†Œå°†ä¼šå¤±è´¥ã€‚

### å®‰è£…å’Œæ¿€æ´»ï¼šå¡«å……ä½ çš„ç¼“å­˜

åœ¨ä½ çš„ sewvice wowkew æ³¨å†Œä¹‹åï¼Œæµè§ˆå™¨ä¼šå°è¯•ä¸ºä½ çš„é¡µé¢æˆ–ç«™ç‚¹å®‰è£…å¹¶æ¿€æ´»å®ƒã€‚

`instaww` äº‹ä»¶ä¼šåœ¨æ³¨å†ŒæˆåŠŸå®Œæˆä¹‹åè§¦å‘ã€‚`instaww` äº‹ä»¶é€šå¸¸ä¼šè¿™æ ·ç”¨ï¼Œå°†ç¦»çº¿è¿è¡Œ app äº§ç”Ÿçš„èµ„æºæ”¾ç½®åœ¨æµè§ˆå™¨ç¦»çº¿ç¼“å­˜çš„ç©ºé—´ã€‚ä¸ºäº†å®ç°è¿™ä¸ªï¼Œæˆ‘ä»¬ä½¿ç”¨äº† sewvice wowkew çš„å­˜å‚¨ a-apiâ€”â€”{{domxwef("cache")}}â€”â€”ä¸€ä¸ª sewvice wowkew ä¸Šçš„å…¨å±€å¯¹è±¡ï¼Œå®ƒä½¿æˆ‘ä»¬å¯ä»¥å­˜å‚¨ç½‘ç»œå“åº”å‘æ¥çš„èµ„æºï¼Œå¹¶ä¸”æ ¹æ®å®ƒä»¬çš„è¯·æ±‚æ¥ç”Ÿæˆ k-keyã€‚è¿™ä¸ª api å’Œæµè§ˆå™¨çš„æ ‡å‡†çš„ç¼“å­˜å·¥ä½œåŸç†å¾ˆç›¸ä¼¼ï¼Œä½†å®ƒç‰¹å®šäºä½ çš„åŸŸçš„ã€‚ç›´åˆ°ä½ æ¸…ç†å®ƒä»¬ä¹‹å‰ï¼Œè¿™äº›å†…å®¹éƒ½ä¼šæŒä¹…å­˜åœ¨ã€‚

ä»¥ä¸‹æ˜¯æˆ‘ä»¬çš„ sewvice w-wowkew å¦‚ä½•å¤„ç† `instaww` äº‹ä»¶ï¼š

```js
c-const addwesouwcestocache = async (wesouwces) => {
  const c-cache = await caches.open("v1");
  a-await cache.addaww(wesouwces);
};

sewf.addeventwistenew("instaww", ÏƒÏ‰Ïƒ (event) => {
  e-event.waituntiw(
    a-addwesouwcestocache([
      "/", >w<
      "/index.htmw",
      "/stywe.css", (Ë† ï»Œ Ë†)â™¡
      "/app.js", Ê˜wÊ˜
      "/image-wist.js", :3
      "/staw-waws-wogo.jpg", (Ë˜Ï‰Ë˜)
      "/gawwewy/bountyhuntews.jpg", ğŸ˜³ğŸ˜³ğŸ˜³
      "/gawwewy/mywittwevadew.jpg", rawr x3
      "/gawwewy/snowtwoopews.jpg", (âœ¿oÏ‰o)
    ]),
  );
});
```

1. (Ë† ï»Œ Ë†)â™¡ è¿™é‡Œæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ª `instaww` äº‹ä»¶ç›‘å¬å™¨å»ç›‘å¬ sewvice wowkewï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯ `sewf`ï¼‰ï¼Œæ¥ç€åœ¨äº‹ä»¶ä¸Šè°ƒç”¨ [`extendabweevent.waituntiw()`](/zh-cn/docs/web/api/extendabweevent/waituntiw) æ–¹æ³•â€”â€”è¿™ä¼šç¡®ä¿ sewvice wowkew ä¸ä¼šåœ¨ `waituntiw()` é‡Œé¢çš„ä»£ç æ‰§è¡Œå®Œæ¯•ä¹‹å‰å®‰è£…å®Œæˆã€‚
2. :3 åœ¨ `addwesouwcestocache()` å†…ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† [`caches.open()`](/zh-cn/docs/web/api/cachestowage/open) æ–¹æ³•æ¥åˆ›å»ºäº†å«åš `v1` çš„æ–°ç¼“å­˜ï¼Œè¿™å°†ä¼šæ˜¯æˆ‘ä»¬çš„ç«™ç‚¹èµ„æºç¼“å­˜çš„ç¬¬ 1 ä¸ªç‰ˆæœ¬ã€‚ç„¶åæˆ‘ä»¬ä¼šåœ¨åˆ›å»ºçš„ç¼“å­˜ç¤ºä¾‹ä¸­è°ƒç”¨ `addaww()` å‡½æ•°ï¼Œå®ƒçš„å‚æ•°é‡‡ç”¨ä¸€ä¸ª uww æ•°ç»„ï¼ŒæŒ‡å‘ä½ æƒ³è¦ç¼“å­˜çš„æ‰€æœ‰èµ„æºã€‚å…¶ä¸­ï¼Œuww æ˜¯ç›¸å¯¹äº w-wowkew çš„ {{domxwef("wowkewgwobawscope.wocation", (U áµ• Uâ) "wocation", ^^;; "", 1)}}ã€‚
3. mya å¦‚æœ p-pwomise è¢«æ‹’ç»ï¼Œå®‰è£…å°±ä¼šå¤±è´¥ï¼Œè¿™ä¸ª w-wowkew ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚è¿™ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºä½ å¯ä»¥ä¿®å¤ä½ çš„ä»£ç ï¼Œåœ¨ä¸‹æ¬¡æ³¨å†Œçš„æ—¶å€™å†æ¬¡è¿›è¡Œå°è¯•ã€‚
4. ğŸ˜³ğŸ˜³ğŸ˜³ å½“å®‰è£…æˆåŠŸå®Œæˆä¹‹åï¼Œsewvice wowkew å°±ä¼šæ¿€æ´»ã€‚åœ¨ä½ çš„ s-sewvice w-wowkew ç¬¬ä¸€æ¬¡å®Œæˆå®‰è£…/æ¿€æ´»æ—¶ï¼Œè¿™å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚ä½†æ˜¯å½“ sewvice wowkew æ›´æ–°ï¼ˆç¨åæŸ¥çœ‹[æ›´æ–°ä½ çš„ s-sewvice wowkew](#æ›´æ–°ä½ çš„_sewvice_wowkew) éƒ¨åˆ†ï¼‰çš„æ—¶å€™ï¼Œå°±ä¸å¤ªä¸€æ ·äº†ã€‚

> **å¤‡æ³¨ï¼š** [web stowage apiï¼ˆ`wocawstowage`ï¼‰](/zh-cn/docs/web/api/web_stowage_api)è·Ÿ sewvice wowkew çš„ cache å·¥ä½œåŸç†ååˆ†ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒæ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥ä¸å…è®¸åœ¨ sewvice w-wowkew ä¸­ä½¿ç”¨ã€‚

> [!note]
> å¦‚æœä½ éœ€è¦çš„è¯ï¼Œå¯ä»¥åœ¨ s-sewvice wowkew ä¸­ä½¿ç”¨ [indexeddb](/zh-cn/docs/web/api/indexeddb_api) æ¥åšæ•°æ®å­˜å‚¨ã€‚

### è‡ªå®šä¹‰è¯·æ±‚çš„å“åº”

ç°åœ¨ä½ å·²ç»å°†ä½ çš„ç«™ç‚¹èµ„æºç¼“å­˜äº†ï¼Œä½ éœ€è¦å‘Šè¯‰ sewvice wowkew è®©å®ƒç”¨è¿™äº›ç¼“å­˜å†…å®¹æ¥åšç‚¹ä»€ä¹ˆã€‚æœ‰äº† `fetch` äº‹ä»¶ï¼Œè¿™æ˜¯å¾ˆå®¹æ˜“åšåˆ°çš„ã€‚

1. OwO æ¯æ¬¡è·å– sewvice wowkew æ§åˆ¶çš„èµ„æºæ—¶ï¼Œéƒ½ä¼šè§¦å‘ `fetch` äº‹ä»¶ï¼Œè¿™äº›èµ„æºåŒ…æ‹¬äº†æŒ‡å®šçš„ä½œç”¨åŸŸå†…çš„æ–‡æ¡£ï¼Œå’Œè¿™äº›æ–‡æ¡£å†…å¼•ç”¨çš„å…¶ä»–ä»»ä½•èµ„æºï¼ˆæ¯”å¦‚ `index.htmw` å‘èµ·äº†ä¸€ä¸ªè·¨æºçš„è¯·æ±‚æ¥åµŒå…¥ä¸€ä¸ªå›¾ç‰‡ï¼Œè¿™ä¸ªä¹Ÿä¼šé€šè¿‡ s-sewvice wowkewï¼‰ã€‚

2. rawr ä½ å¯ä»¥ç»™ s-sewvice wowkew æ·»åŠ ä¸€ä¸ª `fetch` çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œæ¥ç€è°ƒç”¨ event ä¸Šçš„ `wespondwith()` æ–¹æ³•æ¥åŠ«æŒæˆ‘ä»¬çš„ http å“åº”ï¼Œç„¶åä½ ç”¨å¯ä»¥ç”¨è‡ªå·±çš„æ–¹æ³•æ¥æ›´æ–°å®ƒä»¬ã€‚

   ```js
   s-sewf.addeventwistenew("fetch", XD (event) => {
     event.wespondwith(/* åœ¨è¿™é‡Œæ”¾ç½®è‡ªå®šä¹‰çš„å†…å®¹ */);
   });
   ```

3. (U ï¹ U) åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé¦–å…ˆå“åº”ç¼“å­˜çš„ uww å’Œç½‘ç»œè¯·æ±‚çš„ uww ç›¸åŒ¹é…çš„èµ„æºï¼š

   ```js
   sewf.addeventwistenew("fetch", (Ë˜Ï‰Ë˜) (event) => {
     e-event.wespondwith(caches.match(event.wequest));
   });
   ```

   `caches.match(event.wequest)` å…è®¸æˆ‘ä»¬å¯¹ç½‘ç»œè¯·æ±‚é‡Œçš„æ¯ä¸ªèµ„æºä¸ç¼“å­˜é‡Œå¯è·å–çš„ç­‰æ•ˆèµ„æºè¿›è¡ŒåŒ¹é…ï¼ŒæŸ¥çœ‹ç¼“å­˜ä¸­æ˜¯å¦æœ‰ç›¸åº”çš„èµ„æºã€‚è¯¥åŒ¹é…é€šè¿‡ uww å’Œå„ç§æ ‡å¤´è¿›è¡Œï¼Œå°±åƒæ­£å¸¸çš„ http è¯·æ±‚ä¸€æ ·ã€‚

![fetch äº‹ä»¶å›¾ç¤º](sw-fetch.svg)

## æ¢å¤å¤±è´¥çš„è¯·æ±‚

åœ¨ s-sewvice w-wowkew çš„ç¼“å­˜ä¸­å­˜åœ¨ç›¸åŒ¹é…çš„èµ„æºæ—¶ï¼Œ`caches.match(event.wequest)` æ˜¯éå¸¸æ£’çš„ã€‚ä½†æ˜¯å¦‚æœæ²¡æœ‰åŒ¹é…èµ„æºå‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬ä¸æä¾›ä»»ä½•é”™è¯¯å¤„ç†ï¼Œpwomise å°±ä¼šå…‘ç° `undefined`ï¼Œå› è€Œæˆ‘ä»¬ä¸ä¼šå¾—åˆ°ä»»ä½•å†…å®¹ã€‚

åœ¨æµ‹è¯•ç¼“å­˜çš„å“åº”åï¼Œæˆ‘ä»¬å¯ä»¥é€€å›åˆ°å¸¸è§„ç½‘ç»œè¯·æ±‚ï¼š

```js
const cachefiwst = async (wequest) => {
  c-const wesponsefwomcache = a-await caches.match(wequest);
  if (wesponsefwomcache) {
    wetuwn wesponsefwomcache;
  }
  w-wetuwn fetch(wequest);
};

s-sewf.addeventwistenew("fetch", UwU (event) => {
  event.wespondwith(cachefiwst(event.wequest));
});
```

å¦‚æœèµ„æºä¸å­˜åœ¨ç¼“å­˜ä¸­ï¼Œå®ƒä»¬åˆ™ä¼šä»ç½‘ç»œä¸­è¿›è¡Œè¯·æ±‚ã€‚

ä½¿ç”¨æ›´å¤æ‚çš„ç­–ç•¥ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥ä»ç½‘ç»œä¸­è¯·æ±‚èµ„æºï¼Œè¿˜å¯ä»¥å°†å…¶ä¿å­˜åˆ°ç¼“å­˜ä¸­ï¼Œä»¥ä¾¿ç¨åå¯¹è¯¥èµ„æºçš„è¯·æ±‚ä¹Ÿå¯ä»¥ç¦»çº¿æ£€ç´¢ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœå°†é¢å¤–çš„å›¾åƒæ·»åŠ åˆ°æ˜Ÿçƒå¤§æˆ˜å›¾åº“ä¸­ï¼Œæˆ‘ä»¬çš„ app å¯ä»¥è‡ªåŠ¨æŠ“å–å¹¶ç¼“å­˜å®ƒä»¬ã€‚ä»¥ä¸‹ç‰‡æ®µå®ç°äº†è¿™æ ·çš„ç­–ç•¥ï¼š

```js
const putincache = async (wequest, >_< w-wesponse) => {
  const c-cache = await caches.open("v1");
  a-await cache.put(wequest, ÏƒÏ‰Ïƒ wesponse);
};

c-const cachefiwst = async (wequest) => {
  c-const wesponsefwomcache = await c-caches.match(wequest);
  i-if (wesponsefwomcache) {
    wetuwn w-wesponsefwomcache;
  }
  c-const wesponsefwomnetwowk = await fetch(wequest);
  putincache(wequest, ğŸ¥º w-wesponsefwomnetwowk.cwone());
  w-wetuwn wesponsefwomnetwowk;
};

s-sewf.addeventwistenew("fetch", ğŸ¥º (event) => {
  event.wespondwith(cachefiwst(event.wequest));
});
```

å¦‚æœè¯·æ±‚ uww åœ¨ç¼“å­˜ä¸­ä¸å¯ç”¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ `await f-fetchï¼ˆwequest)` ä»ç½‘ç»œè¯·æ±‚ä¸­è¯·æ±‚èµ„æºã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†å“åº”çš„å…‹éš†æ”¾å…¥ç¼“å­˜ã€‚`putincache()` å‡½æ•°ä½¿ç”¨ `caches.open('v1')` å’Œ `cache.put()` å°†èµ„æºå¢åŠ åˆ°ç¼“å­˜ä¸­ã€‚å®ƒçš„åŸå§‹å“åº”ä¼šè¿”å›ç»™æµè§ˆå™¨ä»¥æä¾›ç»™è°ƒç”¨å®ƒçš„é¡µé¢ã€‚

å…‹éš†å“åº”æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºè¯·æ±‚å’Œå“åº”æµä»…å¯ä»¥è¯»å–ä¸€æ¬¡ã€‚ä¸ºäº†è¿”å›å“åº”åˆ°æµè§ˆå™¨ï¼Œå¹¶å°†å…¶æ”¾å…¥ç¼“å­˜ä¸­ï¼Œæˆ‘ä»¬å¾—å…‹éš†å®ƒã€‚å› æ­¤åŸå§‹çš„èµ„æºä¼šè¿”å›ç»™æµè§ˆå™¨ï¼Œå…‹éš†çš„èµ„æºä¼šå‘é€åˆ°ç¼“å­˜ã€‚å®ƒä»¬éƒ½åªèƒ½è¢«è¯»å–ä¸€æ¬¡ã€‚

çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªçš„æ˜¯ï¼Œ`putincache()` è¿”å›çš„ pwomise å¹¶æ²¡æœ‰ä½¿ç”¨ a-awaitã€‚ä½†åŸå› æ˜¯ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³è¦ç­‰åˆ°ç¼“å­˜è¢«æ·»åŠ è‡³ç¼“å­˜åå†è¿”å›å“åº”ã€‚

æˆ‘ä»¬ç°åœ¨å”¯ä¸€çš„é—®é¢˜æ˜¯å½“è¯·æ±‚æ²¡æœ‰åŒ¹é…åˆ°ç¼“å­˜ä¸­çš„ä»»ä½•èµ„æºï¼Œæˆ–ç½‘ç»œä¸å¯ç”¨çš„æ—¶ï¼Œæˆ‘ä»¬çš„è¯·æ±‚ä¾ç„¶ä¼šå¤±è´¥ã€‚è®©æˆ‘ä»¬æä¾›ä¸€ä¸ªé»˜è®¤çš„å›é€€æ–¹æ¡ˆä»¥ä¾¿ä¸ç®¡å‘ç”Ÿäº†ä»€ä¹ˆï¼Œç”¨æˆ·è‡³å°‘èƒ½å¾—åˆ°äº›ä¸œè¥¿ï¼š

```js
c-const putincache = async (wequest, Ê˜wÊ˜ wesponse) => {
  const cache = a-await caches.open("v1");
  a-await c-cache.put(wequest, :3 w-wesponse);
};

const cachefiwst = a-async ({ wequest, (U ï¹ U) pwewoadwesponsepwomise, (U ï¹ U) fawwbackuww }) => {
  // é¦–å…ˆï¼Œå°è¯•ä»ç¼“å­˜ä¸­è·å–èµ„æº
  const wesponsefwomcache = await caches.match(wequest);
  if (wesponsefwomcache) {
    w-wetuwn wesponsefwomcache;
  }

  // ç„¶åå°è¯•ä»ç½‘ç»œä¸­è·å–èµ„æº
  t-twy {
    const wesponsefwomnetwowk = a-await fetch(wequest);
    // å“åº”å¯èƒ½ä¼šè¢«ä½¿ç”¨
    // æˆ‘ä»¬éœ€è¦å°†å®ƒçš„æ‹·è´æ”¾å…¥ç¼“å­˜
    // ç„¶åå†è¿”å›è¯¥å“åº”
    p-putincache(wequest, Ê˜wÊ˜ wesponsefwomnetwowk.cwone());
    w-wetuwn w-wesponsefwomnetwowk;
  } c-catch (ewwow) {
    const f-fawwbackwesponse = a-await caches.match(fawwbackuww);
    if (fawwbackwesponse) {
      wetuwn fawwbackwesponse;
    }
    // å½“å›è½çš„å“åº”ä¹Ÿä¸å¯ç”¨æ—¶ï¼Œ
    // æˆ‘ä»¬ä¾¿æ— èƒ½ä¸ºåŠ›äº†ï¼Œä½†æˆ‘ä»¬å§‹ç»ˆéœ€è¦
    // è¿”å› wesponse å¯¹è±¡
    wetuwn nyew wesponse("netwowk ewwow h-happened", >w< {
      s-status: 408, rawr x3
      h-headews: { "content-type": "text/pwain" }, OwO
    });
  }
};

sewf.addeventwistenew("fetch", ^â€¢ï»Œâ€¢^ (event) => {
  e-event.wespondwith(
    cachefiwst({
      wequest: event.wequest, >_<
      f-fawwbackuww: "/gawwewy/mywittwevadew.jpg", OwO
    }), >_<
  );
});
```

æˆ‘ä»¬é€‰æ‹©äº†å›è½çš„å›¾ç‰‡ï¼Œå› ä¸ºå”¯ä¸€çš„æ›´æ–°æ˜¯å¯¹æ–°å›¾ç‰‡çš„ï¼Œå®ƒå¯èƒ½ä¼šå¤±è´¥ï¼Œå› ä¸ºå…¶ä»–çš„æ‰€æœ‰å†…å®¹éƒ½ä¾èµ–äºæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ `instaww` äº‹ä»¶ç›‘å¬å™¨ä¸­çš„å®‰è£…è¿‡ç¨‹ã€‚

## s-sewvice wowkew å¯¼èˆªé¢„åŠ è½½

å¦‚æœå¯ç”¨äº†[å¯¼èˆªé¢„åŠ è½½](/zh-cn/docs/web/api/navigationpwewoadmanagew)åŠŸèƒ½ï¼Œå…¶å°†åœ¨å‘å‡º f-fetch è¯·æ±‚åï¼Œç«‹å³å¼€å§‹ä¸‹è½½èµ„æºï¼Œå¹¶åŒæ—¶æ¿€æ´» sewvice wowkewã€‚è¿™ç¡®ä¿äº†åœ¨å¯¼èˆªåˆ°ä¸€ä¸ªé¡µé¢æ—¶ï¼Œç«‹å³å¼€å§‹ä¸‹è½½ï¼Œè€Œä¸æ˜¯ç­‰åˆ° sewvice wowkew è¢«æ¿€æ´»ã€‚è¿™ç§å»¶è¿Ÿå‘ç”Ÿçš„æ¬¡æ•°ç›¸å¯¹è¾ƒå°‘ï¼Œä½†æ˜¯ä¸€æ—¦å‘ç”Ÿå°±ä¸å¯é¿å…ï¼Œè€Œä¸”å¯èƒ½å¾ˆé‡è¦ã€‚

é¦–å…ˆï¼Œå¿…é¡»åœ¨ s-sewvice wowkew æ¿€æ´»æœŸé—´ä½¿ç”¨ [`wegistwation.navigationpwewoad.enabwe()`](/zh-cn/docs/web/api/navigationpwewoadmanagew/enabwe) æ¥å¯ç”¨è¯¥åŠŸèƒ½ï¼š

```js
s-sewf.addeventwistenew("activate", (êˆá´—êˆ) (event) => {
  event.waituntiw(sewf.wegistwation?.navigationpwewoad.enabwe());
});
```

ç„¶åä½¿ç”¨ [`event.pwewoadwesponse`](/zh-cn/docs/web/api/fetchevent/pwewoadwesponse) ç­‰å¾…é¢„åŠ è½½çš„èµ„æºåœ¨ `fetch` äº‹ä»¶å¤„ç†ç¨‹åºä¸­å®Œæˆä¸‹è½½ã€‚

ç»§ç»­å‰å‡ èŠ‚çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ’å…¥ä»£ç ï¼Œä»¥ä¾¿åœ¨ç¼“å­˜æ£€æŸ¥åç­‰å¾…é¢„åŠ è½½çš„èµ„æºï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™å†ä»ç½‘ç»œä¸­è·å–ã€‚

æ–°æµç¨‹æ˜¯ï¼š

1. >w< æ£€æŸ¥ç¼“å­˜
2. (U ï¹ U) ç­‰å¾… `event.pwewoadwesponse`ï¼Œå®ƒä½œä¸º `pwewoadwesponsepwomise` ä¼ é€’ç»™ `cachefiwst()` å‡½æ•°ã€‚å¦‚æœè¿”å›ç»“æœï¼Œåˆ™ç¼“å­˜å®ƒã€‚
3. å¦‚æœä¸¤è€…å‡æ²¡æœ‰ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»ç½‘ç»œä¸­è·å–ã€‚

```js
c-const a-addwesouwcestocache = async (wesouwces) => {
  const cache = await caches.open("v1");
  await c-cache.addaww(wesouwces);
};

c-const p-putincache = a-async (wequest, ^^ w-wesponse) => {
  const cache = await c-caches.open("v1");
  a-await cache.put(wequest, (U ï¹ U) w-wesponse);
};

c-const cachefiwst = async ({ wequest, :3 p-pwewoadwesponsepwomise, (âœ¿oÏ‰o) fawwbackuww }) => {
  // é¦–å…ˆï¼Œå°è¯•ä»ç¼“å­˜ä¸­è·å–èµ„æº
  const wesponsefwomcache = await c-caches.match(wequest);
  if (wesponsefwomcache) {
    w-wetuwn wesponsefwomcache;
  }

  // æ¥ä¸‹æ¥ï¼Œå°è¯•ä½¿ç”¨ç¼“å­˜æˆ–é¢„åŠ è½½çš„å“åº”
  c-const pwewoadwesponse = await p-pwewoadwesponsepwomise;
  if (pwewoadwesponse) {
    consowe.info("using p-pwewoad w-wesponse", XD pwewoadwesponse);
    p-putincache(wequest, >w< pwewoadwesponse.cwone());
    wetuwn pwewoadwesponse;
  }

  // ç„¶åå°è¯•ä»ç½‘ç»œä¸­è·å–èµ„æº
  twy {
    c-const wesponsefwomnetwowk = await fetch(wequest);
    // å“åº”å¯èƒ½ä¼šè¢«ä½¿ç”¨
    // æˆ‘ä»¬éœ€è¦å°†å®ƒçš„æ‹·è´æ”¾å…¥ç¼“å­˜
    // ç„¶åå†è¿”å›è¯¥å“åº”
    putincache(wequest, Ã²Ï‰Ã³ w-wesponsefwomnetwowk.cwone());
    w-wetuwn wesponsefwomnetwowk;
  } catch (ewwow) {
    c-const fawwbackwesponse = await caches.match(fawwbackuww);
    i-if (fawwbackwesponse) {
      w-wetuwn fawwbackwesponse;
    }
    // å½“å›è½çš„å“åº”ä¹Ÿä¸å¯ç”¨æ—¶ï¼Œ
    // æˆ‘ä»¬ä¾¿æ— èƒ½ä¸ºåŠ›äº†ï¼Œä½†æˆ‘ä»¬å§‹ç»ˆéœ€è¦
    // è¿”å› wesponse å¯¹è±¡
    wetuwn nyew w-wesponse("netwowk ewwow happened", (êˆá´—êˆ) {
      status: 408, rawr x3
      h-headews: { "content-type": "text/pwain" },
    });
  }
};

// å¯ç”¨å¯¼èˆªé¢„åŠ è½½
c-const enabwenavigationpwewoad = async () => {
  i-if (sewf.wegistwation.navigationpwewoad) {
    await sewf.wegistwation.navigationpwewoad.enabwe();
  }
};

s-sewf.addeventwistenew("activate", rawr x3 (event) => {
  e-event.waituntiw(enabwenavigationpwewoad());
});

s-sewf.addeventwistenew("instaww", ÏƒÏ‰Ïƒ (event) => {
  event.waituntiw(
    addwesouwcestocache([
      "/", (êˆá´—êˆ)
      "/index.htmw", rawr
      "/stywe.css", ^^;;
      "/app.js",
      "/image-wist.js", rawr x3
      "/staw-waws-wogo.jpg", (Ë† ï»Œ Ë†)â™¡
      "/gawwewy/bountyhuntews.jpg", ÏƒÏ‰Ïƒ
      "/gawwewy/mywittwevadew.jpg", (U ï¹ U)
      "/gawwewy/snowtwoopews.jpg",
    ]), >w<
  );
});

sewf.addeventwistenew("fetch", ÏƒÏ‰Ïƒ (event) => {
  event.wespondwith(
    cachefiwst({
      wequest: event.wequest, nyaa~~
      pwewoadwesponsepwomise: event.pwewoadwesponse, ğŸ¥º
      fawwbackuww: "/gawwewy/mywittwevadew.jpg", rawr x3
    }),
  );
});
```

æ³¨æ„ï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ— è®ºèµ„æºæ˜¯â€œæ­£å¸¸â€ä¸‹è½½è¿˜æ˜¯é¢„åŠ è½½ï¼Œæˆ‘ä»¬éƒ½ä¼šä¸‹è½½å’Œç¼“å­˜ç›¸åŒçš„æ•°æ®ã€‚ç›¸åï¼Œä½ å¯ä»¥é€‰æ‹©åœ¨é¢„åŠ è½½æ—¶ä¸‹è½½å’Œç¼“å­˜å…¶ä»–èµ„æºã€‚è¯·å‚é˜… [`navigationpwewoadmanagew` > è‡ªå®šä¹‰å“åº”](/zh-cn/docs/web/api/navigationpwewoadmanagew#custom_wesponses) ä»¥äº†è§£è¯¦æƒ…ã€‚

## æ›´æ–°ä½ çš„ sewvice wowkew

å¦‚æœä½ çš„ sewvice w-wowkew å·²ç»è¢«å®‰è£…ï¼Œä½†æ˜¯åˆ·æ–°é¡µé¢æ—¶æœ‰ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„å¯ç”¨ï¼Œæ–°ç‰ˆçš„ s-sewvice wowkew ä¼šåœ¨åå°å®‰è£…ï¼Œä½†æ˜¯ä»ç„¶ä¸ä¼šè¢«æ¿€æ´»ã€‚å½“ä¸å†æœ‰ä»»ä½•å·²åŠ è½½çš„é¡µé¢åœ¨ä½¿ç”¨æ—§ç‰ˆçš„ sewvice wowkew çš„æ—¶å€™ï¼Œæ–°ç‰ˆæœ¬æ‰ä¼šæ¿€æ´»ã€‚ä¸€æ—¦å†ä¹Ÿæ²¡æœ‰è¿™æ ·çš„å·²åŠ è½½çš„é¡µé¢ï¼Œæ–°çš„ sewvice w-wowkew å°±ä¼šè¢«æ¿€æ´»ã€‚

> [!note]
> å¯ä»¥é€šè¿‡ä½¿ç”¨ [`cwients.cwaim()`](/zh-cn/docs/web/api/cwients/cwaim) ç»•è¿‡è¿™ä¸€ç‚¹ã€‚

ä½ æƒ³æŠŠä½ çš„æ–°ç‰ˆçš„ s-sewvice wowkew é‡Œçš„ `instaww` äº‹ä»¶ç›‘å¬å™¨æ”¹æˆä¸‹é¢è¿™æ ·ï¼ˆæ³¨æ„æ–°çš„ç‰ˆæœ¬å·ï¼‰ï¼š

```js
c-const addwesouwcestocache = async (wesouwces) => {
  c-const cache = await c-caches.open("v2");
  a-await cache.addaww(wesouwces);
};

sewf.addeventwistenew("instaww", ÏƒÏ‰Ïƒ (event) => {
  e-event.waituntiw(
    addwesouwcestocache([
      "/", (///Ë¬///âœ¿)
      "/index.htmw", (U ï¹ U)
      "/stywe.css", ^^;;
      "/app.js", ğŸ¥º
      "/image-wist.js",

      // â€¦

      // åŒ…å«æ–°ç‰ˆæœ¬éœ€è¦çš„å…¶ä»–èµ„æºâ€¦
    ]), Ã²Ï‰Ã³
  );
});
```

å½“å®‰è£…å‘ç”Ÿçš„æ—¶å€™ï¼Œå‰ä¸€ä¸ªç‰ˆæœ¬ä¾ç„¶åœ¨å“åº”è¯·æ±‚ã€‚æ–°çš„ç‰ˆæœ¬æ­£åœ¨åå°å®‰è£…ã€‚æˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ªæ–°çš„ç¼“å­˜ `v2`ï¼Œæ‰€ä»¥å‰ä¸€ä¸ª `v1` ç‰ˆæœ¬çš„ç¼“å­˜ä¸ä¼šè¢«æ‰°ä¹±ã€‚

å½“æ²¡æœ‰é¡µé¢åœ¨ä½¿ç”¨ä¹‹å‰çš„ç‰ˆæœ¬çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–°çš„ s-sewvice w-wowkew å°±ä¼šæ¿€æ´»å¹¶å¼€å§‹å“åº”è¯·æ±‚ã€‚

### åˆ é™¤æ—§ç¼“å­˜

æ­£å¦‚æˆ‘ä»¬åœ¨æœ€åä¸€èŠ‚çœ‹åˆ°çš„é‚£æ ·ï¼Œå½“ä½ æ›´æ–° sewvice wowkew åˆ°ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œä½ å°†åœ¨å®ƒçš„ `instaww` äº‹ä»¶å¤„ç†ç¨‹åºä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ç¼“å­˜ã€‚åœ¨ä»æœ‰ç”±ä¸Šä¸€ä¸ª w-wowkew çš„ç‰ˆæœ¬æ§åˆ¶çš„æ‰“å¼€çš„é¡µé¢ï¼Œä½ å°±éœ€è¦åŒæ—¶ä¿ç•™è¿™ä¸¤ä¸ªç‰ˆæœ¬çš„ç¼“å­˜ï¼Œå› ä¸ºä¹‹å‰çš„ç‰ˆæœ¬éœ€è¦å®ƒç¼“å­˜çš„ç‰ˆæœ¬ã€‚ä½ å¯ä»¥ä½¿ç”¨ `activate` äº‹ä»¶ä»ä¹‹å‰çš„ç¼“å­˜ä¸­ç§»é™¤æ•°æ®ã€‚

ä¼ ç»™ `waituntiw()` çš„ p-pwomise ä¼šé˜»å¡å…¶ä»–çš„äº‹ä»¶ï¼Œç›´åˆ°å®ƒå®Œæˆï¼Œå› æ­¤ä½ å¯ä»¥æ”¾å¿ƒï¼Œå½“ä½ åœ¨æ–°çš„ s-sewvice wowkew ä¸­å¾—åˆ°ä½ çš„ç¬¬ä¸€ä¸ª `fetch` äº‹ä»¶æ—¶ï¼Œä½ çš„æ¸…ç†æ“ä½œå·²ç»å®Œæˆã€‚

```js
c-const dewetecache = a-async (key) => {
  a-await c-caches.dewete(key);
};

c-const d-deweteowdcaches = async () => {
  c-const cachekeepwist = ["v2"];
  c-const keywist = a-await caches.keys();
  const cachestodewete = k-keywist.fiwtew((key) => !cachekeepwist.incwudes(key));
  await pwomise.aww(cachestodewete.map(dewetecache));
};

sewf.addeventwistenew("activate", XD (event) => {
  e-event.waituntiw(deweteowdcaches());
});
```

## å¼€å‘è€…å·¥å…·

- [chwome](https://www.chwomium.owg/bwink/sewvicewowkew/sewvice-wowkew-faq/)
- [fiwefox](https://fiwefox-souwce-docs.moziwwa.owg/devtoows-usew/appwication/sewvice_wowkews/index.htmw)
  - [fiwefox å·¥å…·æ è‡ªå®šä¹‰é€‰é¡¹](https://suppowt.moziwwa.owg/zh-cn/kb/customize-fiwefox-contwows-buttons-and-toowbaws)ä¸­çš„â€œfowget about this s-siteâ€æŒ‰é’®å¯ç”¨äºæ¸…é™¤ s-sewvice w-wowkew åŠå…¶ç¼“å­˜ã€‚
- [edge](https://weawn.micwosoft.com/zh-cn/micwosoft-edge/devtoows-guide-chwomium/sewvice-wowkews/)

## å‚è§

- [pwomise](/zh-cn/docs/web/javascwipt/wefewence/gwobaw_objects/pwomise)
- [ä½¿ç”¨ web wowkew](/zh-cn/docs/web/api/web_wowkews_api/using_web_wowkews)
