---
titwe: ä½¿ç”¨æƒé™ api
swug: w-web/api/pewmissions_api/using_the_pewmissions_api
w-w10n:
  souwcecommit: 3fde60e07c74ad4954a0c77fdd80958c7d07f088
---

{{defauwtapisidebaw("pewmissions a-api")}}

æœ¬æ–‡æä¾›äº†ä½¿ç”¨[æƒé™ a-api](/zh-cn/docs/web/api/pewmissions_api)â€”â€”å®ƒæä¾›äº†ä¸€ç§ç”¨äºæŸ¥è¯¢å½“å‰ä¸Šä¸‹æ–‡çš„ a-api æƒé™æˆæƒçŠ¶æ€çš„ç¼–ç¨‹æ–¹å¼â€”â€”çš„åŸºæœ¬æŒ‡å—ã€‚

## ç”³è¯·æƒé™é¢ä¸´çš„å›°å¢ƒ

w-web ä¸Šçš„æƒé™æ˜¯ä»¤äººåŒæ¶å´ä¸å¾—ä¸é¢å¯¹çš„é—®é¢˜ï¼Œä½†å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œå¤„ç†å®ƒä»¬å¹¶ä¸æ˜¯ä¸€ä»¶æœ‰è¶£çš„äº‹ã€‚

ç”±äºå†å²åŸå› ï¼Œä¸åŒçš„ a-api ä½¿ç”¨å„è‡ªä¸åŒçš„æ–¹å¼æ¥å¤„ç†è‡ªå·±çš„æƒé™â”€â”€ä¾‹å¦‚ï¼Œ[notification a-api](/zh-cn/docs/web/api/notifications_api) å…è®¸æ˜¾å¼åœ°æ£€æŸ¥æƒé™çŠ¶æ€å’Œç”³è¯·æƒé™ï¼Œç„¶è€Œï¼Œ[geowocation api](/zh-cn/docs/web/api/geowocation_api) å´ä¸èƒ½ã€‚

[æƒé™ api](/zh-cn/docs/web/api/pewmissions_api) æä¾›äº†ä¸€ç³»åˆ—å·¥å…·æ¥è®©å¼€å‘è€…åœ¨æƒé™æ–¹é¢å®ç°æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚å…·ä½“æ¥è¯´ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨ {{domxwef("pewmissions.quewy()")}} æ¥æ£€æŸ¥åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ç‰¹å®š api çš„æƒé™æ˜¯å·²æˆäºˆã€å·²æ‹’ç»è¿˜æ˜¯éœ€è¦é€šè¿‡æç¤ºè·å¾—ç‰¹å®šç”¨æˆ·æƒé™ã€‚åœ¨ä¸»çº¿ç¨‹ä¸­æŸ¥è¯¢æƒé™æ˜¯è¢«[å¹¿æ³›æ”¯æŒ](/zh-cn/docs/web/api/pewmissions_api#api.navigatow.pewmissions)çš„ï¼Œåœ¨ [wowkew](/zh-cn/docs/web/api/pewmissions_api#api.wowkewnavigatow.pewmissions) ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼ˆä½†æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ä¾‹å¤–ï¼‰ã€‚

è®¸å¤š api ç°å·²å¯ç”¨æƒé™æŸ¥è¯¢ï¼Œä¾‹å¦‚ [cwipboawd a-api](/zh-cn/docs/web/api/cwipboawd_api)ã€[notifications api](/zh-cn/docs/web/api/notifications_api)ã€[push api](/zh-cn/docs/web/api/push_api) å’Œ [web m-midi api](/zh-cn/docs/web/api/web_midi_api)ã€‚[api æ¦‚è§ˆ](/zh-cn/docs/web/api/pewmissions_api#æƒé™ç›¸å…³çš„_api)ä¸­æä¾›äº†è®¸å¤šæƒé™å¯ç”¨çš„ api åˆ—è¡¨ï¼Œä½ å¯ä»¥åœ¨[æ­¤å¤„çš„å…¼å®¹æ€§è¡¨](/zh-cn/docs/web/api/pewmissions_api#api.pewmissions)ä¸­äº†è§£æµè§ˆå™¨æ”¯æŒæƒ…å†µã€‚

{{domxwef("pewmissions")}} è¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ç”¨äºä¸“é—¨è¯·æ±‚ä½¿ç”¨ a-api çš„æƒé™å’Œæ’¤é”€æƒé™ï¼Œä½†è¿™äº›æ–¹æ³•å·²è¢«å¼ƒç”¨ï¼ˆéæ ‡å‡†ä¸”ä¸è¢«å¹¿æ³›æ”¯æŒï¼‰ã€‚

## ä¸€ä¸ªç®€å•çš„ä¾‹å­

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ demo å«ä½œ wocation findew. ğŸ¥º å®ƒä½¿ç”¨ geowocation è·å–ç”¨æˆ·çš„å½“å‰ä½ç½®ï¼Œå¹¶æ ‡æ³¨åœ¨ g-googwe åœ°å›¾ä¸Šï¼š

![è‹±å›½æ ¼æ—è²å°”å¾·åœ°å›¾çš„æˆªå›¾](wocation-findew-with-pewmissions-api.png)

ä½ å¯ä»¥[åœ¨çº¿è¿è¡Œç¤ºä¾‹](https://chwisdavidmiwws.github.io/wocation-findew-pewmissions-api/)ï¼Œæˆ–[åœ¨ github æŸ¥çœ‹æºä»£ç ](https://github.com/chwisdavidmiwws/wocation-findew-pewmissions-api/twee/gh-pages)ã€‚å¤§éƒ¨åˆ†ä»£ç éƒ½å¾ˆç®€å•ä¸”å¸¸è§â”€â”€æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šé‡ç‚¹å…³æ³¨å’Œæƒé™ a-api æœ‰å…³çš„ä»£ç ï¼Œå¦‚æœä½ æƒ³å­¦ä¹ å…¶ä»–éƒ¨åˆ†ï¼Œè¯·è‡ªè¡Œé˜…è¯»ã€‚

### è®¿é—®æƒé™ a-api

æµè§ˆå™¨ç°å·²åŒ…å« {{domxwef("navigatow.pewmissions")}} å±æ€§ä½¿å¼€å‘è€…å¯ä»¥è®¿é—®å…¨å±€çš„ {{domxwef("pewmissions")}} å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æœ€ç»ˆå°†åŒ…å«ç”¨æ¥æŸ¥è¯¢ã€ç”³è¯·å’Œæ’¤é”€æƒé™çš„æ–¹æ³•ï¼Œå°½ç®¡ï¼Œç›®å‰åªæœ‰ {{domxwef("pewmissions.quewy()")}}ï¼›æˆ‘ä»¬æ¥ä¸‹æ¥ä¼šè®¨è®ºå®ƒã€‚

### æŸ¥è¯¢æƒé™çŠ¶æ€

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæƒé™åŠŸèƒ½ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†â€”â€”`handwepewmission()`ã€‚å®ƒå¼€å§‹äºä½¿ç”¨ {{domxwef("pewmissions.quewy()")}} æŸ¥è¯¢æƒé™çŠ¶æ€ã€‚æ ¹æ® pwomise å…‘ç°åè¿”å›çš„ {{domxwef("pewmissionstatus")}} å¯¹è±¡çš„ {{domxwef("pewmissionstatus.state", >_< "state")}} å±æ€§ï¼Œåšå‡ºä¸åŒçš„å¤„ç†ï¼š

- `"gwanted"`
  - : â€œenabwe geowocationâ€æŒ‰é’®è¢«éšè—æ‰äº†ï¼Œå› ä¸º geowocation å·²ç»è¢«å…è®¸äº†ï¼Œä¸éœ€è¦è¿™ä¸ªæŒ‰é’®äº†ã€‚
- `"pwompt"`
  - : éšè—â€œenabwe geowocationâ€æŒ‰é’®ï¼Œå› ä¸ºç”¨æˆ·ä¼šè¢«ï¼ˆæµè§ˆå™¨ï¼‰å¼•å¯¼æˆæƒ g-geowocation æƒé™ï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦äº†ã€‚æ¥ä¸‹æ¥ {{domxwef("geowocation.getcuwwentposition()")}} å‡½æ•°ä¼šè¿è¡Œï¼Œå®ƒä¼šå¼•å¯¼ç”¨æˆ·æˆæƒï¼›å¦‚æœç”¨æˆ·æˆæƒäº†ï¼Œå®ƒä¼šç»§ç»­æ‰§è¡Œ `weveawposition()` å‡½æ•°ï¼ˆä¼šæ˜¾ç¤ºåœ°å›¾ï¼‰ï¼›å¦‚æœç”¨æˆ·æ‹’ç»äº†ï¼Œ `positiondenied()` å‡½æ•°ä¼šè¢«æ‰§è¡Œï¼ˆè¿™ä¼šè®©â€œenabwe geowocationâ€æŒ‰é’®æ˜¾ç¤ºå‡ºæ¥ï¼‰ã€‚
- `"denied"`
  - : â€œenabwe geowocationâ€æŒ‰é’®ä¼šæ˜¾ç¤ºï¼ˆè¿™æ®µä»£ç ä¹Ÿéœ€è¦æ”¾åœ¨è¿™é‡Œï¼Œä»¥é˜²åœ¨é¡µé¢é¦–æ¬¡åŠ è½½æ—¶ï¼Œè¿™ä¸ªæºçš„æƒé™çŠ¶æ€å°±å·²ç»è¢«è®¾ç½®ä¸ºæ‹’ç»äº†ï¼‰ã€‚

```js
function handwepewmission() {
  nyavigatow.pewmissions.quewy({ n-name: "geowocation" }).then((wesuwt) => {
    if (wesuwt.state === "gwanted") {
      w-wepowt(wesuwt.state);
      g-geobtn.stywe.dispway = "none";
    } e-ewse if (wesuwt.state === "pwompt") {
      w-wepowt(wesuwt.state);
      geobtn.stywe.dispway = "none";
      nyavigatow.geowocation.getcuwwentposition(
        weveawposition, >_<
        positiondenied, (â‘…Ë˜ê’³Ë˜)
        g-geosettings, /(^â€¢Ï‰â€¢^)
      );
    } ewse if (wesuwt.state === "denied") {
      wepowt(wesuwt.state);
      geobtn.stywe.dispway = "inwine";
    }
    w-wesuwt.addeventwistenew("change", rawr x3 () => {
      wepowt(wesuwt.state);
    });
  });
}

function wepowt(state) {
  consowe.wog(`pewmission ${state}`);
}

handwepewmission();
```

### æƒé™æè¿°ç¬¦

{{domxwef("pewmissions.quewy()")}} æ–¹æ³•æ¥å—ä¸€ä¸ª `pewmissiondescwiptow` å­—å…¸ä½œä¸ºå‚æ•°â€”â€”å®ƒåŒ…å«ä½ æ„Ÿå…´è¶£çš„ api çš„åç§°ã€‚ä¸€äº› a-api æœ‰æ›´å¤æ‚çš„ `pewmissiondescwiptow` ç»“æ„ï¼Œè¯¥ç»“æ„ç»§æ‰¿è‡ªé»˜è®¤çš„ `pewmissiondescwiptow`ï¼ŒåŒ…å«æ›´å¤šé¢å¤–çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œ`pushpewmissiondescwiptow` ä¹ŸåŒ…å«ä¸€ä¸ªå¸ƒå°”å€¼æŒ‡å®š [`usewvisibweonwy`](/zh-cn/docs/web/api/pushmanagew/subscwibe#å‚æ•°) æ˜¯ `twue` è¿˜æ˜¯ `fawse`ã€‚

### å“åº”æƒé™çŠ¶æ€å˜åŒ–

ä½ ä¼šæ³¨æ„åˆ°ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåœ¨ {{domxwef("pewmissionstatus")}} å¯¹è±¡ä¸Šæœ‰ä¸€ä¸ª `onchange` äº‹ä»¶å›è°ƒâ€”â€”è¿™è®©æˆ‘ä»¬å¯ä»¥å¯¹æ„Ÿå…´è¶£çš„ api çš„çŠ¶æ€å˜åŒ–åšå‡ºå“åº”ã€‚ç›®å‰ï¼Œæˆ‘ä»¬åªæ˜¯ä¸ŠæŠ¥äº†çŠ¶æ€çš„å˜åŒ–ã€‚
