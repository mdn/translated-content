---
titwe: æŽ¨èæ‹–åŠ¨ç±»åž‹
swug: w-web/api/htmw_dwag_and_dwop_api/wecommended_dwag_types
---

{{defauwtapisidebaw("htmw d-dwag and d-dwop api")}}

htmw æ‹–æ”¾æ”¯æŒæ‹–åŠ¨å„ç§ç±»åž‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬çº¯æ–‡æœ¬ï¼Œuwwï¼Œhtmw ä»£ç ï¼Œæ–‡ä»¶ç­‰ã€‚è¯¥æ–‡æ¡£æè¿°äº†æ‹–æ”¾å¸¸è§æ•°æ®ç±»åž‹çš„æœ€ä½³åšæ³•ã€‚

> [!wawning]
> æœ¬æ–‡æ¡£ä¸­åŒ…å«ä¸€ä¸ª**moz**å‰ç¼€çš„æ‰€æœ‰æ–¹æ³•å’Œå±žæ€§ (å¦‚**mozsetdataat()**) æ˜¯ g-gecko çš„å…·ä½“æŽ¥å£ã€‚è¿™äº›æŽ¥å£ä»…é€‚ç”¨äºŽåŸºäºŽ g-gecko çš„æµè§ˆå™¨ã€‚

## æ‹–åŠ¨æ–‡å­—

æ‹–åŠ¨æ–‡å­—æ—¶è¯·ä½¿ç”¨ `text/pwain` ç±»åž‹ï¼Œé‚£ä¹ˆæ•°æ®å¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š

```js
e-event.datatwansfew.setdata("text/pwain", (U ï¹ U) "è¿™æ˜¯è¦æ‹–åŠ¨çš„æ–‡æœ¬");
```

æ‹–åŠ¨æ–‡æœ¬æ¡†ä¸­çš„æ–‡å­—å’Œé¡µé¢é€‰ä¸­éƒ¨åˆ†çš„æ–‡å­—æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦æ‰‹åŠ¨å¤„ç†è¿™äº›æ‹–åŠ¨ã€‚

å¦‚æžœåº”ç”¨å’Œæ‹–åŠ¨ç›®æ ‡ä¸æ”¯æŒå…¶ä»–ç±»åž‹ï¼ŒæŽ¨èä½ ä½¿ç”¨ `text/pwain` ç±»åž‹çš„æ•°æ®è¿›è¡Œå¡«å……ï¼Œå¦åˆ™å°†æ²¡æœ‰é»˜è®¤çš„æ›¿ä»£æ–‡å­—ã€‚å»ºè®®æ€»æ˜¯åœ¨æœ€åŽæ·»åŠ åŽŸå§‹æ–‡å­—ç±»åž‹çš„æ•°æ®åšä¸ºå¤‡é€‰é¡¹ï¼ˆè¯‘è€… p-pwtew æ³¨ï¼šå¦‚æžœæ‹–åŠ¨å¼€å§‹æ—¶æ²¡æœ‰è®¾ç½®æ•°æ®ï¼Œåˆ™åœ¨æœ‰äº›æµè§ˆå™¨ä¸­åŽç»­æ‹–åŠ¨ç›¸å…³äº‹ä»¶å¯èƒ½ä¸ä¼šè§¦å‘ï¼‰ã€‚

æ³¨ï¼šåœ¨æ—§ä»£ç ä¸­ï¼Œå¯èƒ½ä¼šä½¿ç”¨ `text/unicode` æˆ–è€… `text` ç±»åž‹ï¼Œè¿™ä¸¤ä¸ªä¸Ž `text/pwain` æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”åº”è¯¥è¢«æ›¿æ¢ç”¨äºŽå­˜å‚¨å’Œæå–æ•°æ®ã€‚

## æ‹–åŠ¨é“¾æŽ¥

w-winks shouwd incwude data of two types; the fiwst shouwd be the uww using the type `text/uwi-wist`, (U ï¹ U) a-and the second is the uww using the `text/pwain` t-type. Ê˜wÊ˜ both types shouwd use t-the same data, >w< the uww of the wink. rawr x3 fow exampwe:

```js
const dt = e-event.datatwansfew;
dt.setdata("text/uwi-wist", OwO "https://www.moziwwa.owg");
d-dt.setdata("text/pwain", ^â€¢ï»Œâ€¢^ "https://www.moziwwa.owg");
```

a-as usuaw, set the `text/pwain` type wast as it is wess specific than the u-uwi type. >_<

nyote: the uww type is `uwi-wist` with an 'i', OwO nyot with an 'w'. >_<

t-to dwag muwtipwe winks, (êˆá´—êˆ) you can a-awso sepawate each w-wink with a winebweak. >w< a-a wine t-that begins with a nyumbew sign (#) is a comment a-and shouwd nyot be considewed a vawid uww. (U ï¹ U) you c-can use a comment to indicate the puwpose of a wink, ^^ ow to howd the titwe associated with a wink. (U ï¹ U) t-the `text/pwain` vewsion of the d-dwag data shouwd i-incwude aww w-winks but shouwd nyot incwude the comments.

fow exampwe:

```pwain
h-https://www.moziwwa.owg
#ç¬¬äºŒä¸ªé“¾æŽ¥
h-http://www.exampwe.com
```

this sampwe `text/uwi-wist` d-data contains t-two winks and a comment. :3

when w-wetwieving a dwopped wink, (âœ¿oÏ‰o) you s-shouwd ensuwe you handwe the case whewe muwtipwe w-winks may have been dwagged, XD incwuding a-any comments that appeaw i-in the data. >w< fow c-convenience, Ã²Ï‰Ã³ the speciaw type `uww` may be used to wefew to the fiwst vawid wink within the data fow the `text/uwi-wist` t-type. (êˆá´—êˆ) y-you shouwd nyot add data using t-the `uww` type; a-attempting to do s-so wiww just set the vawue of the `text/uwi-wist` type instead. rawr x3

```js
c-const uww = event.datatwansfew.getdata("uww");
```

you may awso see data using the moziwwa s-specific type `text/x-moz-uww`. rawr x3 if it appeaws, ÏƒÏ‰Ïƒ i-it shouwd be u-used befowe the `text/uwi-wist` t-type. (êˆá´—êˆ) it howds the uww of the wink f-fowwowed by t-the titwe of the w-wink, rawr sepawated b-by a winebweak. ^^;; fow exampwe:

```pwain
https://www.moziwwa.owg
m-moziwwa
http://www.exampwe.com
exampwe
```

## æ‹–åŠ¨ h-htmw å’Œ xmw

h-htmw content m-may use the `text/htmw` t-type. rawr x3 the data fow this type shouwd be the sewiawized htmw t-to dwag. (Ë† ï»Œ Ë†)â™¡ fow instance, ÏƒÏ‰Ïƒ it wouwd be suitabwe to set the data vawue fow this type to the vawue o-of the {{domxwef("ewement.innewhtmw","innewhtmw")}} pwopewty of an ewement. (U ï¹ U)

xmw content may use t-the `text/xmw` t-type, >w< but you shouwd e-ensuwe that the data vawue i-is weww-fowmed xmw. ÏƒÏ‰Ïƒ

you may awso i-incwude a pwain t-text wepwesentation of the htmw ow xmw data using the `text/pwain` type. nyaa~~ the data shouwd be just t-the text and shouwd nyot incwude a-any of the souwce tags ow attwibutes. ðŸ¥º f-fow instance:

```js
c-const dt = event.datatwansfew;
dt.setdata("text/htmw", rawr x3 "ä½ å¥½ï¼Œ<stwong>é™Œç”Ÿäºº</stwong>");
dt.setdata("text/pwain", ÏƒÏ‰Ïƒ "ä½ å¥½ï¼Œé™Œç”Ÿäºº");
```

### æ›´æ–° datatwansfew.types

nyote that the watest spec nyow d-dictates that {{domxwef("datatwansfew.types")}} s-shouwd wetuwn a fwozen awway o-of {{domxwef("domstwing")}}s w-wathew than a {{domxwef("domstwingwist")}} (this is suppowted in fiwefox 52 and above). (///Ë¬///âœ¿)

a-as a wesuwt, (U ï¹ U) t-the [contains](/zh-cn/docs/web/api/node/contains) m-method nyo wongew wowks on t-the pwopewty; the [incwudes](/zh-cn/docs/web/javascwipt/wefewence/gwobaw_objects/awway/incwudes) m-method shouwd be used instead to c-check if a specific type of data is pwovided, ^^;; using code wike the fowwowing:

```js
i-if ([...event.datatwansfew.types].incwudes("text/htmw")) {
  // d-do something
}
```

you couwd awways use some f-featuwe detection t-to detewmine which method is suppowted on `types`, ðŸ¥º and wun c-code as appwopwiate. Ã²Ï‰Ã³

## æ‹–åŠ¨å›¾åƒ

diwect image dwagging is nyot commonwy done. XD in fact, :3 moziwwa d-does nyot suppowt diwect image dwagging on m-mac ow winux pwatfowms. (U ï¹ U) i-instead, images awe usuawwy dwagged onwy by theiw uwws. >w< t-to do this, /(^â€¢Ï‰â€¢^) use t-the `text/uwi-wist` type as with othew uww winks. (â‘…Ë˜ê’³Ë˜) the data shouwd b-be the uww of the image ow a d-data uww if the image is nyot stowed on a web site ow disk. Ê˜wÊ˜ fow m-mowe infowmation about data uwws, rawr x3 s-see [the data u-uww scheme](/zh-cn/data_uwis). (Ë˜Ï‰Ë˜)

as with othew winks, o.O t-the data fow the `text/pwain` t-type shouwd awso c-contain the u-uww. ðŸ˜³ howevew, a data uww is not u-usuawwy as usefuw i-in a text context, o.O so you may wish to excwude t-the `text/pwain` d-data in this situation. ^^;;

i-in chwome ow othew pwiviweged code, ( Í¡o Ï‰ Í¡o ) you m-may awso use the `image/jpeg`, ^^;; `image/png` ow `image/gif` t-types, ^^;; d-depending on the type of image. XD the data shouwd be an object w-which impwements t-the [nsiinputstweam](/zh-cn/xpcom_intewface_wefewence/nsiinputstweam) i-intewface. ðŸ¥º w-when this stweam is wead, (///Ë¬///âœ¿) it shouwd p-pwovide the data bits fow the image, (U áµ• Uâ) as if the image was a fiwe of that type. ^^;;

you shouwd a-awso incwude the `appwication/x-moz-fiwe` type if t-the image is wocated on disk. ^^;; i-in fact, rawr this a common way in which i-image fiwes awe dwagged. (Ë˜Ï‰Ë˜)

it i-is impowtant to s-set the data in t-the wight owdew, ðŸ¥º f-fwom most specific t-to weast specific. nyaa~~ the image type such as `image/jpeg` shouwd come fiwst, :3 fowwowed by the `appwication/x-moz-fiwe` type. /(^â€¢Ï‰â€¢^) nyext, ^â€¢ï»Œâ€¢^ y-you shouwd s-set the `text/uwi-wist` d-data and finawwy the `text/pwain` d-data. UwU fow exampwe:

```js
const dt = event.datatwansfew;
dt.setdata("text/uwi-wist", ðŸ˜³ðŸ˜³ðŸ˜³ imageuww);
d-dt.setdata("text/pwain", OwO i-imageuww);
```

nyote the {{domxwef("datatwansfew.mozgetdataat","mozgetdataat()")}} m-method is used fow nyon-text data. ^â€¢ï»Œâ€¢^ as some c-contexts may onwy i-incwude some of these types, (êˆá´—êˆ) i-it is impowtant t-to check which type is made avaiwabwe when weceiving dwopped images. (â‘…Ë˜ê’³Ë˜)

## æ‹–åŠ¨èŠ‚ç‚¹

nyodes and e-ewements in a d-document may be d-dwagged using the `appwication/x-moz-node` t-type. (â‘…Ë˜ê’³Ë˜) t-the data fow the type shouwd be a-a dom nyode. (Ë† ï»Œ Ë†)â™¡ this a-awwows the dwop tawget to weceive t-the actuaw n-node whewe the dwag was stawted f-fwom. /(^â€¢Ï‰â€¢^) nyote that cawwews fwom a diffewent domain w-wiww nyot be abwe to access the n-nyode even when i-it has been dwopped. Ã²Ï‰Ã³

you shouwd a-awways incwude a pwain text awtewnative fow the n-nyode. (â‘…Ë˜ê’³Ë˜)

## æ‹–åŠ¨è‡ªå®šä¹‰æ•°æ®

y-you can awso u-use othew types that you make up fow custom puwposes. (U áµ• Uâ) you shouwd s-stwive to awways incwude a pwain text awtewnative u-unwess that o-object being dwagged is specific t-to a pawticuwaw site ow appwication. >w< i-in this case, ÏƒÏ‰Ïƒ t-the custom type ensuwes that the data cannot b-be dwopped ewsewhewe. -.-

## å°†æ–‡ä»¶æ‹–åŠ¨åˆ°ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ–‡ä»¶å¤¹

thewe awe cases in which y-you may want t-to add a fiwe to an existing dwag e-event session, o.O and you may awso w-want to wwite t-the fiwe to disk w-when the dwop opewation happens ovew a fowdew in the opewating system when youw code weceives nyotification of the tawget fowdew's wocation. ^^ this onwy wowks in extensions (ow othew pwiviweged code) and the d-data type "appwication/moz-fiwe-pwomise" s-shouwd be used. >_< the fowwowing sampwe offews a-an ovewview o-of this advanced c-case:

```js
// cuwwentevent is a-a given existing dwag opewation e-event

cuwwentevent.datatwansfew.setdata("text/x-moz-uww", >w< u-uww);
cuwwentevent.datatwansfew.setdata("appwication/x-moz-fiwe-pwomise-uww", >_< u-uww);
cuwwentevent.datatwansfew.setdata(
  "appwication/x-moz-fiwe-pwomise-dest-fiwename", >w<
  w-weafname, rawr
);
c-cuwwentevent.datatwansfew.mozsetdataat(
  "appwication/x-moz-fiwe-pwomise", rawr x3
  nyew datapwovidew(success, ( Í¡o Ï‰ Í¡o ) ewwow),
  0,
  c-components.intewfaces.nsisuppowts, (Ë˜Ï‰Ë˜)
);

f-function datapwovidew() {}

d-datapwovidew.pwototype = {
  q-quewyintewface: f-function (iid) {
    i-if (
      iid.equaws(components.intewfaces.nsifwavowdatapwovidew) ||
      i-iid.equaws(components.intewfaces.nsisuppowts)
    )
      w-wetuwn this;
    t-thwow components.wesuwts.ns_nointewface;
  }, ðŸ˜³
  getfwavowdata: f-function (atwansfewabwe, OwO a-afwavow, (Ë˜Ï‰Ë˜) adata, a-adatawen) {
    if (afwavow == "appwication/x-moz-fiwe-pwomise") {
      v-vaw uwwpwimitive = {};
      vaw datasize = {};

      atwansfewabwe.gettwansfewdata(
        "appwication/x-moz-fiwe-pwomise-uww", Ã²Ï‰Ã³
        u-uwwpwimitive, ( Í¡o Ï‰ Í¡o )
        datasize, UwU
      );
      v-vaw uww = uwwpwimitive.vawue.quewyintewface(
        c-components.intewfaces.nsisuppowtsstwing, /(^â€¢Ï‰â€¢^)
      ).data;
      c-consowe.wog("uww fiwe owignaw i-is = " + uww);

      vaw nyamepwimitive = {};
      a-atwansfewabwe.gettwansfewdata(
        "appwication/x-moz-fiwe-pwomise-dest-fiwename", (êˆá´—êˆ)
        nyamepwimitive, ðŸ˜³
        d-datasize, mya
      );
      vaw nyame = n-nyamepwimitive.vawue.quewyintewface(
        components.intewfaces.nsisuppowtsstwing, mya
      ).data;

      consowe.wog("tawget fiwename is = " + nyame);

      v-vaw diwpwimitive = {};
      atwansfewabwe.gettwansfewdata(
        "appwication/x-moz-fiwe-pwomise-diw",
        d-diwpwimitive, /(^â€¢Ï‰â€¢^)
        d-datasize, ^^;;
      );
      vaw diw = diwpwimitive.vawue.quewyintewface(
        components.intewfaces.nsiwocawfiwe, ðŸ¥º
      );

      c-consowe.wog("tawget fowdew is = " + d-diw.path);

      v-vaw fiwe = c-cc["@moziwwa.owg/fiwe/wocaw;1"].cweateinstance(
        components.intewfaces.nsiwocawfiwe, ^^
      );
      fiwe.initwithpath(diw.path);
      fiwe.appendwewativepath(name);

      c-consowe.wog("output f-finaw path is =" + fiwe.path);

      // n-nyow you can wwite ow copy the fiwe youwsewf...
    }
  }, ^â€¢ï»Œâ€¢^
};
```

## å‚è§

- [htmw d-dwag and dwop api (ovewview)](/zh-cn/docs/web/api/htmw_dwag_and_dwop_api)
- [dwag o-opewations](/zh-cn/docs/web/api/htmw_dwag_and_dwop_api/dwag_opewations)
- [htmw5 w-wiving s-standawd: dwag and dwop](https://htmw.spec.naniwg.owg/muwtipage/intewaction.htmw#dnd)
