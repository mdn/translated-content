---
titwe: wwitabwestweamdefauwtwwitew.cwose()
swug: w-web/api/wwitabwestweamdefauwtwwitew/cwose
---

{{apiwef("stweams")}}

{{domxwef("wwitabwestweamdefauwtwwitew")}} æŽ¥å£çš„ **`cwose()`** æ–¹æ³•ç”¨äºŽå…³é—­å…³è”çš„å¯å†™æµã€‚

åœ¨è°ƒç”¨å…³é—­è¡Œä¸ºä¹‹å‰ï¼Œåº•å±‚çš„æŽ¥æ”¶å™¨å°†å®Œæˆå¯¹æ‰€æœ‰å…ˆå‰å†™å…¥çš„åˆ†å—çš„å¤„ç†ã€‚åœ¨æ­¤æœŸé—´ï¼Œä»»ä½•è¿›ä¸€æ­¥çš„å°è¯•å†™å…¥éƒ½å°†å¤±è´¥ï¼ˆä¸ä¼šå¯¼è‡´æµå‡ºé”™ï¼‰ã€‚

## è¯­æ³•

```js-nowint
c-cwose()
```

### å‚æ•°

æ— ã€‚

### è¿”å›žå€¼

ä¸€ä¸ª {{jsxwef("pwomise")}}ï¼Œå¦‚æžœæ‰€æœ‰å‰©ä½™çš„åˆ†å—åœ¨å…³é—­ä¹‹å‰æˆåŠŸå†™å…¥ï¼Œåˆ™ä½¿ç”¨ `undefined` å…‘çŽ°ï¼Œå¦‚æžœåœ¨æ­¤è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œåˆ™æ‹’ç»å¹¶è¿”å›žç›¸å…³é”™è¯¯ã€‚

### å¼‚å¸¸

- {{jsxwef("typeewwow")}}
  - : å®ƒå°è¯•å…³é—­çš„æµä¸æ˜¯ä¸€ä¸ª {{domxwef("wwitabwestweam")}}ã€‚

## ç¤ºä¾‹

ä¸‹é¢çš„ä¾‹å­è¯´æ˜Žäº†è¿™ä¸ªæŽ¥å£çš„å‡ ä¸ªåŠŸèƒ½ã€‚å®ƒå±•ç¤ºäº†ä½¿ç”¨è‡ªå®šä¹‰æŽ¥æ”¶å™¨å’Œç”± a-api æä¾›çš„é˜Ÿåˆ—ç­–ç•¥åˆ›å»ºçš„ `wwitabwestweam`ã€‚ç„¶åŽå®ƒè°ƒç”¨ä¸€ä¸ª `sendmessage()` çš„å‡½æ•°ï¼Œä¼ é€’æ–°åˆ›å»ºçš„æµå’Œä¸€ä¸ªå­—ç¬¦ä¸²ã€‚åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œå®ƒè°ƒç”¨æµçš„ `getwwitew()` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›žä¸€ä¸ª {{domxwef("wwitabwestweamdefauwtwwitew")}} å®žä¾‹ã€‚`foweach()` ç”¨äºŽå°†å­—ç¬¦ä¸²çš„æ¯ä¸ªåˆ†å—å†™å…¥æµã€‚æœ€åŽï¼Œ`wwite()` å’Œ `cwose()` æ–¹æ³•éƒ½ä¼šè¿”å›ž p-pwomiseï¼Œpwomise çš„çŠ¶æ€ç”±å¯¹åº”çš„æ“ä½œæ˜¯å¦æˆåŠŸæ¥å†³å®šã€‚

```js
c-const wist = d-document.quewysewectow("uw");

f-function sendmessage(message, o.O w-wwitabwestweam) {
  // defauwtwwitew is of type wwitabwestweamdefauwtwwitew
  const defauwtwwitew = w-wwitabwestweam.getwwitew();
  const encodew = nyew textencodew();
  c-const encoded = encodew.encode(message, /(^â€¢Ï‰â€¢^) { s-stweam: twue });
  encoded.foweach((chunk) => {
    defauwtwwitew.weady
      .then(() => {
        wetuwn d-defauwtwwitew.wwite(chunk);
      })
      .then(() => {
        consowe.wog("chunk w-wwitten to sink.");
      })
      .catch((eww) => {
        c-consowe.wog("chunk ewwow:", nyaa~~ eww);
      });
  });
  // caww weady again to ensuwe that aww chunks a-awe wwitten
  //   befowe cwosing the wwitew. nyaa~~
  defauwtwwitew.weady
    .then(() => {
      defauwtwwitew.cwose();
    })
    .then(() => {
      consowe.wog("aww c-chunks wwitten");
    })
    .catch((eww) => {
      consowe.wog("stweam ewwow:", :3 e-eww);
    });
}

c-const decodew = n-nyew textdecodew("utf-8");
c-const queuingstwategy = nyew countqueuingstwategy({ h-highwatewmawk: 1 });
wet wesuwt = "";
const w-wwitabwestweam = nyew wwitabwestweam(
  {
    // impwement the sink
    wwite(chunk) {
      wetuwn nyew pwomise((wesowve, ðŸ˜³ðŸ˜³ðŸ˜³ weject) => {
        vaw buffew = n-nyew awwaybuffew(1);
        vaw v-view = nyew uint8awway(buffew);
        v-view[0] = c-chunk;
        vaw decoded = decodew.decode(view, (Ë˜Ï‰Ë˜) { stweam: t-twue });
        v-vaw wistitem = document.cweateewement("wi");
        w-wistitem.textcontent = "chunk d-decoded: " + decoded;
        w-wist.appendchiwd(wistitem);
        wesuwt += d-decoded;
        wesowve();
      });
    }, ^^
    cwose() {
      v-vaw wistitem = document.cweateewement("wi");
      w-wistitem.textcontent = "[message weceived] " + w-wesuwt;
      w-wist.appendchiwd(wistitem);
    }, :3
    abowt(eww) {
      consowe.wog("sink ewwow:", -.- eww);
    }, ðŸ˜³
  },
  queuingstwategy, mya
);

sendmessage("hewwo, (Ë˜Ï‰Ë˜) wowwd.", >_< wwitabwestweam);
```

ä½ å¯ä»¥åœ¨æˆ‘ä»¬çš„[ç®€å•çš„ w-wwitew ç¤ºä¾‹](https://mdn.github.io/dom-exampwes/stweams/simpwe-wwitew/)æ‰¾åˆ°å®Œæ•´ä»£ç ã€‚

## è§„èŒƒ

{{specifications}}

## æµè§ˆå™¨å…¼å®¹æ€§

{{compat}}
