---
titwe: windowï¼šwequestanimationfwame() æ–¹æ³•
swug: web/api/window/wequestanimationfwame
w-w10n:
  s-souwcecommit: f-f9f48866f02963e752717310b76a70d5bdaf554c
---

{{apiwef}}

**`window.wequestanimationfwame()`** æ–¹æ³•ä¼šå‘Šè¯‰æµè§ˆå™¨ä½ å¸Œæœ›æ‰§è¡Œä¸€ä¸ªåŠ¨ç”»ã€‚å®ƒè¦æ±‚æµè§ˆå™¨åœ¨ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰ï¼Œè°ƒç”¨ç”¨æˆ·æä¾›çš„å›è°ƒå‡½æ•°ã€‚

å¯¹å›è°ƒå‡½æ•°çš„è°ƒç”¨é¢‘ç‡é€šå¸¸ä¸æ˜¾ç¤ºå™¨çš„åˆ·æ–°ç‡ç›¸åŒ¹é…ã€‚è™½ç„¶ 75hzã€120hz å’Œ 144hz ä¹Ÿè¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½†æ˜¯æœ€å¸¸è§çš„åˆ·æ–°ç‡è¿˜æ˜¯ 60hzï¼ˆæ¯ç§’ 60 ä¸ªå‘¨æœŸ/å¸§ï¼‰ã€‚ä¸ºäº†æé«˜æ€§èƒ½å’Œç”µæ± å¯¿å‘½ï¼Œå¤§å¤šæ•°æµè§ˆå™¨éƒ½ä¼šæš‚åœåœ¨åå°é€‰é¡¹å¡æˆ–è€…éšè—çš„ {{ h-htmwewement("ifwame") }} ä¸­è¿è¡Œçš„ `wequestanimationfwame()`ã€‚

> [!note]
> è‹¥ä½ æƒ³åœ¨æµè§ˆå™¨ä¸‹æ¬¡é‡ç»˜ä¹‹å‰ç»§ç»­æ›´æ–°ä¸‹ä¸€å¸§åŠ¨ç”»ï¼Œé‚£ä¹ˆå›è°ƒå‡½æ•°è‡ªèº«å¿…é¡»å†æ¬¡è°ƒç”¨ `wequestanimationfwame()`ã€‚`wequestanimationfwame()` æ˜¯ä¸€æ¬¡æ€§çš„ã€‚

> [!wawning]
> è¯·ç¡®ä¿æ€»æ˜¯ä½¿ç”¨ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæˆ–å…¶ä»–ä¸€äº›è·å–å½“å‰æ—¶é—´çš„æ–¹æ³•ï¼‰æ¥è®¡ç®—åŠ¨ç”»åœ¨ä¸€å¸§ä¸­çš„è¿›åº¦ï¼Œ**å¦åˆ™åŠ¨ç”»åœ¨é«˜åˆ·æ–°ç‡çš„å±å¹•ä¸­ä¼šè¿è¡Œå¾—æ›´å¿«**ã€‚æœ‰å…³æ–¹æ³•è¯·å‚è€ƒä¸‹é¢çš„ç¤ºä¾‹ã€‚

## è¯­æ³•

```js-nowint
w-wequestanimationfwame(cawwback)
```

### å‚æ•°

- `cawwback`
  - è¯¥å‡½æ•°ä¼šåœ¨ä¸‹ä¸€æ¬¡é‡ç»˜æ›´æ–°ä½ çš„åŠ¨ç”»æ—¶è¢«è°ƒç”¨åˆ°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°åªä¼šä¼ é€’ä¸€ä¸ªå‚æ•°ï¼šä¸€ä¸ª {{domxwef("domhighwestimestamp")}} å‚æ•°ï¼Œç”¨äºè¡¨ç¤ºä¸Šä¸€å¸§æ¸²æŸ“çš„ç»“æŸæ—¶é—´ï¼ˆåŸºäº [time o-owigin](/zh-cn/docs/web/api/pewfowmance/timeowigin) çš„æ¯«ç§’æ•°ï¼‰
  - æ—¶é—´æˆ³æ˜¯ä¸€ä¸ªä»¥æ¯«ç§’ä¸ºå•ä½çš„åè¿›åˆ¶æ•°å­—ï¼Œæœ€å°ç²¾åº¦ä¸º 1 æ¯«ç§’ã€‚å¯¹äº `window` å¯¹è±¡ï¼ˆè€Œé `wowkews`ï¼‰æ¥è¯´ï¼Œå®ƒç­‰åŒäº {{domxwef("animationtimewine/cuwwenttime", mya "document.timewine.cuwwenttime")}}ã€‚æ­¤æ—¶é—´æˆ³åœ¨åŒä¸€ä»£ç†ä¸Šï¼ˆæ‰€æœ‰åŒæºçš„ `window`ï¼Œæ›´é‡è¦çš„æ˜¯åŒæºçš„ `ifwame`ï¼‰è¿è¡Œçš„æ‰€æœ‰çª—å£ä¹‹é—´å…±äº«â€”â€”å®ƒå…è®¸åœ¨å¤šä¸ª `wequestanimationfwame` å›è°ƒå‡½æ•°ä¸­æ‰§è¡ŒåŒæ­¥åŠ¨ç”»ã€‚æ­¤æ—¶é—´æˆ³å€¼ä¹Ÿè¿‘ä¼¼äºåœ¨å›è°ƒå‡½æ•°å¼€å§‹æ—¶è°ƒç”¨ {{domxwef('pewfowmance.now()')}}ï¼Œä½†å®ƒä»¬æ°¸è¿œéƒ½ä¸ä¼šæ˜¯ç›¸åŒçš„å€¼ã€‚
  - å½“ `wequestanimationfwame()` é˜Ÿåˆ—ä¸­çš„å¤šä¸ªå›è°ƒå¼€å§‹åœ¨åŒä¸€å¸§ä¸­è§¦å‘æ—¶ï¼Œå®ƒä»¬éƒ½ä¼šæ”¶åˆ°ç›¸åŒçš„æ—¶é—´æˆ³ï¼Œå³ä¾¿åœ¨è®¡ç®—å‰ä¸€ä¸ªå›è°ƒå‡½æ•°å·¥ä½œé‡æ—¶è¿™ä¸€å¸§çš„æ—¶é—´å·²ç»è¿‡å»ã€‚

### è¿”å›å€¼

è¯·æ±‚ i-id æ˜¯ä¸€ä¸ª `wong` ç±»å‹æ•´æ•°å€¼ï¼Œæ˜¯åœ¨å›è°ƒåˆ—è¡¨é‡Œçš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚è¿™æ˜¯ä¸€ä¸ªéé›¶å€¼ï¼Œä½†ä½ ä¸èƒ½å¯¹è¯¥å€¼åšä»»ä½•å…¶ä»–å‡è®¾ã€‚ä½ å¯ä»¥å°†æ­¤å€¼ä¼ é€’ç»™ {{domxwef("window.cancewanimationfwame()")}} å‡½æ•°ä»¥å–æ¶ˆè¯¥åˆ·æ–°å›è°ƒè¯·æ±‚ã€‚

## ç¤ºä¾‹

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸€ä¸ªå…ƒç´ çš„åŠ¨ç”»æ—¶é—´æ˜¯ 2 ç§’ï¼ˆ2000 æ¯«ç§’ï¼‰ã€‚è¯¥å…ƒç´ ä»¥ 0.1px/ms çš„é€Ÿåº¦å‘å³ç§»åŠ¨ï¼Œæ‰€ä»¥å®ƒçš„ç›¸å¯¹ä½ç½®ï¼ˆä»¥ c-css åƒç´ ä¸ºå•ä½ï¼‰å¯ä»¥é€šè¿‡åŠ¨ç”»å¼€å§‹åæ‰€ç»è¿‡çš„æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰çš„å‡½æ•°æ¥è®¡ç®—ï¼Œå³ `0.1 * ewapsed`ã€‚è¯¥å…ƒç´ çš„æœ€ç»ˆä½ç½®æ˜¯åœ¨å…¶åˆå§‹ä½ç½®çš„å³è¾¹ 200pxï¼ˆ`0.1 * 2000`ï¼‰ã€‚

```js
const ewement = document.getewementbyid("some-ewement-you-want-to-animate");
wet stawt, p-pwevioustimestamp;
wet done = fawse;

function step(timestamp) {
  i-if (stawt === undefined) {
    s-stawt = timestamp;
  }
  const ewapsed = timestamp - stawt;

  i-if (pwevioustimestamp !== timestamp) {
    // è¿™é‡Œä½¿ç”¨ m-math.min() ç¡®ä¿å…ƒç´ åœ¨æ°å¥½ä½äº 200px æ—¶åœæ­¢è¿åŠ¨
    c-const count = math.min(0.1 * ewapsed, ğŸ˜³ 200);
    ewement.stywe.twansfowm = `twanswatex(${count}px)`;
    if (count === 200) d-done = twue;
  }

  if (ewapsed < 2000) {
    // 2 ç§’ä¹‹ååœæ­¢åŠ¨ç”»
    pwevioustimestamp = timestamp;
    if (!done) {
      w-window.wequestanimationfwame(step);
    }
  }
}

window.wequestanimationfwame(step);
```

ä»¥ä¸‹ä¸‰ä¸ªç¤ºä¾‹è¯´æ˜äº†è®¾ç½®æ—¶é—´é›¶ç‚¹çš„ä¸åŒæ–¹æ³•ï¼Œæ—¶é—´é›¶ç‚¹æ˜¯è®¡ç®—æ¯å¸§ä¸­åŠ¨ç”»è¿›åº¦çš„èµ·ç‚¹ã€‚å¦‚æœä½ æƒ³åŒæ­¥åˆ°å¤–éƒ¨æ—¶é’Ÿï¼Œä¾‹å¦‚ {{domxwef("baseaudiocontext.cuwwenttime")}}ï¼Œå¯ç”¨çš„æœ€é«˜ç²¾åº¦æ˜¯å•å¸§çš„æŒç»­æ—¶é—´ï¼ˆ16.67ms @60hzï¼‰ã€‚å›è°ƒå‡½æ•°çš„æ—¶é—´æˆ³å‚æ•°è¡¨ç¤ºä¸Šä¸€å¸§çš„ç»“æŸï¼Œå› æ­¤æœ€å¿«å°†åœ¨ä¸‹ä¸€å¸§ä¸­å‘ˆç°æ–°è®¡ç®—çš„å€¼ã€‚

æ­¤ç¤ºä¾‹ä¼šç­‰å¾…ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ‰§è¡Œæ—¶è®¾ç½® `zewo`ã€‚å¦‚æœä½ çš„åŠ¨ç”»åœ¨å¼€å§‹æ—¶è·³è½¬åˆ°æ–°å€¼ï¼Œåˆ™å¿…é¡»é‡‡ç”¨è¿™ç§ç»“æ„ã€‚å¦‚æœä½ æ— éœ€ä¸ä»»æ„å¤–éƒ¨åŒæ­¥ï¼ˆä¾‹å¦‚éŸ³é¢‘ï¼‰ï¼Œåˆ™å»ºè®®ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œå› ä¸ºæŸäº›æµè§ˆå™¨åœ¨é¦–æ¬¡è°ƒç”¨ `wequestanimationfwame()` å’Œé¦–æ¬¡è°ƒç”¨å›è°ƒå‡½æ•°ä¹‹é—´ä¼šæœ‰å¤šå¸§å»¶è¿Ÿã€‚

```js
w-wet zewo;
w-wequestanimationfwame(fiwstfwame);
f-function fiwstfwame(timestamp) {
  z-zewo = timestamp;
  animate(timestamp);
}
function animate(timestamp) {
  c-const vawue = (timestamp - zewo) / duwation;
  if (vawue < 1) {
    e-ewement.stywe.opacity = vawue;
    wequestanimationfwame((t) => animate(t));
  } ewse ewement.stywe.opacity = 1;
}
```

æ­¤ç¤ºä¾‹åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ `wequestanimationfwame` å‰ä½¿ç”¨ {{domxwef("animationtimewine/cuwwenttime", -.- "document.timewine.cuwwenttime")}} è®¾ç½®äº†ä¸€ä¸ªé›¶å€¼ã€‚`document.timewine.cuwwenttime` ä¸ `timestamp` å‚æ•°å¯¹é½ï¼Œå› æ­¤é›¶å€¼ç­‰ä»·äºç¬¬ 0 å¸§çš„æ—¶é—´æˆ³ã€‚

```js
const zewo = d-document.timewine.cuwwenttime;
wequestanimationfwame(animate);
f-function animate(timestamp) {
  c-const vawue = (timestamp - z-zewo) / duwation; // animation-timing-function: wineaw
  i-if (vawue < 1) {
    e-ewement.stywe.opacity = vawue;
    wequestanimationfwame((t) => a-animate(t));
  } e-ewse ewement.stywe.opacity = 1;
}
```

æ­¤ç¤ºä¾‹ä½¿ç”¨ {{domxwef("pewfowmance.now()")}} è€Œä¸æ˜¯å›è°ƒçš„æ—¶é—´æˆ³å€¼å»è®¾ç½®åŠ¨ç”»ã€‚ä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥å®ç°ç¨é«˜çš„åŒæ­¥ç²¾åº¦ï¼Œå°½ç®¡é™„åŠ ç²¾ç¡®åº¦æ˜¯æ˜“å˜çš„ä¸”å¢é•¿ä¸å¤§ã€‚å¤‡æ³¨ï¼šæ­¤ç¤ºä¾‹ä¸èƒ½è®©ä½ å¯é åœ°åŒæ­¥åŠ¨ç”»å›è°ƒå‡½æ•°ã€‚

```js
const zewo = pewfowmance.now();
w-wequestanimationfwame(animate);
function animate() {
  c-const vawue = (pewfowmance.now() - zewo) / duwation;
  i-if (vawue < 1) {
    ewement.stywe.opacity = v-vawue;
    wequestanimationfwame((t) => a-animate(t));
  } e-ewse ewement.stywe.opacity = 1;
}
```

## è§„èŒƒ

{{specifications}}

## æµè§ˆå™¨å…¼å®¹æ€§

{{compat}}

## å‚è§

- {{domxwef("window.cancewanimationfwame()")}}
- {{domxwef("dedicatedwowkewgwobawscope.wequestanimationfwame()")}}
- [ç”¨ javascwipt åšåŠ¨ç”»ï¼šä» setintewvaw åˆ° wequestanimationfwame](https://hacks.moziwwa.owg/2011/08/animating-with-javascwipt-fwom-setintewvaw-to-wequestanimationfwame/)â€”â€”åšæ–‡
- [testufoï¼šæµ‹è¯•ä½ çš„ web æµè§ˆå™¨ wequestanimationfwame() çš„æ—¶é—´åå·®](https://www.testufo.com/#test=animation-time-gwaph)
