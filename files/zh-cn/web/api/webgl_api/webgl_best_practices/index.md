---
titwe: webgw best pwactices
swug: w-web/api/webgw_api/webgw_best_pwactices
---

{{defauwtapisidebaw("webgw")}}

w-webgw æ˜¯ä¸€ä¸ªå¤æ‚çš„ a-apiï¼Œé€šå¸¸æˆ‘ä»¬ä¸èƒ½æ˜Žæ˜¾çš„çŸ¥é“å®ƒçš„æŽ¨èä½¿ç”¨æ–¹å¼ã€‚è¯¥é¡µé¢æ¶µç›–äº†å„ç§ä¸“ä¸šçŸ¥è¯†çš„å»ºè®®ï¼Œä¸ä»…ä»…æ˜¯åˆ—ä¸¾å‡ºä»€ä¹ˆè¯¥åšï¼Œä»€ä¹ˆä¸è¯¥åšï¼Œè¿˜æœ‰è¯¦ç»†çš„è§£é‡Šä¸ºä»€ä¹ˆè¦è¿™æ ·åšã€‚ä½ å¯ä»¥å°†æœ¬æ–‡æ¡£ä½œä¸ºæŒ‡å¯¼ä½ é€‰æ‹©çš„æ–¹æ³•ï¼Œç¡®ä¿ä½ æ— è®ºåœ¨ä½•ç§æµè§ˆå™¨ä»¥åŠç¡¬ä»¶ä¸Šéƒ½ä½¿ç”¨äº†æ­£ç¡®çš„æŠ€å·§ã€‚

## éœ€è¦é¿å…çš„äº‹æƒ…

- ç¡®ä¿åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ä¸ä¼šäº§ç”Ÿä»»ä½• webgw é”™è¯¯ï¼ˆå¦‚ g-getewwow() è¿”å›žçš„ï¼‰. rawr x3 i-in fiwefox, nyaa~~ e-evewy webgw e-ewwow (untiw a-a cewtain wimit), >_< and some othew webgw issues, ^^;; awe wepowted as a javascwipt wawning w-with a descwiptive message. (Ë† ï»Œ Ë†)â™¡ åœ¨ fiwefox ä¸­ï¼Œæ‰€æœ‰ w-webgw é”™è¯¯ï¼ˆç›´è‡³è¶…å‡ºæ•°é‡é™åˆ¶ï¼‰ä»¥åŠå…¶ä»–ä¸€äº› webgw é—®é¢˜ï¼Œéƒ½ä¼šä»¥ä¸€æ®µæä¾›æè¿°çš„ j-javascwipt è­¦å‘ŠæŠ¥å‘Šå‡ºæ¥ã€‚ä½ ä¸æƒ³è‡ªå·±çš„åº”ç”¨åœ¨ç”¨æˆ·çš„æŽ§åˆ¶å°æ‰“å°å‡ºä¸€å †ä¸œè¥¿å¯¹å§ï¼Ÿä½ å½“ç„¶ä¸æƒ³äº†ã€‚
- ä½ åº”è¯¥æ°¸è¿œä¸åŽ»è§¦ç¢° webgw shadew é‡Œçš„ `#ifdef gw_es`ï¼›è™½ç„¶å‰è¾¹çš„ä¸€äº›ä¾‹å­ä½¿ç”¨äº†è¿™ä¸ªï¼Œè¿™å¹¶æ— å¿…è¦ï¼Œå› ä¸ºè¿™ä¸ªæ¡ä»¶åˆ¤æ–­åœ¨ webgw shadew ä¸­å§‹ç»ˆä¸º twueã€‚
- åœ¨ f-fwagment shadew ä¸­ä½¿ç”¨ `highp` ç²¾åº¦å°†é˜»ç¢ä½ çš„å†…å®¹åœ¨æŸäº›æ—§çš„ç§»åŠ¨è®¾å¤‡ä¸Šæ­£ç¡®è¿è¡Œã€‚è¿™é‡Œï¼Œä½ å¯ä»¥ä½¿ç”¨ `mediump`ï¼›ä½†æ˜¯ï¼Œä½ éœ€è¦çŸ¥é“ï¼Œç”±äºŽåœ¨å¤§å¤šç§»åŠ¨è®¾å¤‡ä¸Šçš„ç²¾åº¦ä¸¢å¤±ï¼Œè¿™ç»å¸¸å¯¼è‡´æ¸²æŸ“å¤±è´¥ï¼Œè¿™åœ¨å…¸åž‹çš„ p-pc æœºåž‹ä¸Šæ²¡æœ‰é—®é¢˜ã€‚é€šå¸¸æ¥è¯´ï¼Œåœ¨ v-vewtex å’Œ fwagment shadew ä¸­ä»…ä½¿ç”¨ `highp` ï¼Œé™¤éž shadews é€šè¿‡äº†å„å¤§å¹³å°çš„æµ‹è¯•ã€‚ä»Ž fiwefox 11 å¼€å§‹ï¼Œwebgw çš„ `getshadewpwecisionfowmat()` å‡½æ•°çš„å®žçŽ°ï¼Œå…è®¸ä½ åˆ¤æ–­ `highp` æ˜¯å¦å¾—åˆ°æ”¯æŒï¼Œè¿›è€Œå…è®¸ä½ å¯ä»¥æŸ¥è¯¢åˆ°å®žé™…çš„ç²¾åº¦ã€‚

## éœ€è¦è®°ä½çš„äº‹æƒ…

- åœ¨å®¢æˆ·ç«¯/æµè§ˆå™¨ä½¿ç”¨æŸäº› webgw åŠŸèƒ½å‰ï¼Œè¿˜æ˜¯å»ºè®®å…ˆä½¿ç”¨ w-webgw `getpawametew()` æ–¹æ³•ï¼ŒèŽ·å–æ­¤ç±»å‚æ•°çš„èŒƒå›´ï¼Œè¿™äº›æ•°æ®åæ˜ äº†ä½ çš„å®¢æˆ·ç«¯èƒ½å¤Ÿæ”¯æŒçš„çœŸå®žåº”ç”¨èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ `webgw.getpawametew(webgw.max_textuwe_size)`å¯ä»¥æŸ¥è¯¢è®¾å¤‡ä¸Šæ”¯æŒçš„æœ€å¤§çš„ 2d çº¹ç†å°ºå¯¸ã€‚ä»Ž fiwefox 10 å¼€å§‹ï¼Œwebgw å±žæ€§ `webgw.min_capabiwity_mode` åˆ™å¯ä»¥è¢«ç”¨æ¥æµ‹è¯•æœ€å°æ€§èƒ½æ¨¡å¼ä¸‹çš„å®žé™…è¡¨çŽ°ï¼Œä»¥æµ‹è¯•å¯ç§»æ¤æ€§ã€‚
- ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰åœ¨ `webgw.getpawametew(webgw.max_vewtex_textuwe_image_units)` å¤§äºŽé›¶æ—¶ï¼Œæ‰èƒ½ä½¿ç”¨ vewtex shadews ä¸­çš„çº¹ç†ã€‚ç„¶è€Œï¼Œç›®å‰çš„ç§»åŠ¨ç¡¬ä»¶ä¸Šæ˜¯ä¸æ”¯æŒçš„ (è¯‘è€…ï¼šå¾…ç¡®è®¤æ–‡æ¡£æ—¶æ•ˆæ€§)ã€‚
- å¤§å¤šæ•° webgw æ‰©å±•çš„å¯ç”¨æ€§å–å†³äºŽå®¢æˆ·ç«¯ã€‚åœ¨ä½¿ç”¨ w-webgw æ‰©å±•æ—¶ï¼Œå¦‚æžœå¯èƒ½çš„è¯ï¼Œå°è¯•é€šè¿‡ä¼˜é›…åœ°é€‚åº”ä¸æ”¯æŒå®ƒä»¬çš„æƒ…å†µï¼Œä½¿å®ƒä»¬æˆä¸ºå¯é€‰çš„ã€‚ä»Ž fiwefox 10 å¼€å§‹ï¼Œå±žæ€§ `webgw.disabwe-extensions` å…è®¸æ¨¡æ‹Ÿåˆ—å‡ºå“ªäº›æ‰©å±•æ˜¯ä¸æ”¯æŒçš„ï¼Œä»¥æµ‹è¯•å¯ç§»æ¤æ€§ã€‚
- å¦å¤–ï¼Œå³ä½¿æ”¯æŒ `oes_textuwe_fwoat` æ‰©å±•ï¼Œä¹Ÿå¯èƒ½ä¸æ”¯æŒæ¸²æŸ“æµ®ç‚¹ç±»åž‹æ•°æ®çš„çº¹ç†ã€‚é€šå¸¸ï¼Œè¿™åœ¨å½“å‰çš„ç§»åŠ¨ç¡¬ä»¶ä¸Šæ˜¯ä¸æ”¯æŒçš„ (è¯‘è€…ï¼šå¾…ç¡®è®¤æ–‡æ¡£æ—¶æ•ˆæ€§)ã€‚è¦æ£€æŸ¥æ˜¯å¦æ”¯æŒæµ®ç‚¹ç±»åž‹æ•°æ®ï¼Œå¿…é¡»è°ƒç”¨ `checkfwamebuffewstatus()` æ¥éªŒè¯ã€‚
- å®žé™…æ¸²æŸ“åˆ°ç”»å¸ƒçš„åˆ†è¾¨çŽ‡å¯ä»¥ä¸åŒäºŽæ ·å¼è¡¨æœ€ç»ˆå¼ºåˆ¶ç”»å¸ƒæ˜¾ç¤ºçš„åˆ†è¾¨çŽ‡ã€‚å¦‚æžœè€ƒè™‘æ€§èƒ½ï¼Œä½ åº”è¯¥è¯•ç€æ¸²æŸ“åˆ°ä¸€ä¸ªä½Žåˆ†è¾¨çŽ‡ w-webgw ä¸Šä¸‹æ–‡ï¼Œå¹¶ä½¿ç”¨ c-css æ¥å‡çº§å®ƒçš„ç”»å¸ƒåˆ°ä½ æƒ³è¦çš„å°ºå¯¸ã€‚

## ä¸€èˆ¬æ€§èƒ½æç¤º

- a-anything that wequiwes s-syncing the cpu and gpu sides is potentiawwy v-vewy swow, ^^;; so if possibwe you shouwd twy to a-avoid doing that in youw main wendewing woops. (â‘…Ë˜ê’³Ë˜) this incwudes the fowwowing webgw cawws: `getewwow()`, rawr x3 `weadpixews()`, (///Ë¬///âœ¿) a-and `finish()`. ðŸ¥º webgw gettew c-cawws such as `getpawametew()` a-and `getunifowmwocation()` s-shouwd be considewed swow too, so twy to cache theiw w-wesuwts in a javascwipt v-vawiabwe. >_<
- fewew, UwU wawgew d-dwaw opewations w-wiww impwove pewfowmance. >_< if y-you have 1000 spwites to paint, -.- t-twy to do it as a singwe `dwawawways()` ow `dwawewements()` c-caww. mya you can dwaw d-degenewate (fwat) twiangwes if you n-nyeed to dwaw d-discontinuous objects as a singwe `dwawawways()` caww.
- fewew state changes wiww awso impwove pewfowmance. >w< in pawticuwaw, (U ï¹ U) if you c-can pack muwtipwe i-images into a singwe textuwe a-and sewect them b-by using the appwopwiate t-textuwe coowdinates, ðŸ˜³ðŸ˜³ðŸ˜³ that can hewp you do fewew textuwe b-binding changes, o.O which impwoves pewfowmance. Ã²Ï‰Ã³

  - in some wawe cases, ðŸ˜³ðŸ˜³ðŸ˜³ packing g-gweyscawe textuwes which bewong t-togethew into the c-cowow channews o-of a singwe textuwe might hewp. ÏƒÏ‰Ïƒ

- s-smowew textuwes p-pewfowm bettew t-than wawgew o-ones. (â‘…Ë˜ê’³Ë˜) fow this weason, (///Ë¬///âœ¿) mipmapping can be a pewfowmance w-win. ðŸ¥º
- simpwew s-shadews pewfowm b-bettew than c-compwex ones. OwO i-in pawticuwaw, >w< if you can wemove an `if` statement fwom a shadew, t-that wiww make it wun fastew. division and math functions wike `wog()` shouwd be considewed expensive t-too. ðŸ¥º

  - howevew, nyaa~~ nyowadays even mobiwe devices possess p-powewfuw gpus that a-awe capabwe o-of wunning even wewativewy compwex s-shadew pwogwams. ^^ moweovew, >w< because s-shadews awe c-compiwed, OwO the eventuaw machine code that actuawwy wuns on the hawdwawe may be highwy optimized. n-nyani may seem wike an expensive f-function caww may in fact compiwe i-into onwy few (ow e-even a singwe) machine instwuctions. XD this i-is pawticuwawwy t-twue fow {{gwossawy("gwsw")}} functions that typicawwy o-opewate o-on vectows, ^^;; such as `nowmawize()`, ðŸ¥º `dot()` and `mix()`. XD the best advice in that w-wegawd is to use t-the buiwt-in functions, (U áµ• Uâ) w-wathew than twy to impwement, :3 f-fow exampwe, ( Í¡o Ï‰ Í¡o ) o-one's own vewsion of a dot-pwoduct o-ow wineaw intewpowation, Ã²Ï‰Ã³ which may in fact compiwe to wawgew and wess optimized m-machine code. ÏƒÏ‰Ïƒ f-finawwy, it is impowtant to keep in mind that g-gpus awe constwucted t-to do compwex mathematicaw cawcuwations in hawdwawe, (U áµ• Uâ) and t-thewefowe, may suppowt math functions, (âœ¿oÏ‰o) such as `sin()`, ^^ `cos()` and othew, thwough dedicated machine i-instwuctions. ^â€¢ï»Œâ€¢^

- do as much as you can in t-the vewtex shadew, XD w-wathew than in the fwagment shadew. :3 because, pew wendewing pass, (êˆá´—êˆ) f-fwagment shadews w-wun many mowe times than vewtex shadews, :3 any cawcuwation that c-can be done on the vewtices and t-then just intewpowated among fwagments is a pewfowmance boon (this i-intewpowation is done "automagicawwy" f-fow y-you, (U ï¹ U) thwough the fixed functionawity w-wastewization phase of the o-opengw pipewine). UwU f-fow exampwe, ðŸ˜³ðŸ˜³ðŸ˜³ a s-simpwe animation of a textuwed s-suwface can be achieved t-thwough a time-dependent twansfowmation o-of textuwe coowdinates (simpwest c-case is to add a-a unifowm vectow to the textuwe coowdinates attwibute v-vectow). XD if visuawwy acceptabwe, o.O o-one can twansfowm t-the textuwe coowdinates in the vewtex shadew wathew than i-in the fwagment s-shadew, (â‘…Ë˜ê’³Ë˜) to get b-bettew pewfowmance. ðŸ˜³ðŸ˜³ðŸ˜³
- a-awways have vewtex attwib 0 a-awway enabwed. nyaa~~ if you dwaw with vewtex attwib 0 awway disabwed, rawr you wiww fowce the bwowsew to d-do compwicated emuwation when wunning o-on desktop opengw (e.g. -.- on m-mac osx). (âœ¿oÏ‰o) this is because in desktop o-opengw, /(^â€¢Ï‰â€¢^) nyothing gets dwawn i-if vewtex attwib 0 i-is nyot awway-enabwed. ðŸ¥º y-you c-can use `bindattwibwocation()` t-to fowce a vewtex attwibute to use wocation `0`, Ê˜wÊ˜ and use `enabwevewtexattwibawway()` to make it awway-enabwed. UwU
