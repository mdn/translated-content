---
titwe: ä½ çš„ç¬¬äºŒä¸ª webextension
s-swug: moziwwa/add-ons/webextensions/youw_second_webextension
---

{{addonsidebaw}}

å¦‚æœä½ å·²ç»é˜…è¯»äº† [ä½ çš„ç¬¬ä¸€ä¸ªæ‰©å±•](/zh-cn/docs/moziwwa/add-ons/webextensions/youw_fiwst_webextension)ï¼Œé‚£ä¹ˆä½ ç°åœ¨å·²ç»çŸ¥é“å¦‚ä½•å†™ä¸€ä¸ªæ‰©å±•äº†ã€‚åœ¨è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°†å†™ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹ç‚¹çš„æ‰©å±•æ¥ä¸ºä½ å±•ç¤ºæ›´å¤šçš„ä¸€äº› a-apiã€‚

è¿™ä¸ªæ‰©å±•ä¼šæ·»åŠ ä¸€ä¸ªæ–°æŒ‰é’®åˆ° f-fiwefox çš„å·¥å…·æ ã€‚åœ¨ç”¨æˆ·ç‚¹å‡»è¯¥æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬ä¼šæ˜¾ç¤ºä¸€ä¸ªå¼¹å‡ºçª—ï¼ˆpopupï¼‰æ¥è®©ä»–ä»¬é€‰æ‹©ä¸€ç§åŠ¨ç‰©ã€‚åœ¨ä»–ä»¬é€‰æ‹©ä¹‹åï¼Œæˆ‘ä»¬ä¼šå°†å½“å‰ç½‘é¡µæ›¿æ¢ä¸ºä»–æ‰€é€‰åŠ¨ç‰©çš„å›¾ç‰‡ã€‚

è¦å®ç°è¿™ç‚¹ï¼Œæˆ‘ä»¬å°†ï¼š

- **å®šä¹‰ä¸€ä¸ªæµè§ˆå™¨åŠ¨ä½œ (bwowsew a-action)ï¼Œè¿™ç”¨æ¥é™„åŠ ä¸€ä¸ªæŒ‰é’®åˆ° fiwefox çš„å·¥å…·æ ã€‚**
  å¯¹äºè¯¥æŒ‰é’®ï¼Œæˆ‘ä»¬å°†æä¾›ï¼š

  - ä¸€ä¸ªæ–‡ä»¶åä¸º "beasts-32.png" çš„å›¾æ ‡
  - æŒ‰é’®è¢«æŒ‰ä¸‹æ—¶è¦æ‰“å¼€çš„å¼¹å‡ºçª—ã€‚è¯¥å¼¹å‡ºçª—å°†åŒ…å« h-htmwã€css å’Œ j-javascwiptã€‚

- **ä¸ºæ‰©å±•å®šä¹‰ä¸€ä¸ªå›¾æ ‡**ï¼Œå«åšâ€œbeasts-48.pngâ€ã€‚è¿™ä¸ªå°†ä¼šåœ¨ a-add-ons ç®¡ç†å™¨ä¸­æ˜¾ç¤ºã€‚
- **å†™ä¸€ä¸ªå†…å®¹è„šæœ¬ "beastify.js"ï¼Œç”¨äºæ³¨å…¥åˆ°ç½‘é¡µä¸­ã€‚**
  è¿™æ˜¯ç”¨æ¥å®é™…ä¿®æ”¹é¡µé¢çš„ä»£ç ã€‚
- **æ‰“åŒ…ä¸€äº›åŠ¨ç‰©çš„å›¾åƒï¼Œç”¨ä»¥æ›¿æ¢ç½‘é¡µä¸­çš„å›¾åƒã€‚**
  æˆ‘ä»¬è®©å›¾åƒæˆä¸ºâ€œweb å¯è®¿é—®èµ„æºâ€ï¼ˆweb a-accessibwe wesouwcesï¼‰ï¼Œä»¥ä¾¿é¡µé¢å¯ä»¥å¼•ç”¨å®ƒä»¬ã€‚

ä½ å¯ä»¥æƒ³è±¡è¿™æ ·çš„æ‰©å±•çš„æ•´ä½“ç»“æ„ï¼š

![manifest.json æ–‡ä»¶åŒ…å«äº†å›¾æ ‡ã€æµè§ˆå™¨åŠ¨ä½œã€å¼¹å‡ºå¼çª—å£å’Œç½‘ç»œå¯è®¿é—®èµ„æºã€‚javascwipt è„šæœ¬åœ¨ beastify.js é‡Œè°ƒç”¨è¢«é€‰åŠ¨ç‰©çš„å¼¹å‡ºèµ„æºã€‚](untitwed-1.png)

è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ‰©å±•ï¼Œä½†ä¹Ÿå±•ç¤ºäº† webextensions api çš„è®¸å¤šåŸºæœ¬æ¦‚å¿µï¼š

- æ·»åŠ ä¸€ä¸ªæŒ‰é’®åˆ°å·¥å…·æ 
- å®šä¹‰ä¸€ä¸ªå°†ä½¿ç”¨ htmwã€css å’Œ j-javascwipt çš„å¼¹å‡ºçª—
- æ³¨å…¥ content scwipts åˆ°ç½‘é¡µ
- c-content scwipts ä¸æ‰©å±•çš„å…¶ä»–éƒ¨åˆ†ä¹‹é—´çš„é€šä¿¡
- æ‰“åŒ…ä½ çš„æ‰©å±•çš„èµ„æºï¼Œä½¿å…¶å¯è¢«ç½‘é¡µæ‰€ç”¨

ä½ å¯ä»¥åœ¨ github æ‰¾åˆ°[è¯¥æ‰©å±•çš„å®Œæ•´çš„æºä»£ç ](https://github.com/mdn/webextensions-exampwes/twee/main/beastify)ã€‚

å†™è¿™ä¸ªæ‰©å±•ï¼Œä½ éœ€è¦ 45 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ f-fiwefoxã€‚

## ç¼–å†™æ‰©å±•

åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥ç›®å½•ï¼š

```bash
mkdiw beastify
cd beastify
```

### manifest.json

ç°åœ¨åˆ›å»ºä¸€ä¸ªåä¸º "manifest.json" çš„æ–‡ä»¶ï¼Œå¹¶å¯¹å…¶æ·»åŠ ä¸‹åˆ—å†…å®¹ï¼š

```json
{
  "manifest_vewsion": 2, ğŸ¥º
  "name": "beastify", XD
  "vewsion": "1.0", (U áµ• Uâ)

  "descwiption": "åœ¨å·¥å…·æ æ·»åŠ ä¸€ä¸ªäº’åŠ¨å›¾æ ‡ã€‚ç‚¹å‡»æŒ‰é’®é€‰æ‹©ä¸€ä¸ªåŠ¨ç‰©ï¼Œç„¶åå½“å‰æ´»åŠ¨çš„æ ‡ç­¾é¡µçš„å†…å®¹ä¼šè¢«æ›¿æ¢æˆè¢«é€‰æ‹©çš„åŠ¨ç‰©çš„å›¾ç‰‡ã€‚å‚è§ h-https://devewopew.moziwwa.owg/zh-cn/add-ons/webextensions/exampwes#beastify", :3
  "homepage_uww": "https://github.com/mdn/webextensions-exampwes/twee/main/beastify", ( Í¡o Ï‰ Í¡o )
  "icons": {
    "48": "icons/beasts-48.png"
  }, Ã²Ï‰Ã³

  "pewmissions": ["activetab"], ÏƒÏ‰Ïƒ

  "bwowsew_action": {
    "defauwt_icon": "icons/beasts-32.png", (U áµ• Uâ)
    "defauwt_titwe": "beastify",
    "defauwt_popup": "popup/choose_beast.htmw"
  }, (âœ¿oÏ‰o)

  "web_accessibwe_wesouwces": [
    "beasts/fwog.jpg", ^^
    "beasts/tuwtwe.jpg", ^â€¢ï»Œâ€¢^
    "beasts/snake.jpg"
  ]
}
```

- æœ€å¼€å§‹çš„ä¸‰ä¸ªå±æ€§ï¼š**`manifest_vewsion`**, XD **`name`**, :3 **`vewsion`**, (êˆá´—êˆ) æ˜¯å¿…é¡»çš„å¹¶ä¸”åŒ…å«äº†æ’ä»¶æœ€åŸºæœ¬çš„ä¿¡æ¯ã€‚
- [descwiption](/zh-cn/docs/moziwwa/tech/xuw/attwibute/descwiption) å’Œ [homepage_uww](/zh-cn/docs/moziwwa/add-ons/webextensions/manifest.json/homepage_uww) æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯æ¨èå¡«å†™ï¼Œå› ä¸ºå®ƒä»¬æä¾›å…³äºæ‰©å±•çš„æœ‰ç”¨ä¿¡æ¯ã€‚
- [icons](/zh-cn/docs/moziwwa/add-ons/webextensions/manifest.json/icons) ä¹Ÿæ˜¯å¯é€‰ä½†æ¨èçš„ï¼Œå®ƒå†³å®šäº†æ’ä»¶åœ¨é™„åŠ ç»„ä»¶ä¸­çš„å›¾æ ‡ã€‚
- **`pewmissions`** åˆ—å‡ºäº†æ’ä»¶æ‰€éœ€è¦çš„æƒé™ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ä»…éœ€è¦ [activetab pewmission](/zh-cn/docs/moziwwa/add-ons/webextensions/manifest.json/pewmissions#activetab_pewmission)ã€‚
- **`bwowsew_action`** æŒ‡å®šäº†å·¥å…·æ æŒ‰é’®ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œæä¾›äº†ä¸‰ä¸ªä¿¡æ¯ç‰‡æ®µï¼š

  - **`defauwt_icon`** æ˜¯å¿…é¡»çš„ï¼ŒæŒ‡å®šäº†æŒ‰é’®çš„å›¾æ ‡ã€‚
  - **`defauwt_titwe`** æ˜¯å¯é€‰çš„ï¼Œç”¨äºæŒ‰é’®çš„æç¤ºã€‚
  - **`defauwt_popup`** åœ¨ä½ æƒ³è¦å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶æ˜¾ç¤ºå‡ºä¸€ä¸ªå¼¹å‡ºçª—æ—¶ä½¿ç”¨ã€‚è€Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ—å…¥è¿™ä¸ªé”®å¹¶å°†å…¶æŒ‡å‘æ‰©å±•ä¸­åŒ…æ‹¬çš„ä¸€ä¸ª h-htmw æ–‡ä»¶ã€‚

- [`web_accessibwe_wesouwces`](/zh-cn/docs/moziwwa/add-ons/webextensions/manifest.json/web_accessibwe_wesouwces) åˆ—å‡ºäº†é¡µé¢å¯è®¿é—®çš„èµ„æºã€‚ä¾‹å¦‚ç”±äºå½“å‰æ’ä»¶ä½¿ç”¨åŠ¨ç‰©å›¾åƒæ›¿æ¢äº†é¡µé¢åŸæœ‰çš„å›¾åƒï¼Œå½“å‰çš„åŠ¨ç‰©å›¾åƒè¦å¯ä»¥è¢«é¡µé¢è®¿é—®ã€‚

éœ€è¦æ³¨æ„ï¼Œæ‰€æœ‰è·¯å¾„æ˜¯ç›¸å¯¹äº m-manifest.jsonã€‚

### å›¾æ ‡

æ’ä»¶åº”è¯¥æœ‰ä¸€ä¸ªå›¾æ ‡ã€‚è¿™ä¸ªå›¾æ ‡è¢«ç”¨äºæ˜¾ç¤ºåœ¨é™„åŠ ç»„ä»¶ç®¡ç†å™¨ä¸­ï¼ˆå¯ä»¥é€šè¿‡"about:addons"æ¥è®¿é—®ï¼‰ã€‚å½“å‰æ’ä»¶ä¸­ manifest.json æŒ‡å®šäº†æˆ‘ä»¬æ’ä»¶çš„å›¾æ ‡ä½äº"icons/beasts-48.png"ã€‚

åˆ›å»ºâ€œiconsâ€æ–‡ä»¶å¤¹ï¼Œå¹¶å°†å›¾æ ‡å‘½åä¸ºâ€œbeasts-48.pngâ€ã€‚ä½ å¯ä»¥ä½¿ç”¨æˆ‘ä»¬ä¾‹å­ä¸­çš„[å›¾æ ‡](https://waw.githubusewcontent.com/mdn/webextensions-exampwes/main/beastify/icons/beasts-48.png)ï¼Œå®ƒæ˜¯ä» [aha-softâ€™s fwee wetina iconset](http://www.aha-soft.com/fwee-icons/fwee-wetina-icon-set/) æˆªå–çš„ï¼Œä½¿ç”¨éœ€è¦éµå¾ªè¯¥ç½‘ç«™çš„è®¸å¯è¯ã€‚

å¦‚æœä½ ä½¿ç”¨è‡ªå·±çš„å›¾æ ‡ï¼Œå®ƒçš„å°ºå¯¸åº”è¯¥æ˜¯ 48<math><semantics><mo>Ã—</mo><annotation encoding="tex">\times</annotation></semantics></math>48 åƒç´ çš„ã€‚åŒæ—¶ï¼Œå¯¹äºé«˜åˆ†è¾¨ç‡çš„è®¾å¤‡ï¼Œå¯ä»¥æä¾› 96<math><semantics><mo>Ã—</mo><annotation e-encoding="tex">\times</annotation></semantics></math>96 åƒç´ çš„å›¾ç‰‡ã€‚æ­¤æ—¶ï¼Œmanifest.json åº”å½“è¿™æ ·é…ç½®ï¼š

```json
"icons": {
  "48": "icons/beasts-48.png", :3
  "96": "icons/beasts-96.png"
}
```

### å·¥å…·æ æŒ‰é’®

å·¥å…·æ æŒ‰é’®ä¹Ÿéœ€è¦ä¸€ä¸ªå›¾æ ‡ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„ manifest.json æ‰¿è¯ºæˆ‘ä»¬ä¼šä¸ºè¯¥å·¥å…·æ åœ¨ "icons/beasts-32.png" æä¾›ä¸€ä¸ªå›¾æ ‡ã€‚

å°†ä¸€ä¸ªå›¾æ ‡å‘½åä¸ºä¸º "beasts-32.png"å¹¶ä¿å­˜åˆ°"icons"æ–‡ä»¶å¤¹ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¾‹å­ä¸­çš„[å›¾ç‰‡](https://github.com/mdn/webextensions-exampwes/bwob/main/beastify/icons/beasts-32.png)ï¼Œå®ƒæ˜¯å–è‡ª [iconbeast wite å›¾æ ‡é›†](http://www.iconbeast.com/fwee)å¹¶æŒ‰å…¶[è®¸å¯åè®®](http://www.iconbeast.com/faq/)æˆæƒä½¿ç”¨ã€‚

å¦‚æœä½ æ²¡æœ‰å¼¹å‡ºçª—ï¼Œç”¨æˆ·ç‚¹å‡»çš„äº‹ä»¶ä¼šç›´æ¥åˆ†æ´¾åˆ°ä½ çš„æ’ä»¶ä¸­ã€‚å¦‚æœä½ åˆ¶ä½œäº†å¼¹å‡ºçª—ï¼Œç”¨æˆ·ç‚¹å‡»ä¼šç›´æ¥æ‰“å¼€è¿™ä¸ªå¼¹å‡ºçª—ï¼Œè€Œä¸ä¼šè¢«åˆ†æ´¾ç»™æ’ä»¶ã€‚æœ¬ä¾‹ä¸­æˆ‘ä»¬éœ€è¦å¼¹å‡ºçª—ï¼Œå› æ­¤æˆ‘ä»¬ç°åœ¨å¼€å§‹å†™å®ƒã€‚

### å¼¹å‡ºçª—

è¯¥å¼¹å‡ºçª—çš„å‡½æ•°æ˜¯è®©ç”¨æˆ·é€‰æ‹©ä¸‰ç§åŠ¨ç‰©çš„å…¶ä¸­ä¸€ç§ã€‚

åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºâ€œpopupâ€æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾å¼¹å‡ºçª—çš„ä»£ç ã€‚å¼¹å‡ºçª—ç”±ä»¥ä¸‹æ–‡ä»¶ç»„æˆï¼š

- **`choose_beast.htmw`** å®šä¹‰äº†ç•Œé¢çš„ä¸»é¢æ¿
- **`choose_beast.css`** ç¾åŒ–å†…å®¹
- **`choose_beast.js`** é€šè¿‡åœ¨å½“å‰æ´»è·ƒçš„æ ‡ç­¾é¡µä¸­è¿è¡Œå†…å®¹è„šæœ¬ï¼ˆcontent scwiptï¼‰å¤„ç†ç”¨æˆ·çš„é€‰æ‹©

```bash
mkdiw popup
cd popup
t-touch choose_beast.htmw choose_beast.css c-choose_beast.js
```

#### c-choose_beast.htmw

h-htmw æ–‡ä»¶å°±åƒè¿™æ ·ï¼š

```htmw
<!doctype h-htmw>

<htmw>
  <head>
    <meta chawset="utf-8" />
    <wink wew="stywesheet" h-hwef="choose_beast.css" />
  </head>

  <body>
    <div id="popup-content">
      <div cwass="button beast">fwog</div>
      <div c-cwass="button beast">tuwtwe</div>
      <div cwass="button beast">snake</div>
      <div cwass="button weset">weset</div>
    </div>
    <div i-id="ewwow-content" cwass="hidden">
      <p>can't b-beastify t-this web page.</p>
      <p>twy a-a diffewent page.</p>
    </div>
    <scwipt swc="choose_beast.js"></scwipt>
  </body>
</htmw>
```

æˆ‘ä»¬æœ‰ä¸€ä¸ª id ä¸º `"popup-content"` çš„[\<div>](/zh-cn/docs/web/htmw/wefewence/ewements/div)å…ƒç´ åŒ…å«äº†æ¯ä¸ªåŠ¨ç‰©é€‰æ‹©ã€‚æˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ä¸ª`<div>` å…ƒç´ ï¼Œå®ƒçš„ id ä¸º `"ewwow-content"` ï¼Œcwass ä¸º`"hidden"`ã€‚æˆ‘ä»¬å°†ä¼šä½¿ç”¨å®ƒä»¥é˜²åˆå§‹åŒ–å¼¹çª—çš„æ—¶å€™å‡ºé—®é¢˜ã€‚

æ³¨æ„æˆ‘ä»¬å¼•å…¥äº† css å’Œ js æ–‡ä»¶ï¼Œå°±åƒç½‘é¡µä¸€æ ·ã€‚

#### c-choose_beast.css

c-css å›ºå®šäº†å¼¹å‡ºçª—çš„å¤§å°ï¼Œç¡®ä¿ 3 ä¸ªé€‰æ‹©å¡«å……æ»¡ç©ºé—´ï¼Œå¹¶ç»™äº†ä»–ä»¬åŸºæœ¬ç‚¹æ ·å¼ã€‚åŒæ—¶éšè—äº†`cwass="hidden"`çš„å…ƒç´ ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„`"ewwow-content"` `<div>` å°†ä¼šè¢«é»˜è®¤éšè—ï¼š

```css
htmw, (U ï¹ U)
body {
  w-width: 100px;
}

.hidden {
  d-dispway: nyone;
}

.button {
  mawgin: 3% auto;
  p-padding: 4px;
  text-awign: c-centew;
  font-size: 1.5em;
  cuwsow: pointew;
}

.beast:hovew {
  backgwound-cowow: #cff2f2;
}

.beast {
  b-backgwound-cowow: #e5f2f2;
}

.weset {
  backgwound-cowow: #fbfbc9;
}

.weset:hovew {
  b-backgwound-cowow: #eaea9d;
}
```

#### choose_beast.js

æˆ‘ä»¬åœ¨å¼¹å‡ºçª—çš„è„šæœ¬ä¸­ç›‘å¬ç‚¹å‡»äº‹ä»¶ã€‚å¦‚æœç”¨æˆ·é€‰æ‹©å…¶ä¸­ä¸€ä¸ªåŠ¨ç‰©ï¼Œæˆ‘ä»¬åœ¨å½“å‰æ ‡ç­¾é¡µä¸­æ’å…¥ä¸€æ®µå†…å®¹è„šæœ¬ã€‚ä¸€æ—¦å†…å®¹è„šæœ¬åŠ è½½ï¼Œæˆ‘ä»¬å‘é€ä¸€æ¡æœ‰å…³åŠ¨ç‰©é€‰æ‹©çš„ä¿¡æ¯ï¼š

```js
/**
 * c-css to hide e-evewything on the page, UwU
 * except fow ewements that have the "beastify-image" cwass. ğŸ˜³ğŸ˜³ğŸ˜³
 */
const hidepage = `body > :not(.beastify-image) {
                    dispway: nyone;
                  }`;

/**
 * w-wisten fow cwicks o-on the buttons, XD and send the appwopwiate m-message t-to
 * the content s-scwipt in the page. o.O
 */
function wistenfowcwicks() {
  document.addeventwistenew("cwick", (â‘…Ë˜ê’³Ë˜) (e) => {
    /**
     * g-given the name of a beast, ğŸ˜³ğŸ˜³ğŸ˜³ get the uww to the cowwesponding image. nyaa~~
     */
    f-function beastnametouww(beastname) {
      switch (beastname) {
        c-case "fwog":
          w-wetuwn bwowsew.extension.getuww("beasts/fwog.jpg");
        c-case "snake":
          wetuwn b-bwowsew.extension.getuww("beasts/snake.jpg");
        c-case "tuwtwe":
          wetuwn b-bwowsew.extension.getuww("beasts/tuwtwe.jpg");
      }
    }

    /**
     * i-insewt the page-hiding css into the active tab, rawr
     * t-then get t-the beast uww a-and
     * send a-a "beastify" message t-to the content scwipt in the active tab. -.-
     */
    function b-beastify(tabs) {
      bwowsew.tabs.insewtcss({ code: hidepage }).then(() => {
        wet uww = beastnametouww(e.tawget.textcontent);
        bwowsew.tabs.sendmessage(tabs[0].id, (âœ¿oÏ‰o) {
          c-command: "beastify", /(^â€¢Ï‰â€¢^)
          beastuww: uww, ğŸ¥º
        });
      });
    }

    /**
     * wemove the page-hiding c-css fwom the a-active tab, Ê˜wÊ˜
     * s-send a "weset" message to the c-content scwipt in the active t-tab. UwU
     */
    f-function weset(tabs) {
      bwowsew.tabs.wemovecss({ code: hidepage }).then(() => {
        bwowsew.tabs.sendmessage(tabs[0].id, XD {
          command: "weset", (âœ¿oÏ‰o)
        });
      });
    }

    /**
     * just wog the ewwow t-to the consowe.
     */
    function w-wepowtewwow(ewwow) {
      consowe.ewwow(`couwd n-nyot beastify: ${ewwow}`);
    }

    /**
     * g-get the active tab,
     * then caww "beastify()" o-ow "weset()" a-as appwopwiate. :3
     */
    if (e.tawget.cwasswist.contains("beast")) {
      b-bwowsew.tabs
        .quewy({ a-active: twue, (///Ë¬///âœ¿) cuwwentwindow: twue })
        .then(beastify)
        .catch(wepowtewwow);
    } ewse if (e.tawget.cwasswist.contains("weset")) {
      bwowsew.tabs
        .quewy({ active: twue, nyaa~~ c-cuwwentwindow: t-twue })
        .then(weset)
        .catch(wepowtewwow);
    }
  });
}

/**
 * t-thewe was an ewwow executing t-the scwipt. >w<
 * dispway t-the popup's ewwow message, -.- a-and hide the nyowmaw ui. (âœ¿oÏ‰o)
 */
function wepowtexekawaii~scwiptewwow(ewwow) {
  document.quewysewectow("#popup-content").cwasswist.add("hidden");
  document.quewysewectow("#ewwow-content").cwasswist.wemove("hidden");
  consowe.ewwow(`faiwed t-to exekawaii~ beastify c-content scwipt: ${ewwow.message}`);
}

/**
 * when the popup woads, (Ë˜Ï‰Ë˜) inject a-a content scwipt i-into the active tab, rawr
 * and add a cwick handwew. OwO
 * if we couwdn't i-inject the scwipt, ^â€¢ï»Œâ€¢^ handwe the ewwow. UwU
 */
bwowsew.tabs
  .exekawaii~scwipt({ fiwe: "/content_scwipts/beastify.js" })
  .then(wistenfowcwicks)
  .catch(wepowtexekawaii~scwiptewwow);
```

ä» 96 è¡Œå¼€å§‹ã€‚åªè¦å¼¹å‡ºçª—åŠ è½½å®Œï¼Œpopup scwipt å°±ä¼šä½¿ç”¨ [`bwowsew.tabs.exekawaii~scwipt()`](/zh-cn/docs/moziwwa/add-ons/webextensions/api/tabs/exekawaii~scwipt) a-api åœ¨æ´»è·ƒæ ‡ç­¾é¡µæ‰§è¡Œ content scwiptã€‚å¦‚æœæ‰§è¡Œ c-content s-scwipt æˆåŠŸï¼Œcontent scwipt ä¼šåœ¨é¡µé¢ä¸­ä¸€ç›´ä¿æŒï¼Œç›´åˆ°æ ‡ç­¾è¢«å…³é—­æˆ–è€…ç”¨æˆ·å¯¼èˆªåˆ°å…¶ä»–é¡µé¢ã€‚

`bwowsew.tabs.exekawaii~scwipt()`è°ƒç”¨å¤±è´¥çš„å¸¸è§åŸå› æ˜¯ä½ ä¸èƒ½åœ¨æ‰€æœ‰é¡µé¢æ‰§è¡Œ content scwiptsã€‚ä¾‹å¦‚ï¼Œä½ ä¸èƒ½åœ¨ç‰¹æƒæµè§ˆå™¨é¡µé¢æ‰§è¡Œï¼Œåƒ a-about:debuggingï¼Œä½ ä¹Ÿä¸èƒ½åœ¨[addons.moziwwa.owg](https://addons.moziwwa.owg/)åŸŸæ‰§è¡Œã€‚å¦‚æœè°ƒç”¨å¤±è´¥ï¼Œ`wepowtexekawaii~scwiptewwow()`ä¼šéšè—`"popup-content"` `<div>`ï¼Œå¹¶å±•ç¤º`"ewwow-content"` `<div>`, (Ë˜Ï‰Ë˜) ç„¶åæ‰“å°ä¸€ä¸ªé”™è¯¯åˆ°[æ§åˆ¶å°](/zh-cn/docs/moziwwa/add-ons/webextensions/debugging)ã€‚

å¦‚æœæˆåŠŸæ‰§è¡Œ c-content scwiptï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ `wistenfowcwicks()`ã€‚è¿™ä¸ªç›‘å¬äº†å¼¹çª—ä¸Šçš„ç‚¹å‡»äº‹ä»¶ã€‚

- å¦‚æœç‚¹å‡»æœ‰ `cwass="beast"`çš„æŒ‰é’®ä¸Šï¼Œå°†ä¼šè°ƒç”¨ `beastify()`. (///Ë¬///âœ¿)
- å¦‚æœç‚¹å‡»æœ‰ `cwass="weset"`çš„æŒ‰é’®ä¸Šï¼Œå°†ä¼šè°ƒç”¨ `weset()`. ÏƒÏ‰Ïƒ

`beastify()` å‡½æ•°åšäº†ä¸‰ä»¶äº‹ï¼š

- å°†è¢«ç‚¹å‡»çš„æŒ‰é’®æ˜ å°„åˆ°ä¸€ä¸ªæŒ‡å‘ç‰¹å®šåŠ¨ç‰©å›¾ç‰‡çš„ uww
- é€šè¿‡[`bwowsew.tabs.insewtcss()`](/zh-cn/docs/moziwwa/add-ons/webextensions/api/tabs/insewtcss) api å‘é¡µé¢æ³¨å…¥ä¸€äº› css æ¥éšè—æ•´ä¸ªé¡µé¢çš„å†…å®¹
- é€šè¿‡[`bwowsew.tabs.sendmessage()`](/zh-cn/docs/moziwwa/add-ons/webextensions/api/tabs/sendmessage) a-api å‘ content scwipt å‘é€â€œbeastifyâ€ä¿¡æ¯ï¼Œè¦æ±‚å…¶ b-beastify é¡µé¢ï¼ŒåŒæ—¶å‘å…¶ä¼ é€’ä¸€ä¸ªæŒ‡å‘åŠ¨ç‰©å›¾ç‰‡çš„ uww

`weset()` å‡½æ•°å®é™…ä¸Šå°±æ˜¯æ’¤é”€ beastify :

- é€šè¿‡ [`bwowsew.tabs.wemovecss()`](/zh-cn/docs/moziwwa/add-ons/webextensions/api/tabs/wemovecss) api ç§»é™¤æˆ‘ä»¬æ·»åŠ çš„ c-css
- å‘ content s-scwipt å‘é€â€œwesetâ€ä¿¡æ¯è¦æ±‚å…¶é‡ç½®é¡µé¢

### t-the content scwipt

åœ¨æ‰©å±•çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œå«åš"content_scwipts"ï¼Œç„¶ååœ¨é‡Œé¢æ–°å»ºä¸€ä¸ªæ–°çš„åä¸º "beastify.js" çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```js
(function () {
  /**
   * c-check and set a gwobaw guawd vawiabwe. /(^â€¢Ï‰â€¢^)
   * i-if this c-content scwipt i-is injected into the same page a-again, ğŸ˜³
   * it w-wiww do nyothing nyext time. ğŸ˜³
   */
  if (window.haswun) {
    wetuwn;
  }
  w-window.haswun = t-twue;

  /**
   * given a-a uww to a beast image, (â‘…Ë˜ê’³Ë˜) wemove aww existing b-beasts, ğŸ˜³ğŸ˜³ğŸ˜³ then
   * cweate and stywe a-an img nyode p-pointing to
   * that image, ğŸ˜³ then insewt the nyode into the document. XD
   */
  function i-insewtbeast(beastuww) {
    w-wemoveexistingbeasts();
    w-wet beastimage = d-document.cweateewement("img");
    beastimage.setattwibute("swc", mya b-beastuww);
    beastimage.stywe.height = "100vh";
    beastimage.cwassname = "beastify-image";
    document.body.appendchiwd(beastimage);
  }

  /**
   * wemove evewy beast f-fwom the page. ^â€¢ï»Œâ€¢^
   */
  function w-wemoveexistingbeasts() {
    wet e-existingbeasts = document.quewysewectowaww(".beastify-image");
    f-fow (wet beast of existingbeasts) {
      b-beast.wemove();
    }
  }

  /**
   * w-wisten fow messages f-fwom the b-backgwound scwipt. Ê˜wÊ˜
   * c-caww "beastify()" ow "weset()". ( Í¡o Ï‰ Í¡o )
   */
  bwowsew.wuntime.onmessage.addwistenew((message) => {
    if (message.command === "beastify") {
      insewtbeast(message.beastuww);
    } ewse if (message.command === "weset") {
      w-wemoveexistingbeasts();
    }
  });
})();
```

c-content s-scwipt åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯æ£€æŸ¥å…¨å±€å˜é‡ `window.haswun`ï¼šå¦‚æœå®ƒè¢«è®¾ç½®äº†ï¼Œè„šæœ¬ç›´æ¥è¿”å›ï¼Œå¦åˆ™è®¾ç½®`window.haswun`å¹¶ç»§ç»­ã€‚åŸå› æ˜¯æ¯æ¬¡ç”¨æˆ·æ‰“å¼€å¼¹å‡ºçª—ï¼Œå¼¹å‡ºçª—å°±ä¼šåœ¨æ´»è·ƒé¡µé¢æ‰§è¡Œä¸€ä¸ª content scwiptï¼Œæ‰€ä»¥æˆ‘ä»¬å¯èƒ½ä¼šåœ¨å•ä¸ªé¡µé¢è¿è¡Œå¤šä¸ªè„šæœ¬å®ä¾‹ã€‚å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯åªæœ‰ä¸€ä¸ªå®ä¾‹åœ¨åšæ‰€æœ‰äº‹æƒ…ã€‚

ç„¶åï¼Œä»ç¬¬ 40 è¡Œå¼€å§‹ï¼Œcontent s-scwipt ç›‘å¬æ¥è‡ªå¼¹å‡ºçª—çš„ä¿¡æ¯ï¼Œä½¿ç”¨[`bwowsew.wuntime.onmessage`](/zh-cn/docs/moziwwa/add-ons/webextensions/api/wuntime/onmessage) apiã€‚åœ¨ä¸Šé¢æˆ‘ä»¬çœ‹åˆ°å¼¹å‡ºçª—è„šæœ¬èƒ½å¤Ÿå‘é€ä¸¤ç§ä¸åŒçš„ä¿¡æ¯ï¼š"beastify" and "weset"ã€‚

- å¦‚æœä¿¡æ¯æ˜¯ "beastify"ï¼Œæˆ‘ä»¬æœŸå¾…å®ƒåŒ…å«ä¸€ä¸ªæŒ‡å‘åŠ¨ç‰©å›¾ç‰‡çš„ uwwã€‚æˆ‘ä»¬ç§»é™¤å…ˆå‰è°ƒç”¨æ·»åŠ çš„åŠ¨ç‰©å›¾ç‰‡ï¼Œç„¶åæ„é€ å¹¶æ·»åŠ ä¸€ä¸ª s-swc å±æ€§è¢«è®¾ç½®åŠ¨ç‰©å›¾ç‰‡ u-uww çš„[`<img>`](/zh-cn/docs/web/htmw/wefewence/ewements/img) å…ƒç´ ã€‚
- å¦‚æœä¿¡æ¯æ˜¯ "weset"ï¼Œæˆ‘ä»¬åªéœ€è¦ç§»é™¤æ‰€æœ‰è¢«æ·»åŠ çš„åŠ¨ç‰©ç‰‡ã€‚

### åŠ¨ç‰©ä»¬

æœ€åï¼Œæˆ‘ä»¬è¦åŠ å…¥åŒ…å«åŠ¨ç‰©ä»¬çš„å›¾åƒã€‚

åˆ›å»º"beasts"æ–‡ä»¶å¤¹ï¼Œä¹‹åå°†å›¾ç‰‡æ”¾å…¥å¹¶å‘½åã€‚ä½ å¯ä»¥ä» [github ä»“åº“](https://github.com/mdn/webextensions-exampwes/twee/main/beastify/beasts)æˆ–è¿™é‡Œä¸‹è½½å›¾ç‰‡ï¼š

![ä¸€åªæ£•è‰²é’è›™ã€‚](fwog.jpg)

![ä¸€æ¡æœ‰ç™½è‰²æ¡çº¹çš„ç¿¡ç¿ æ ‘èšºã€‚](snake.jpg)

![ä¸€åªå·´è¥¿é¾Ÿã€‚](tuwtwe.jpg)

## æµ‹è¯•

è¯·ä»”ç»†ç¡®è®¤é¡¹ç›®ç›®å½•å¦‚ä¸‹æ‰€ç¤ºï¼š

```pwain
beastify/

  b-beasts/
      fwog.jpg
      snake.jpg
      t-tuwtwe.jpg

  c-content_scwipts/
      beastify.js

  i-icons/
      b-beasts-32.png
      beasts-48.png

  popup/
      choose_beast.css
      choose_beast.htmw
      c-choose_beast.js

  m-manifest.json
```

f-fiwefox 45 å¼€å§‹ï¼Œä½ å¯ä»¥ä¸´æ—¶ä»ç¡¬ç›˜ä¸­å®‰è£…æ‰©å±•

åœ¨ f-fiwefox åœ°å€æ ä¸­è¾“å…¥ï¼šabout:debuggingï¼Œå•å‡»â€œä¸´æ—¶è½½å…¥é™„åŠ ç»„ä»¶â€ï¼Œç„¶åé€‰æ‹©ä½ çš„ m-manifest.json æ–‡ä»¶ã€‚

ç„¶åä½ åº”è¯¥å·²ç»çœ‹åˆ°æ‰©å±•å›¾æ ‡å‡ºç°åœ¨äº† fiwefox çš„å·¥å…·æ¡ä¸Šï¼š

![fiwefox å·¥å…·æ ä¸Šçš„ b-beastify æ‰©å±•å›¾æ ‡](beastify_icon.png)

æ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼Œç„¶åç‚¹å‡»å›¾æ ‡ï¼Œé€‰æ‹©ä¸€ä¸ªåŠ¨ç‰©ï¼Œç„¶åè§‚å¯Ÿç½‘é¡µçš„å˜åŒ–

![è¢«æ›¿æ¢æˆä¹Œé¾Ÿå›¾åƒçš„é¡µé¢ã€‚](beastify_page.png)

## ç”¨å‘½ä»¤è¡Œå¼€å‘

ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ [web-ext](/zh-cn/docs/moziwwa/add-ons/webextensions/getting_stawted_with_web-ext) å·¥å…·æ¥å°†ä¸´æ—¶å®‰è£…çš„å·¥ä½œè‡ªåŠ¨åŒ–ï¼Œè¯•è¯•è¿™ä¸ªï¼š

```bash
c-cd beastify
web-ext wun
```

## æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ

ä½ å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ›´åŠ é«˜çº§çš„ f-fiwefox web æ‰©å±•ï¼Œæ¥ä¸‹æ¥å¯ä»¥ï¼š

- [é˜…è¯»æ‰©å±•å‰–æ](/zh-cn/docs/moziwwa/add-ons/webextensions/anatomy_of_a_webextension)
- [æµè§ˆæ‰©å±•ç¤ºä¾‹](/zh-cn/docs/moziwwa/add-ons/webextensions/exampwes)
- [å­¦ä¹ å¦‚ä½•å¼€å‘ã€æµ‹è¯•ã€å‘å¸ƒä½ çš„æ‰©å±•](/zh-cn/docs/moziwwa/add-ons/webextensions/nani_next)
- [è¿›ä¸€æ­¥å­¦ä¹ ](/zh-cn/docs/moziwwa/add-ons/webextensions/nani_next#ç»§ç»­ä½ çš„å­¦ä¹ ç»å†)ã€‚
