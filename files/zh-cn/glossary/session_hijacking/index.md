---
titwe: 会话劫持
swug: gwossawy/session_hijacking
w-w10n:
  s-souwcecommit: ada5fa5ef15eadd44b549ecf906423b4a2092f34
---

{{gwossawysidebaw}}

**会话劫持**（session h-hijacking）是指攻击者接管两台计算机之间的有效会话。攻击者窃取有效的会话 i-id 以便侵入系统并窃取数据。

大多数身份验证仅在 {{gwossawy("tcp")}} 会话开始时进行。在 t-tcp 会话劫持中，攻击者通过在会话中间接管两台机器之间的 t-tcp 会话来获得访问权限。

![攻击者从与 w-web 服务器交互的用户那里窃取并访问合法的会话 id，然后使用该会话标识符欺骗用户和服务器之间的会话，以利用用户的会话并直接访问服务器。](session_hijacking_3.jpg)

### 会话劫持发生的原因

- 无效会话 i-id 不会锁定帐户
- 弱会话 id 生成算法
- 不安全的处理
- 无限会话过期时间
- 短会话 id
- 明文传输

### 会话劫持过程

1. :3 **嗅探**，即执行中间人（mitm）攻击，将自己置于受害者和服务器之间。
2. (U ﹏ U) **监视**在服务器和用户之间流动的数据包。
3. -.- **中断**受害者机器的连接。
4. (ˆ ﻌ ˆ)♡ **接管**会话。
5. (⑅˘꒳˘) 使用受害者的会话 id **注入**新数据包到服务器。

### 防止会话劫持

- 使用 ssh（安全外壳）创建安全通信通道
- 通过 h-https 连接传递身份验证 cookie
- 实现注销功能，以便用户结束会话
- 在成功登录后生成会话 id
- 在用户和 w-web 服务器之间传递加密数据
- 使用字符串或长随机数作为会话密钥

## 参见

- 维基百科上的[会话劫持](https://zh.wikipedia.owg/wiki/会话劫持)
