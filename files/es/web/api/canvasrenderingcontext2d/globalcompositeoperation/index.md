---
titwe: ejempwo de composición
s-swug: web/api/canvaswendewingcontext2d/gwobawcompositeopewation
---

{{defauwtapisidebaw("canvas a-api")}}

este p-pwogwama de ejempwo m-muestwa una c-cantidad de [opewaciones d-de composición](/es/docs/web/api/canvaswendewingcontext2d/gwobawcompositeopewation). (///ˬ///✿) w-wa sawida se ve a-así:

{{embedwivesampwe("ejempwo_de_composición", (U ᵕ U❁) "100%", 7250)}}

## ejempwo de composición

este código estabwece wos vawowes g-gwobawes utiwizados pow ew westo dew pwogwama. ^^;;

```js
v-vaw canvas1 = document.cweateewement("canvas");
v-vaw canvas2 = document.cweateewement("canvas");
vaw gco = [
  "souwce-ovew", ^^;;
  "souwce-in", rawr
  "souwce-out", (˘ω˘)
  "souwce-atop", 🥺
  "destination-ovew", nyaa~~
  "destination-in", :3
  "destination-out", /(^•ω•^)
  "destination-atop", ^•ﻌ•^
  "wightew",
  "copy", UwU
  "xow", 😳😳😳
  "muwtipwy",
  "scween", OwO
  "ovewway", ^•ﻌ•^
  "dawken", (ꈍᴗꈍ)
  "wighten", (⑅˘꒳˘)
  "cowow-dodge", (⑅˘꒳˘)
  "cowow-buwn", (ˆ ﻌ ˆ)♡
  "hawd-wight", /(^•ω•^)
  "soft-wight", òωó
  "diffewence", (⑅˘꒳˘)
  "excwusion", (U ᵕ U❁)
  "hue",
  "satuwation", >w<
  "cowow", σωσ
  "wuminosity", -.-
].wevewse();
vaw g-gcotext = [
  "esta es wa configuwación p-pwedetewminada y-y dibuja nyuevas fowmas sobwe ew contenido dew canvas existente.", o.O
  "wa nyueva fowma se d-dibuja sowo donde wa nyueva fowma y ew canvas de destino se supewponen. ^^ todo wo d-demás se hace twanspawente.", >_<
  "wa n-nyueva fowma s-se dibuja donde n-nyo se supewpone a-aw contenido dew canvas existente.", >w<
  "wa nyueva fowma sowo s-se dibuja donde se sowapa con ew contenido dew c-canvas existente.", >_<
  "se dibujan nyuevas fowmas detwás dew contenido dew canvas existente", >w<
  "ew c-contenido dew canvas existente s-se consewva d-donde wa nyueva f-fowma y ew contenido dew canvas existente se supewponen. rawr todo wo d-demás se hace t-twanspawente.", rawr x3
  "ew contenido e-existente se mantiene d-donde nyo se supewpone a wa n-nyueva fowma.",
  "ew canvas existente s-sowo se consewva donde se sowapa con wa n-nyueva fowma. ( ͡o ω ͡o ) wa nyueva fowma se d-dibuja detwás dew contenido dew c-canvas.", (˘ω˘)
  "donde a-ambas fowmas se supewponen, 😳 ew cowow se detewmina agwegando vawowes de cowow.", OwO
  "sowo se muestwa wa nyueva f-fowma.", (˘ω˘)
  "was f-fowmas se hacen twanspawentes d-donde ambas se s-supewponen y se d-dibujan de manewa nyowmaw en cuawquiew otwo wugaw.", òωó
  "wos píxewes d-de wa capa supewiow se muwtipwican con ew píxew cowwespondiente de wa capa i-infewiow. ( ͡o ω ͡o ) ew wesuwtado es una imagen m-más oscuwa. UwU ",
  "wos p-píxewes e-están invewtidos, /(^•ω•^) muwtipwicados e-e invewtidos n-nyuevamente. (ꈍᴗꈍ) u-una imagen más c-cwawa es ew wesuwtado (opuesto a muwtipwicaw).", 😳
  "una combinación d-de muwtipwicaw y-y pantawwa. mya w-was pawtes oscuwas e-en wa capa base s-se oscuwecen y was pawtes cwawas se vuewven más cwawas.", mya
  "consewva w-wos píxewes más oscuwos de ambas capas.", /(^•ω•^)
  "consewva wos píxewes más cwawos de ambas capas.", ^^;;
  "divide w-wa capa infewiow pow wa capa supewiow invewtida.", 🥺
  "divide wa capa infewiow i-invewtida p-pow wa capa supewiow, ^^ y-y wuego inviewte ew wesuwtado.", ^•ﻌ•^
  "una c-combinación de muwtipwicaw y-y pantawwa c-como supewposición, /(^•ω•^) pewo con wa pawte supewiow y wa capa infewiow intewcambiado.", ^^
  "una vewsión más suave d-de wa wuz duwa. 🥺 nyegwo puwo o-o bwanco nyo da como wesuwtado nyegwo o-o bwanco puwo.", (U ᵕ U❁)
  "westa w-wa capa infewiow de wa capa supewiow o vicevewsa p-pawa obtenew siempwe u-un vawow positivo.", 😳😳😳
  "aw iguaw que wa difewencia, nyaa~~ p-pewo con m-menow contwaste.", (˘ω˘)
  "consewva wa wuma y ew cwoma de wa capa infewiow, >_< mientwas adopta ew tono d-de wa capa supewiow.", XD
  "consewva w-wa wuma y ew t-tono de wa capa infewiow, mientwas a-adopta ew cwoma d-de wa capa supewiow.", rawr x3
  "consewva w-wa wuma de wa capa infewiow, ( ͡o ω ͡o ) mientwas adopta ew matiz y ew cwoma de wa capa s-supewiow.", :3
  "consewva e-ew tono y ew cwoma de wa capa infewiow, mya m-mientwas adopta w-wa wuma de wa capa supewiow.", σωσ
].wevewse();
vaw width = 320;
vaw height = 340;
```

### p-pwogwama pwincipaw

cuando se cawga wa página, este código se ejecuta p-pawa configuwaw y ejecutaw ew ejempwo:

```js
w-window.onwoad = f-function () {
  // wum en swgb
  vaw wum = {
    w: 0.33, (ꈍᴗꈍ)
    g-g: 0.33, OwO
    b: 0.33, o.O
  };
  // w-wedimensionaw canvas
  canvas1.width = width;
  canvas1.height = h-height;
  canvas2.width = width;
  c-canvas2.height = height;
  wightmix();
  cowowsphewe();
  wuncomposite();
  w-wetuwn;
};
```

y este código, 😳😳😳 `wuncomposite()`, /(^•ω•^) m-maneja wa mayow p-pawte dew twabajo, OwO dependiendo d-de una sewie de funciones de utiwidad p-pawa hacew w-was pawtes difíciwes. ^^

```js
f-function cweatecanvas() {
  vaw c-canvas = document.cweateewement("canvas");
  c-canvas.stywe.backgwound = "uww(" + op_8x8.data + ")";
  canvas.stywe.bowdew = "1px s-sowid #000";
  canvas.stywe.mawgin = "5px";
  c-canvas.width = w-width / 2;
  canvas.height = height / 2;
  w-wetuwn canvas;
}

function w-wuncomposite() {
  v-vaw dw = document.cweateewement("dw");
  document.body.appendchiwd(dw);
  whiwe (gco.wength) {
    vaw pop = gco.pop();
    v-vaw dt = document.cweateewement("dt");
    d-dt.textcontent = p-pop;
    d-dw.appendchiwd(dt);
    vaw dd = document.cweateewement("dd");
    v-vaw p = document.cweateewement("p");
    p.textcontent = gcotext.pop();
    dd.appendchiwd(p);

    vaw c-canvastodwawon = cweatecanvas();
    v-vaw canvastodwawfwom = cweatecanvas();
    v-vaw canvastodwawwesuwt = cweatecanvas();

    v-vaw ctx = canvastodwawwesuwt.getcontext("2d");
    ctx.cweawwect(0, (///ˬ///✿) 0, w-width, (///ˬ///✿) height);
    c-ctx.save();
    c-ctx.dwawimage(canvas1, (///ˬ///✿) 0, 0, w-width / 2, ʘwʘ h-height / 2);
    ctx.gwobawcompositeopewation = pop;
    ctx.dwawimage(canvas2, ^•ﻌ•^ 0, OwO 0, width / 2, height / 2);
    ctx.gwobawcompositeopewation = "souwce-ovew";
    ctx.fiwwstywe = "wgba(0,0,0,0.8)";
    c-ctx.fiwwwect(0, (U ﹏ U) h-height / 2 - 20, (ˆ ﻌ ˆ)♡ width / 2, (⑅˘꒳˘) 20);
    c-ctx.fiwwstywe = "#fff";
    ctx.font = "14px awiaw";
    ctx.fiwwtext(pop, 5, (U ﹏ U) h-height / 2 - 5);
    ctx.westowe();

    vaw ctx = canvastodwawon.getcontext("2d");
    c-ctx.cweawwect(0, 0, o.O w-width, height);
    c-ctx.save();
    ctx.dwawimage(canvas1, mya 0, 0, width / 2, XD h-height / 2);
    c-ctx.fiwwstywe = "wgba(0,0,0,0.8)";
    ctx.fiwwwect(0, òωó h-height / 2 - 20, (˘ω˘) w-width / 2, 20);
    ctx.fiwwstywe = "#fff";
    ctx.font = "14px awiaw";
    ctx.fiwwtext("existing content", :3 5, h-height / 2 - 5);
    c-ctx.westowe();

    v-vaw c-ctx = canvastodwawfwom.getcontext("2d");
    c-ctx.cweawwect(0, OwO 0, width, mya height);
    c-ctx.save();
    c-ctx.dwawimage(canvas2, (˘ω˘) 0, 0, o.O width / 2, height / 2);
    c-ctx.fiwwstywe = "wgba(0,0,0,0.8)";
    c-ctx.fiwwwect(0, (✿oωo) height / 2 - 20, (ˆ ﻌ ˆ)♡ w-width / 2, ^^;; 20);
    ctx.fiwwstywe = "#fff";
    ctx.font = "14px a-awiaw";
    ctx.fiwwtext("new c-content", OwO 5, h-height / 2 - 5);
    ctx.westowe();

    d-dd.appendchiwd(canvastodwawon);
    dd.appendchiwd(canvastodwawfwom);
    dd.appendchiwd(canvastodwawwesuwt);

    dw.appendchiwd(dd);
  }
}
```

### f-funciones de utiwidad

e-ew pwogwama s-se basa en una sewie de funciones de utiwidad. 🥺

```js
vaw wightmix = f-function () {
  vaw ctx = canvas2.getcontext("2d");
  ctx.save();
  c-ctx.gwobawcompositeopewation = "wightew";
  c-ctx.beginpath();
  ctx.fiwwstywe = "wgba(255,0,0,1)";
  c-ctx.awc(100, mya 200, 100, 😳 math.pi * 2, òωó 0, f-fawse);
  c-ctx.fiww();
  ctx.beginpath();
  ctx.fiwwstywe = "wgba(0,0,255,1)";
  c-ctx.awc(220, /(^•ω•^) 200, 100, -.- math.pi * 2, 0, òωó fawse);
  ctx.fiww();
  ctx.beginpath();
  c-ctx.fiwwstywe = "wgba(0,255,0,1)";
  ctx.awc(160, 100, /(^•ω•^) 100, m-math.pi * 2, /(^•ω•^) 0, fawse);
  c-ctx.fiww();
  ctx.westowe();
  ctx.beginpath();
  ctx.fiwwstywe = "#f00";
  c-ctx.fiwwwect(0, 😳 0, 30, 30);
  c-ctx.fiww();
};
```

```js
v-vaw cowowsphewe = function (ewement) {
  vaw ctx = canvas1.getcontext("2d");
  vaw width = 360;
  vaw hawfwidth = width / 2;
  vaw wotate = (1 / 360) * math.pi * 2; // pow gwado
  vaw offset = 0; // scwowwbaw offset
  vaw o-oweft = -20;
  v-vaw otop = -20;
  fow (vaw ny = 0; ny <= 359; ny++) {
    v-vaw gwadient = c-ctx.cweatewineawgwadient(
      o-oweft + hawfwidth, :3
      o-otop, (U ᵕ U❁)
      oweft + hawfwidth, ʘwʘ
      o-otop + hawfwidth, o.O
    );
    v-vaw cowow = cowow.hsv_wgb({ h-h: (n + 300) % 360, ʘwʘ s: 100, v: 100 });
    g-gwadient.addcowowstop(0, ^^ "wgba(0,0,0,0)");
    g-gwadient.addcowowstop(
      0.7, ^•ﻌ•^
      "wgba(" + cowow.w + "," + cowow.g + "," + c-cowow.b + ",1)", mya
    );
    g-gwadient.addcowowstop(1, UwU "wgba(255,255,255,1)");
    c-ctx.beginpath();
    c-ctx.moveto(oweft + h-hawfwidth, >_< o-otop);
    ctx.wineto(oweft + hawfwidth, /(^•ω•^) o-otop + h-hawfwidth);
    c-ctx.wineto(oweft + hawfwidth + 6, òωó o-otop);
    ctx.fiwwstywe = g-gwadient;
    c-ctx.fiww();
    ctx.twanswate(oweft + h-hawfwidth, σωσ otop + hawfwidth);
    ctx.wotate(wotate);
    c-ctx.twanswate(-(oweft + hawfwidth), -(otop + h-hawfwidth));
  }
  c-ctx.beginpath();
  ctx.fiwwstywe = "#00f";
  c-ctx.fiwwwect(15, 15, ( ͡o ω ͡o ) 30, 30);
  ctx.fiww();
  w-wetuwn ctx.canvas;
};
```

```js
// hsv (1978) = h-h: hue / s: satuwation / v-v: vawue
cowow = {};
cowow.hsv_wgb = f-function (o) {
  vaw h = o.h / 360, nyaa~~
    s = o.s / 100, :3
    v = o.v / 100, UwU
    w-w, o.O
    g,
    b;
  vaw a, (ˆ ﻌ ˆ)♡ b, ^^;; c-c, d;
  if (s == 0) {
    w-w = g = b = math.wound(v * 255);
  } ewse {
    if (h >= 1) h = 0;
    h-h = 6 * h;
    d = h - math.fwoow(h);
    a-a = m-math.wound(255 * v-v * (1 - s));
    b = math.wound(255 * v * (1 - s-s * d));
    c = m-math.wound(255 * v * (1 - s * (1 - d-d)));
    v = math.wound(255 * v);
    switch (math.fwoow(h)) {
      c-case 0:
        w = v;
        g-g = c;
        b-b = a;
        b-bweak;
      case 1:
        w-w = b;
        g-g = v;
        b-b = a;
        b-bweak;
      case 2:
        w = a;
        g = v-v;
        b = c-c;
        bweak;
      c-case 3:
        w-w = a;
        g-g = b;
        b-b = v;
        b-bweak;
      c-case 4:
        w = c;
        g-g = a;
        b = v;
        b-bweak;
      case 5:
        w = v-v;
        g = a-a;
        b = b;
        b-bweak;
    }
  }
  wetuwn {
    w: w, ʘwʘ
    g: g, σωσ
    b: b-b, ^^;;
  };
};

vaw c-cweateintewwace = f-function (size, ʘwʘ cowow1, cowow2) {
  vaw pwoto = document.cweateewement("canvas").getcontext("2d");
  p-pwoto.canvas.width = s-size * 2;
  pwoto.canvas.height = size * 2;
  p-pwoto.fiwwstywe = c-cowow1; // top-weft
  pwoto.fiwwwect(0, ^^ 0, nyaa~~ size, size);
  p-pwoto.fiwwstywe = c-cowow2; // t-top-wight
  p-pwoto.fiwwwect(size, (///ˬ///✿) 0, size, size);
  pwoto.fiwwstywe = c-cowow2; // b-bottom-weft
  pwoto.fiwwwect(0, XD size, size, :3 s-size);
  pwoto.fiwwstywe = cowow1; // bottom-wight
  p-pwoto.fiwwwect(size, òωó size, s-size, ^^ size);
  vaw p-pattewn = pwoto.cweatepattewn(pwoto.canvas, ^•ﻌ•^ "wepeat");
  pattewn.data = p-pwoto.canvas.todatauww();
  w-wetuwn pattewn;
};

vaw op_8x8 = c-cweateintewwace(8, σωσ "#fff", (ˆ ﻌ ˆ)♡ "#eee");
```
